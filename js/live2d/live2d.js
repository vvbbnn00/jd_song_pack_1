!function(t){var e={};function i(r){if(e[r])return e[r].exports;var s=e[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(r,s,function(e){return t[e]}.bind(null,s));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/dist/",i(i.s=38)}([function(t,e,i){var r=i(17)("wks"),s=i(19),n=i(1).Symbol,o="function"==typeof n;(t.exports=function(t){return r[t]||(r[t]=o&&n[t]||(o?n:s)("Symbol."+t))}).store=r},function(t,e){var i=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=i)},function(t,e){function i(){this.live2DModel=null,this.modelMatrix=null,this.eyeBlink=null,this.physics=null,this.pose=null,this.debugMode=!1,this.initialized=!1,this.updating=!1,this.alpha=1,this.accAlpha=0,this.lipSync=!1,this.lipSyncValue=0,this.accelX=0,this.accelY=0,this.accelZ=0,this.dragX=0,this.dragY=0,this.startTimeMSec=null,this.mainMotionManager=new u,this.expressionManager=new u,this.motions={},this.expressions={},this.isTexLoaded=!1}var r=0;function s(){AMotion.prototype.constructor.call(this),this.paramList=new Array}function n(){this.id="",this.type=-1,this.value=null}function o(){this.nextBlinkTime=null,this.stateStartTime=null,this.blinkIntervalMsec=null,this.eyeState=a.STATE_FIRST,this.blinkIntervalMsec=4e3,this.closingMotionMsec=100,this.closedMotionMsec=50,this.openingMotionMsec=150,this.closeIfZero=!0,this.eyeID_L="PARAM_EYE_L_OPEN",this.eyeID_R="PARAM_EYE_R_OPEN"}i.prototype.getModelMatrix=function(){return this.modelMatrix},i.prototype.setAlpha=function(t){t>.999&&(t=1),t<.001&&(t=0),this.alpha=t},i.prototype.getAlpha=function(){return this.alpha},i.prototype.isInitialized=function(){return this.initialized},i.prototype.setInitialized=function(t){this.initialized=t},i.prototype.isUpdating=function(){return this.updating},i.prototype.setUpdating=function(t){this.updating=t},i.prototype.getLive2DModel=function(){return this.live2DModel},i.prototype.setLipSync=function(t){this.lipSync=t},i.prototype.setLipSyncValue=function(t){this.lipSyncValue=t},i.prototype.setAccel=function(t,e,i){this.accelX=t,this.accelY=e,this.accelZ=i},i.prototype.setDrag=function(t,e){this.dragX=t,this.dragY=e},i.prototype.getMainMotionManager=function(){return this.mainMotionManager},i.prototype.getExpressionManager=function(){return this.expressionManager},i.prototype.loadModelData=function(t,e){var i=f.getPlatformManager();this.debugMode&&i.log("Load model : "+t);var r=this;i.loadLive2DModel(t,(function(t){r.live2DModel=t,r.live2DModel.saveParam(),0==Live2D.getError()?(r.modelMatrix=new h(r.live2DModel.getCanvasWidth(),r.live2DModel.getCanvasHeight()),r.modelMatrix.setWidth(2),r.modelMatrix.setCenterPosition(0,0),e(r.live2DModel)):console.error("Error : Failed to loadModelData().")}))},i.prototype.loadTexture=function(t,e,i){r++;var s=f.getPlatformManager();this.debugMode&&s.log("Load Texture : "+e);var n=this;s.loadTexture(this.live2DModel,t,e,(function(){0==--r&&(n.isTexLoaded=!0),"function"==typeof i&&i()}))},i.prototype.loadMotion=function(t,e,i){var r=f.getPlatformManager();this.debugMode&&r.log("Load Motion : "+e);var s=null,n=this;r.loadBytes(e,(function(e){s=Live2DMotion.loadMotion(e),null!=t&&(n.motions[t]=s),i(s)}))},i.prototype.loadExpression=function(t,e,i){var r=f.getPlatformManager();this.debugMode&&r.log("Load Expression : "+e);var n=this;r.loadBytes(e,(function(e){null!=t&&(n.expressions[t]=s.loadJson(e)),"function"==typeof i&&i()}))},i.prototype.loadPose=function(t,e){var i=f.getPlatformManager();this.debugMode&&i.log("Load Pose : "+t);var r=this;try{i.loadBytes(t,(function(t){r.pose=c.load(t),"function"==typeof e&&e()}))}catch(t){console.warn(t)}},i.prototype.loadPhysics=function(t){var e=f.getPlatformManager();this.debugMode&&e.log("Load Physics : "+t);var i=this;try{e.loadBytes(t,(function(t){i.physics=_.load(t)}))}catch(t){console.warn(t)}},i.prototype.hitTestSimple=function(t,e,i){if(null===this.live2DModel)return!1;var r=this.live2DModel.getDrawDataIndex(t);if(r<0)return!1;for(var s=this.live2DModel.getTransformedPoints(r),n=this.live2DModel.getCanvasWidth(),o=0,a=this.live2DModel.getCanvasHeight(),l=0,h=0;h<s.length;h+=2){var u=s[h],_=s[h+1];u<n&&(n=u),u>o&&(o=u),_<a&&(a=_),_>l&&(l=_)}var c=this.modelMatrix.invertTransformX(e),g=this.modelMatrix.invertTransformY(i);return n<=c&&c<=o&&a<=g&&g<=l},i.prototype.hitTestSimpleCustom=function(t,e,i,r){if(null===this.live2DModel)return!1;try{return i>=t[0]&&i<=e[0]&&r<=t[1]&&r>=e[1]}catch(s){return console.log("数据可能还没有准备好 view x:"+t+" y:"+e+" testX:"+i+" testY:"+r+" Error:"+s),!1}},s.prototype=new AMotion,s.EXPRESSION_DEFAULT="DEFAULT",s.TYPE_SET=0,s.TYPE_ADD=1,s.TYPE_MULT=2,s.loadJson=function(t){var e=new s,i=f.getPlatformManager().jsonParseFromBytes(t);if(e.setFadeIn(parseInt(i.fade_in)>0?parseInt(i.fade_in):1e3),e.setFadeOut(parseInt(i.fade_out)>0?parseInt(i.fade_out):1e3),null==i.params)return e;var r=i.params,o=r.length;e.paramList=[];for(var a=0;a<o;a++){var l=r[a],h=l.id.toString(),u=parseFloat(l.val),_=s.TYPE_ADD,c=null!=l.calc?l.calc.toString():"add";if((_="add"===c?s.TYPE_ADD:"mult"===c?s.TYPE_MULT:"set"===c?s.TYPE_SET:s.TYPE_ADD)==s.TYPE_ADD)u-=g=null==l.def?0:parseFloat(l.def);else if(_==s.TYPE_MULT){var g;0==(g=null==l.def?1:parseFloat(l.def))&&(g=1),u/=g}var p=new n;p.id=h,p.type=_,p.value=u,e.paramList.push(p)}return e},s.prototype.updateParamExe=function(t,e,i,r){for(var n=this.paramList.length-1;n>=0;--n){var o=this.paramList[n];o.type==s.TYPE_ADD?t.addToParamFloat(o.id,o.value,i):o.type==s.TYPE_MULT?t.multParamFloat(o.id,o.value,i):o.type==s.TYPE_SET&&t.setParamFloat(o.id,o.value,i)}},o.prototype.calcNextBlink=function(){return UtSystem.getUserTimeMSec()+Math.random()*(2*this.blinkIntervalMsec-1)},o.prototype.setInterval=function(t){this.blinkIntervalMsec=t},o.prototype.setEyeMotion=function(t,e,i){this.closingMotionMsec=t,this.closedMotionMsec=e,this.openingMotionMsec=i},o.prototype.updateParam=function(t){var e,i=UtSystem.getUserTimeMSec(),r=0;switch(this.eyeState){case a.STATE_CLOSING:(r=(i-this.stateStartTime)/this.closingMotionMsec)>=1&&(r=1,this.eyeState=a.STATE_CLOSED,this.stateStartTime=i),e=1-r;break;case a.STATE_CLOSED:(r=(i-this.stateStartTime)/this.closedMotionMsec)>=1&&(this.eyeState=a.STATE_OPENING,this.stateStartTime=i),e=0;break;case a.STATE_OPENING:(r=(i-this.stateStartTime)/this.openingMotionMsec)>=1&&(r=1,this.eyeState=a.STATE_INTERVAL,this.nextBlinkTime=this.calcNextBlink()),e=r;break;case a.STATE_INTERVAL:this.nextBlinkTime<i&&(this.eyeState=a.STATE_CLOSING,this.stateStartTime=i),e=1;break;case a.STATE_FIRST:default:this.eyeState=a.STATE_INTERVAL,this.nextBlinkTime=this.calcNextBlink(),e=1}this.closeIfZero||(e=-e),t.setParamFloat(this.eyeID_L,e),t.setParamFloat(this.eyeID_R,e)};var a=function(){};function l(){this.tr=new Float32Array(16),this.identity()}function h(t,e){l.prototype.constructor.call(this),this.width=t,this.height=e}function u(){MotionQueueManager.prototype.constructor.call(this),this.currentPriority=null,this.reservePriority=null,this.super=MotionQueueManager.prototype}function _(){this.physicsList=new Array,this.startTimeMSec=UtSystem.getUserTimeMSec()}function c(){this.lastTime=0,this.lastModel=null,this.partsGroups=new Array}function g(t){this.paramIndex=-1,this.partsIndex=-1,this.link=null,this.id=t}function p(){this.EPSILON=.01,this.faceTargetX=0,this.faceTargetY=0,this.faceX=0,this.faceY=0,this.faceVX=0,this.faceVY=0,this.lastTimeSec=0}function d(){l.prototype.constructor.call(this),this.screenLeft=null,this.screenRight=null,this.screenTop=null,this.screenBottom=null,this.maxLeft=null,this.maxRight=null,this.maxTop=null,this.maxBottom=null,this.max=Number.MAX_VALUE,this.min=0}function f(){}a.STATE_FIRST="STATE_FIRST",a.STATE_INTERVAL="STATE_INTERVAL",a.STATE_CLOSING="STATE_CLOSING",a.STATE_CLOSED="STATE_CLOSED",a.STATE_OPENING="STATE_OPENING",l.mul=function(t,e,i){var r,s,n,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<4;r++)for(s=0;s<4;s++)for(n=0;n<4;n++)o[r+4*s]+=t[r+4*n]*e[n+4*s];for(r=0;r<16;r++)i[r]=o[r]},l.prototype.identity=function(){for(var t=0;t<16;t++)this.tr[t]=t%5==0?1:0},l.prototype.getArray=function(){return this.tr},l.prototype.getCopyMatrix=function(){return new Float32Array(this.tr)},l.prototype.setMatrix=function(t){if(null!=this.tr&&this.tr.length==this.tr.length)for(var e=0;e<16;e++)this.tr[e]=t[e]},l.prototype.getScaleX=function(){return this.tr[0]},l.prototype.getScaleY=function(){return this.tr[5]},l.prototype.transformX=function(t){return this.tr[0]*t+this.tr[12]},l.prototype.transformY=function(t){return this.tr[5]*t+this.tr[13]},l.prototype.invertTransformX=function(t){return(t-this.tr[12])/this.tr[0]},l.prototype.invertTransformY=function(t){return(t-this.tr[13])/this.tr[5]},l.prototype.multTranslate=function(t,e){var i=[1,0,0,0,0,1,0,0,0,0,1,0,t,e,0,1];l.mul(i,this.tr,this.tr)},l.prototype.translate=function(t,e){this.tr[12]=t,this.tr[13]=e},l.prototype.translateX=function(t){this.tr[12]=t},l.prototype.translateY=function(t){this.tr[13]=t},l.prototype.multScale=function(t,e){var i=[t,0,0,0,0,e,0,0,0,0,1,0,0,0,0,1];l.mul(i,this.tr,this.tr)},l.prototype.scale=function(t,e){this.tr[0]=t,this.tr[5]=e},h.prototype=new l,h.prototype.setPosition=function(t,e){this.translate(t,e)},h.prototype.setCenterPosition=function(t,e){var i=this.width*this.getScaleX(),r=this.height*this.getScaleY();this.translate(t-i/2,e-r/2)},h.prototype.top=function(t){this.setY(t)},h.prototype.bottom=function(t){var e=this.height*this.getScaleY();this.translateY(t-e)},h.prototype.left=function(t){this.setX(t)},h.prototype.right=function(t){var e=this.width*this.getScaleX();this.translateX(t-e)},h.prototype.centerX=function(t){var e=this.width*this.getScaleX();this.translateX(t-e/2)},h.prototype.centerY=function(t){var e=this.height*this.getScaleY();this.translateY(t-e/2)},h.prototype.setX=function(t){this.translateX(t)},h.prototype.setY=function(t){this.translateY(t)},h.prototype.setHeight=function(t){var e=t/this.height,i=-e;this.scale(e,i)},h.prototype.setWidth=function(t){var e=t/this.width,i=-e;this.scale(e,i)},u.prototype=new MotionQueueManager,u.prototype.getCurrentPriority=function(){return this.currentPriority},u.prototype.getReservePriority=function(){return this.reservePriority},u.prototype.reserveMotion=function(t){return!(this.reservePriority>=t)&&(!(this.currentPriority>=t)&&(this.reservePriority=t,!0))},u.prototype.setReservePriority=function(t){this.reservePriority=t},u.prototype.updateParam=function(t){var e=MotionQueueManager.prototype.updateParam.call(this,t);return this.isFinished()&&(this.currentPriority=0),e},u.prototype.startMotionPrio=function(t,e){return e==this.reservePriority&&(this.reservePriority=0),this.currentPriority=e,this.startMotion(t,!1)},_.load=function(t){for(var e=new _,i=f.getPlatformManager().jsonParseFromBytes(t).physics_hair,r=i.length,s=0;s<r;s++){var n=i[s],o=new PhysicsHair,a=n.setup,l=parseFloat(a.length),h=parseFloat(a.regist),u=parseFloat(a.mass);o.setup(l,h,u);for(var c=n.src,g=c.length,p=0;p<g;p++){var d=c[p],m=d.id,$=PhysicsHair.Src.SRC_TO_X;"x"===(P=d.ptype)?$=PhysicsHair.Src.SRC_TO_X:"y"===P?$=PhysicsHair.Src.SRC_TO_Y:"angle"===P?$=PhysicsHair.Src.SRC_TO_G_ANGLE:UtDebug.error("live2d","Invalid parameter:PhysicsHair.Src");var y=parseFloat(d.scale),S=parseFloat(d.weight);o.addSrcParam($,m,y,S)}var x=n.targets,v=x.length;for(p=0;p<v;p++){var P,T=x[p];m=T.id,$=PhysicsHair.Target.TARGET_FROM_ANGLE;"angle"===(P=T.ptype)?$=PhysicsHair.Target.TARGET_FROM_ANGLE:"angle_v"===P?$=PhysicsHair.Target.TARGET_FROM_ANGLE_V:UtDebug.error("live2d","Invalid parameter:PhysicsHair.Target");y=parseFloat(T.scale),S=parseFloat(T.weight);o.addTargetParam($,m,y,S)}e.physicsList.push(o)}return e},_.prototype.updateParam=function(t){for(var e=UtSystem.getUserTimeMSec()-this.startTimeMSec,i=0;i<this.physicsList.length;i++)this.physicsList[i].update(t,e)},c.load=function(t){for(var e=new c,i=f.getPlatformManager().jsonParseFromBytes(t).parts_visible,r=i.length,s=0;s<r;s++){for(var n=i[s].group,o=n.length,a=new Array,l=0;l<o;l++){var h=n[l],u=new g(h.id);if(a[l]=u,null!=h.link){var _=h.link,p=_.length;u.link=new Array;for(var d=0;d<p;d++){var m=new g(_[d]);u.link.push(m)}}}e.partsGroups.push(a)}return e},c.prototype.updateParam=function(t){if(null!=t){t!=this.lastModel&&this.initParam(t),this.lastModel=t;var e=UtSystem.getUserTimeMSec(),i=0==this.lastTime?0:(e-this.lastTime)/1e3;this.lastTime=e,i<0&&(i=0);for(var r=0;r<this.partsGroups.length;r++)this.normalizePartsOpacityGroup(t,this.partsGroups[r],i),this.copyOpacityOtherParts(t,this.partsGroups[r])}},c.prototype.initParam=function(t){if(null!=t)for(var e=0;e<this.partsGroups.length;e++)for(var i=this.partsGroups[e],r=0;r<i.length;r++){i[r].initIndex(t);var s=i[r].partsIndex,n=i[r].paramIndex;if(!(s<0)){var o=0!=t.getParamFloat(n);if(t.setPartsOpacity(s,o?1:0),t.setParamFloat(n,o?1:0),null!=i[r].link)for(var a=0;a<i[r].link.length;a++)i[r].link[a].initIndex(t)}}},c.prototype.normalizePartsOpacityGroup=function(t,e,i){for(var r=-1,s=1,n=0;n<e.length;n++){var o=e[n].partsIndex,a=e[n].paramIndex;if(!(o<0)&&0!=t.getParamFloat(a)){if(r>=0)break;r=n,s=t.getPartsOpacity(o),(s+=i/.5)>1&&(s=1)}}r<0&&(r=0,s=1);for(n=0;n<e.length;n++){if(!((o=e[n].partsIndex)<0))if(r==n)t.setPartsOpacity(o,s);else{var l,h=t.getPartsOpacity(o);(1-(l=s<.5?-.5*s/.5+1:.5*(1-s)/.5))*(1-s)>.15&&(l=1-.15/(1-s)),h>l&&(h=l),t.setPartsOpacity(o,h)}}},c.prototype.copyOpacityOtherParts=function(t,e){for(var i=0;i<e.length;i++){var r=e[i];if(null!=r.link&&!(r.partsIndex<0))for(var s=t.getPartsOpacity(r.partsIndex),n=0;n<r.link.length;n++){var o=r.link[n];o.partsIndex<0||t.setPartsOpacity(o.partsIndex,s)}}},g.prototype.initIndex=function(t){this.paramIndex=t.getParamIndex("VISIBLE:"+this.id),this.partsIndex=t.getPartsDataIndex(PartsDataID.getID(this.id)),t.setParamFloat(this.paramIndex,1)},p.FRAME_RATE=30,p.prototype.setPoint=function(t,e){this.faceTargetX=t,this.faceTargetY=e},p.prototype.getX=function(){return this.faceX},p.prototype.getY=function(){return this.faceY},p.prototype.update=function(){var t=40/7.5/p.FRAME_RATE;if(0!=this.lastTimeSec){var e=UtSystem.getUserTimeMSec(),i=(e-this.lastTimeSec)*p.FRAME_RATE/1e3;this.lastTimeSec=e;var r=i*t/(.15*p.FRAME_RATE),s=this.faceTargetX-this.faceX,n=this.faceTargetY-this.faceY;if(!(Math.abs(s)<=this.EPSILON&&Math.abs(n)<=this.EPSILON)){var o=Math.sqrt(s*s+n*n),a=t*n/o,l=t*s/o-this.faceVX,h=a-this.faceVY,u=Math.sqrt(l*l+h*h);(u<-r||u>r)&&(l*=r/u,h*=r/u,u=r),this.faceVX+=l,this.faceVY+=h;var _=.5*(Math.sqrt(r*r+16*r*o-8*r*o)-r),c=Math.sqrt(this.faceVX*this.faceVX+this.faceVY*this.faceVY);c>_&&(this.faceVX*=_/c,this.faceVY*=_/c),this.faceX+=this.faceVX,this.faceY+=this.faceVY}}else this.lastTimeSec=UtSystem.getUserTimeMSec()},d.prototype=new l,d.prototype.getMaxScale=function(){return this.max},d.prototype.getMinScale=function(){return this.min},d.prototype.setMaxScale=function(t){this.max=t},d.prototype.setMinScale=function(t){this.min=t},d.prototype.isMaxScale=function(){return this.getScaleX()==this.max},d.prototype.isMinScale=function(){return this.getScaleX()==this.min},d.prototype.adjustTranslate=function(t,e){this.tr[0]*this.maxLeft+(this.tr[12]+t)>this.screenLeft&&(t=this.screenLeft-this.tr[0]*this.maxLeft-this.tr[12]),this.tr[0]*this.maxRight+(this.tr[12]+t)<this.screenRight&&(t=this.screenRight-this.tr[0]*this.maxRight-this.tr[12]),this.tr[5]*this.maxTop+(this.tr[13]+e)<this.screenTop&&(e=this.screenTop-this.tr[5]*this.maxTop-this.tr[13]),this.tr[5]*this.maxBottom+(this.tr[13]+e)>this.screenBottom&&(e=this.screenBottom-this.tr[5]*this.maxBottom-this.tr[13]);var i=[1,0,0,0,0,1,0,0,0,0,1,0,t,e,0,1];l.mul(i,this.tr,this.tr)},d.prototype.adjustScale=function(t,e,i){var r=i*this.tr[0];r<this.min?this.tr[0]>0&&(i=this.min/this.tr[0]):r>this.max&&this.tr[0]>0&&(i=this.max/this.tr[0]);var s=[1,0,0,0,0,1,0,0,0,0,1,0,t,e,0,1],n=[i,0,0,0,0,i,0,0,0,0,1,0,0,0,0,1],o=[1,0,0,0,0,1,0,0,0,0,1,0,-t,-e,0,1];l.mul(o,this.tr,this.tr),l.mul(n,this.tr,this.tr),l.mul(s,this.tr,this.tr)},d.prototype.setScreenRect=function(t,e,i,r){this.screenLeft=t,this.screenRight=e,this.screenTop=r,this.screenBottom=i},d.prototype.setMaxScreenRect=function(t,e,i,r){this.maxLeft=t,this.maxRight=e,this.maxTop=r,this.maxBottom=i},d.prototype.getScreenLeft=function(){return this.screenLeft},d.prototype.getScreenRight=function(){return this.screenRight},d.prototype.getScreenBottom=function(){return this.screenBottom},d.prototype.getScreenTop=function(){return this.screenTop},d.prototype.getMaxLeft=function(){return this.maxLeft},d.prototype.getMaxRight=function(){return this.maxRight},d.prototype.getMaxBottom=function(){return this.maxBottom},d.prototype.getMaxTop=function(){return this.maxTop},f.platformManager=null,f.getPlatformManager=function(){return f.platformManager},f.setPlatformManager=function(t){f.platformManager=t},t.exports={L2DTargetPoint:p,Live2DFramework:f,L2DViewMatrix:d,L2DPose:c,L2DPartsParam:g,L2DPhysics:_,L2DMotionManager:u,L2DModelMatrix:h,L2DMatrix44:l,EYE_STATE:a,L2DEyeBlink:o,L2DExpressionParam:n,L2DExpressionMotion:s,L2DBaseModel:i}},function(t,e){var i=t.exports={version:"2.6.11"};"number"==typeof __e&&(__e=i)},function(t,e,i){var r=i(7);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e,i){var r=i(11),s=i(28);t.exports=i(8)?function(t,e,i){return r.f(t,e,s(1,i))}:function(t,e,i){return t[e]=i,t}},function(t,e,i){var r=i(1),s=i(5),n=i(12),o=i(19)("src"),a=i(43),l=(""+a).split("toString");i(3).inspectSource=function(t){return a.call(t)},(t.exports=function(t,e,i,a){var h="function"==typeof i;h&&(n(i,"name")||s(i,"name",e)),t[e]!==i&&(h&&(n(i,o)||s(i,o,t[e]?""+t[e]:l.join(String(e)))),t===r?t[e]=i:a?t[e]?t[e]=i:s(t,e,i):(delete t[e],s(t,e,i)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[o]||a.call(this)}))},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,i){t.exports=!i(27)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(t,e){t.exports={}},function(t,e){var i={}.toString;t.exports=function(t){return i.call(t).slice(8,-1)}},function(t,e,i){var r=i(4),s=i(41),n=i(42),o=Object.defineProperty;e.f=i(8)?Object.defineProperty:function(t,e,i){if(r(t),e=n(e,!0),r(i),s)try{return o(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(t[e]=i.value),t}},function(t,e){var i={}.hasOwnProperty;t.exports=function(t,e){return i.call(t,e)}},function(t,e,i){var r=i(1),s=i(3),n=i(5),o=i(6),a=i(14),l=function(t,e,i){var h,u,_,c,g=t&l.F,p=t&l.G,d=t&l.S,f=t&l.P,m=t&l.B,$=p?r:d?r[e]||(r[e]={}):(r[e]||{}).prototype,y=p?s:s[e]||(s[e]={}),S=y.prototype||(y.prototype={});for(h in p&&(i=e),i)_=((u=!g&&$&&void 0!==$[h])?$:i)[h],c=m&&u?a(_,r):f&&"function"==typeof _?a(Function.call,_):_,$&&o($,h,_,t&l.U),y[h]!=_&&n(y,h,c),f&&S[h]!=_&&(S[h]=_)};r.core=s,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},function(t,e,i){var r=i(15);t.exports=function(t,e,i){if(r(t),void 0===e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,r){return t.call(e,i,r)};case 3:return function(i,r,s){return t.call(e,i,r,s)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,i){var r=i(10),s=i(0)("toStringTag"),n="Arguments"==r(function(){return arguments}());t.exports=function(t){var e,i,o;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),s))?i:n?r(e):"Object"==(o=r(e))&&"function"==typeof e.callee?"Arguments":o}},function(t,e,i){var r=i(3),s=i(1),n=s["__core-js_shared__"]||(s["__core-js_shared__"]={});(t.exports=function(t,e){return n[t]||(n[t]=void 0!==e?e:{})})("versions",[]).push({version:r.version,mode:i(18)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(t,e){t.exports=!1},function(t,e){var i=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++i+r).toString(36))}},function(t,e,i){var r=i(7),s=i(1).document,n=r(s)&&r(s.createElement);t.exports=function(t){return n?s.createElement(t):{}}},function(t,e){var i=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:i)(t)}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,i){var r=i(50),s=i(22);t.exports=function(t){return r(s(t))}},function(t,e,i){var r=i(17)("keys"),s=i(19);t.exports=function(t){return r[t]||(r[t]=s(t))}},function(t,e,i){var r=i(11).f,s=i(12),n=i(0)("toStringTag");t.exports=function(t,e,i){t&&!s(t=i?t:t.prototype,n)&&r(t,n,{configurable:!0,value:e})}},function(t,e,i){"use strict";var r=i(15);function s(t){var e,i;this.promise=new t((function(t,r){if(void 0!==e||void 0!==i)throw TypeError("Bad Promise constructor");e=t,i=r})),this.resolve=r(e),this.reject=r(i)}t.exports.f=function(t){return new s(t)}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,i){"use strict";var r=i(18),s=i(13),n=i(6),o=i(5),a=i(9),l=i(46),h=i(25),u=i(53),_=i(0)("iterator"),c=!([].keys&&"next"in[].keys()),g=function(){return this};t.exports=function(t,e,i,p,d,f,m){l(i,e,p);var $,y,S,x=function(t){if(!c&&t in M)return M[t];switch(t){case"keys":case"values":return function(){return new i(this,t)}}return function(){return new i(this,t)}},v=e+" Iterator",P="values"==d,T=!1,M=t.prototype,w=M[_]||M["@@iterator"]||d&&M[d],I=w||x(d),C=d?P?x("entries"):I:void 0,L="Array"==e&&M.entries||w;if(L&&(S=u(L.call(new t)))!==Object.prototype&&S.next&&(h(S,v,!0),r||"function"==typeof S[_]||o(S,_,g)),P&&w&&"values"!==w.name&&(T=!0,I=function(){return w.call(this)}),r&&!m||!c&&!T&&M[_]||o(M,_,I),a[e]=I,a[v]=g,d)if($={values:P?I:x("values"),keys:f?I:x("keys"),entries:C},m)for(y in $)y in M||n(M,y,$[y]);else s(s.P+s.F*(c||T),e,$);return $}},function(t,e,i){var r=i(49),s=i(32);t.exports=Object.keys||function(t){return r(t,s)}},function(t,e,i){var r=i(21),s=Math.min;t.exports=function(t){return t>0?s(r(t),9007199254740991):0}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,i){var r=i(1).document;t.exports=r&&r.documentElement},function(t,e,i){var r=i(4),s=i(15),n=i(0)("species");t.exports=function(t,e){var i,o=r(t).constructor;return void 0===o||null==(i=r(o)[n])?e:s(i)}},function(t,e,i){var r,s,n,o=i(14),a=i(65),l=i(33),h=i(20),u=i(1),_=u.process,c=u.setImmediate,g=u.clearImmediate,p=u.MessageChannel,d=u.Dispatch,f=0,m={},$=function(){var t=+this;if(m.hasOwnProperty(t)){var e=m[t];delete m[t],e()}},y=function(t){$.call(t.data)};c&&g||(c=function(t){for(var e=[],i=1;arguments.length>i;)e.push(arguments[i++]);return m[++f]=function(){a("function"==typeof t?t:Function(t),e)},r(f),f},g=function(t){delete m[t]},"process"==i(10)(_)?r=function(t){_.nextTick(o($,t,1))}:d&&d.now?r=function(t){d.now(o($,t,1))}:p?(n=(s=new p).port2,s.port1.onmessage=y,r=o(n.postMessage,n,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(r=function(t){u.postMessage(t+"","*")},u.addEventListener("message",y,!1)):r="onreadystatechange"in h("script")?function(t){l.appendChild(h("script")).onreadystatechange=function(){l.removeChild(this),$.call(t)}}:function(t){setTimeout(o($,t,1),0)}),t.exports={set:c,clear:g}},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,i){var r=i(4),s=i(7),n=i(26);t.exports=function(t,e){if(r(t),s(e)&&e.constructor===t)return e;var i=n.f(t);return(0,i.resolve)(e),i.promise}},function(t,e,i){i(39),t.exports=i(76)},function(t,e,i){i(40),i(44),i(55),i(59),i(71),i(72),t.exports=i(3).Promise},function(t,e,i){"use strict";var r=i(16),s={};s[i(0)("toStringTag")]="z",s+""!="[object z]"&&i(6)(Object.prototype,"toString",(function(){return"[object "+r(this)+"]"}),!0)},function(t,e,i){t.exports=!i(8)&&!i(27)((function(){return 7!=Object.defineProperty(i(20)("div"),"a",{get:function(){return 7}}).a}))},function(t,e,i){var r=i(7);t.exports=function(t,e){if(!r(t))return t;var i,s;if(e&&"function"==typeof(i=t.toString)&&!r(s=i.call(t)))return s;if("function"==typeof(i=t.valueOf)&&!r(s=i.call(t)))return s;if(!e&&"function"==typeof(i=t.toString)&&!r(s=i.call(t)))return s;throw TypeError("Can't convert object to primitive value")}},function(t,e,i){t.exports=i(17)("native-function-to-string",Function.toString)},function(t,e,i){"use strict";var r=i(45)(!0);i(29)(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,i=this._i;return i>=e.length?{value:void 0,done:!0}:(t=r(e,i),this._i+=t.length,{value:t,done:!1})}))},function(t,e,i){var r=i(21),s=i(22);t.exports=function(t){return function(e,i){var n,o,a=String(s(e)),l=r(i),h=a.length;return l<0||l>=h?t?"":void 0:(n=a.charCodeAt(l))<55296||n>56319||l+1===h||(o=a.charCodeAt(l+1))<56320||o>57343?t?a.charAt(l):n:t?a.slice(l,l+2):o-56320+(n-55296<<10)+65536}}},function(t,e,i){"use strict";var r=i(47),s=i(28),n=i(25),o={};i(5)(o,i(0)("iterator"),(function(){return this})),t.exports=function(t,e,i){t.prototype=r(o,{next:s(1,i)}),n(t,e+" Iterator")}},function(t,e,i){var r=i(4),s=i(48),n=i(32),o=i(24)("IE_PROTO"),a=function(){},l=function(){var t,e=i(20)("iframe"),r=n.length;for(e.style.display="none",i(33).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),l=t.F;r--;)delete l.prototype[n[r]];return l()};t.exports=Object.create||function(t,e){var i;return null!==t?(a.prototype=r(t),i=new a,a.prototype=null,i[o]=t):i=l(),void 0===e?i:s(i,e)}},function(t,e,i){var r=i(11),s=i(4),n=i(30);t.exports=i(8)?Object.defineProperties:function(t,e){s(t);for(var i,o=n(e),a=o.length,l=0;a>l;)r.f(t,i=o[l++],e[i]);return t}},function(t,e,i){var r=i(12),s=i(23),n=i(51)(!1),o=i(24)("IE_PROTO");t.exports=function(t,e){var i,a=s(t),l=0,h=[];for(i in a)i!=o&&r(a,i)&&h.push(i);for(;e.length>l;)r(a,i=e[l++])&&(~n(h,i)||h.push(i));return h}},function(t,e,i){var r=i(10);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,e,i){var r=i(23),s=i(31),n=i(52);t.exports=function(t){return function(e,i,o){var a,l=r(e),h=s(l.length),u=n(o,h);if(t&&i!=i){for(;h>u;)if((a=l[u++])!=a)return!0}else for(;h>u;u++)if((t||u in l)&&l[u]===i)return t||u||0;return!t&&-1}}},function(t,e,i){var r=i(21),s=Math.max,n=Math.min;t.exports=function(t,e){return(t=r(t))<0?s(t+e,0):n(t,e)}},function(t,e,i){var r=i(12),s=i(54),n=i(24)("IE_PROTO"),o=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=s(t),r(t,n)?t[n]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?o:null}},function(t,e,i){var r=i(22);t.exports=function(t){return Object(r(t))}},function(t,e,i){for(var r=i(56),s=i(30),n=i(6),o=i(1),a=i(5),l=i(9),h=i(0),u=h("iterator"),_=h("toStringTag"),c=l.Array,g={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=s(g),d=0;d<p.length;d++){var f,m=p[d],$=g[m],y=o[m],S=y&&y.prototype;if(S&&(S[u]||a(S,u,c),S[_]||a(S,_,m),l[m]=c,$))for(f in r)S[f]||n(S,f,r[f],!0)}},function(t,e,i){"use strict";var r=i(57),s=i(58),n=i(9),o=i(23);t.exports=i(29)(Array,"Array",(function(t,e){this._t=o(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,i=this._i++;return!t||i>=t.length?(this._t=void 0,s(1)):s(0,"keys"==e?i:"values"==e?t[i]:[i,t[i]])}),"values"),n.Arguments=n.Array,r("keys"),r("values"),r("entries")},function(t,e,i){var r=i(0)("unscopables"),s=Array.prototype;null==s[r]&&i(5)(s,r,{}),t.exports=function(t){s[r][t]=!0}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,i){"use strict";var r,s,n,o,a=i(18),l=i(1),h=i(14),u=i(16),_=i(13),c=i(7),g=i(15),p=i(60),d=i(61),f=i(34),m=i(35).set,$=i(66)(),y=i(26),S=i(36),x=i(67),v=i(37),P=l.TypeError,T=l.process,M=T&&T.versions,w=M&&M.v8||"",I=l.Promise,C="process"==u(T),L=function(){},b=s=y.f,E=!!function(){try{var t=I.resolve(1),e=(t.constructor={})[i(0)("species")]=function(t){t(L,L)};return(C||"function"==typeof PromiseRejectionEvent)&&t.then(L)instanceof e&&0!==w.indexOf("6.6")&&-1===x.indexOf("Chrome/66")}catch(t){}}(),B=function(t){var e;return!(!c(t)||"function"!=typeof(e=t.then))&&e},A=function(t,e){if(!t._n){t._n=!0;var i=t._c;$((function(){for(var r=t._v,s=1==t._s,n=0,o=function(e){var i,n,o,a=s?e.ok:e.fail,l=e.resolve,h=e.reject,u=e.domain;try{a?(s||(2==t._h&&R(t),t._h=1),!0===a?i=r:(u&&u.enter(),i=a(r),u&&(u.exit(),o=!0)),i===e.promise?h(P("Promise-chain cycle")):(n=B(i))?n.call(i,l,h):l(i)):h(r)}catch(t){u&&!o&&u.exit(),h(t)}};i.length>n;)o(i[n++]);t._c=[],t._n=!1,e&&!t._h&&F(t)}))}},F=function(t){m.call(l,(function(){var e,i,r,s=t._v,n=D(t);if(n&&(e=S((function(){C?T.emit("unhandledRejection",s,t):(i=l.onunhandledrejection)?i({promise:t,reason:s}):(r=l.console)&&r.error&&r.error("Unhandled promise rejection",s)})),t._h=C||D(t)?2:1),t._a=void 0,n&&e.e)throw e.v}))},D=function(t){return 1!==t._h&&0===(t._a||t._c).length},R=function(t){m.call(l,(function(){var e;C?T.emit("rejectionHandled",t):(e=l.onrejectionhandled)&&e({promise:t,reason:t._v})}))},V=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),A(e,!0))},O=function(t){var e,i=this;if(!i._d){i._d=!0,i=i._w||i;try{if(i===t)throw P("Promise can't be resolved itself");(e=B(t))?$((function(){var r={_w:i,_d:!1};try{e.call(t,h(O,r,1),h(V,r,1))}catch(t){V.call(r,t)}})):(i._v=t,i._s=1,A(i,!1))}catch(t){V.call({_w:i,_d:!1},t)}}};E||(I=function(t){p(this,I,"Promise","_h"),g(t),r.call(this);try{t(h(O,this,1),h(V,this,1))}catch(t){V.call(this,t)}},(r=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=i(68)(I.prototype,{then:function(t,e){var i=b(f(this,I));return i.ok="function"!=typeof t||t,i.fail="function"==typeof e&&e,i.domain=C?T.domain:void 0,this._c.push(i),this._a&&this._a.push(i),this._s&&A(this,!1),i.promise},catch:function(t){return this.then(void 0,t)}}),n=function(){var t=new r;this.promise=t,this.resolve=h(O,t,1),this.reject=h(V,t,1)},y.f=b=function(t){return t===I||t===o?new n(t):s(t)}),_(_.G+_.W+_.F*!E,{Promise:I}),i(25)(I,"Promise"),i(69)("Promise"),o=i(3).Promise,_(_.S+_.F*!E,"Promise",{reject:function(t){var e=b(this);return(0,e.reject)(t),e.promise}}),_(_.S+_.F*(a||!E),"Promise",{resolve:function(t){return v(a&&this===o?I:this,t)}}),_(_.S+_.F*!(E&&i(70)((function(t){I.all(t).catch(L)}))),"Promise",{all:function(t){var e=this,i=b(e),r=i.resolve,s=i.reject,n=S((function(){var i=[],n=0,o=1;d(t,!1,(function(t){var a=n++,l=!1;i.push(void 0),o++,e.resolve(t).then((function(t){l||(l=!0,i[a]=t,--o||r(i))}),s)})),--o||r(i)}));return n.e&&s(n.v),i.promise},race:function(t){var e=this,i=b(e),r=i.reject,s=S((function(){d(t,!1,(function(t){e.resolve(t).then(i.resolve,r)}))}));return s.e&&r(s.v),i.promise}})},function(t,e){t.exports=function(t,e,i,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(i+": incorrect invocation!");return t}},function(t,e,i){var r=i(14),s=i(62),n=i(63),o=i(4),a=i(31),l=i(64),h={},u={};(e=t.exports=function(t,e,i,_,c){var g,p,d,f,m=c?function(){return t}:l(t),$=r(i,_,e?2:1),y=0;if("function"!=typeof m)throw TypeError(t+" is not iterable!");if(n(m)){for(g=a(t.length);g>y;y++)if((f=e?$(o(p=t[y])[0],p[1]):$(t[y]))===h||f===u)return f}else for(d=m.call(t);!(p=d.next()).done;)if((f=s(d,$,p.value,e))===h||f===u)return f}).BREAK=h,e.RETURN=u},function(t,e,i){var r=i(4);t.exports=function(t,e,i,s){try{return s?e(r(i)[0],i[1]):e(i)}catch(e){var n=t.return;throw void 0!==n&&r(n.call(t)),e}}},function(t,e,i){var r=i(9),s=i(0)("iterator"),n=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||n[s]===t)}},function(t,e,i){var r=i(16),s=i(0)("iterator"),n=i(9);t.exports=i(3).getIteratorMethod=function(t){if(null!=t)return t[s]||t["@@iterator"]||n[r(t)]}},function(t,e){t.exports=function(t,e,i){var r=void 0===i;switch(e.length){case 0:return r?t():t.call(i);case 1:return r?t(e[0]):t.call(i,e[0]);case 2:return r?t(e[0],e[1]):t.call(i,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(i,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(i,e[0],e[1],e[2],e[3])}return t.apply(i,e)}},function(t,e,i){var r=i(1),s=i(35).set,n=r.MutationObserver||r.WebKitMutationObserver,o=r.process,a=r.Promise,l="process"==i(10)(o);t.exports=function(){var t,e,i,h=function(){var r,s;for(l&&(r=o.domain)&&r.exit();t;){s=t.fn,t=t.next;try{s()}catch(r){throw t?i():e=void 0,r}}e=void 0,r&&r.enter()};if(l)i=function(){o.nextTick(h)};else if(!n||r.navigator&&r.navigator.standalone)if(a&&a.resolve){var u=a.resolve(void 0);i=function(){u.then(h)}}else i=function(){s.call(r,h)};else{var _=!0,c=document.createTextNode("");new n(h).observe(c,{characterData:!0}),i=function(){c.data=_=!_}}return function(r){var s={fn:r,next:void 0};e&&(e.next=s),t||(t=s,i()),e=s}}},function(t,e,i){var r=i(1).navigator;t.exports=r&&r.userAgent||""},function(t,e,i){var r=i(6);t.exports=function(t,e,i){for(var s in e)r(t,s,e[s],i);return t}},function(t,e,i){"use strict";var r=i(1),s=i(11),n=i(8),o=i(0)("species");t.exports=function(t){var e=r[t];n&&e&&!e[o]&&s.f(e,o,{configurable:!0,get:function(){return this}})}},function(t,e,i){var r=i(0)("iterator"),s=!1;try{var n=[7][r]();n.return=function(){s=!0},Array.from(n,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!s)return!1;var i=!1;try{var n=[7],o=n[r]();o.next=function(){return{done:i=!0}},n[r]=function(){return o},t(n)}catch(t){}return i}},function(t,e,i){"use strict";var r=i(13),s=i(3),n=i(1),o=i(34),a=i(37);r(r.P+r.R,"Promise",{finally:function(t){var e=o(this,s.Promise||n.Promise),i="function"==typeof t;return this.then(i?function(i){return a(e,t()).then((function(){return i}))}:t,i?function(i){return a(e,t()).then((function(){throw i}))}:t)}})},function(t,e,i){"use strict";var r=i(13),s=i(26),n=i(36);r(r.S,"Promise",{try:function(t){var e=s.f(this),i=n(t);return(i.e?e.reject:e.resolve)(i.v),e.promise}})},function(t,e,i){(function(t){!function(){var e=!0;function i(){e||(this._$MT=null,this._$5S=null,this._$NP=0,i._$42++,this._$5S=new z(this))}function r(t){if(!e){this.clipContextList=new Array,this.glcontext=t.gl,this.dp_webgl=t,this.curFrameNo=0,this.firstError_clipInNotUpdate=!0,this.colorBuffer=0,this.isInitGLFBFunc=!1,this.tmpBoundsOnModel=new P,ht.glContext.length>ht.frameBuffers.length&&(this.curFrameNo=this.getMaskRenderTexture()),this.tmpModelToViewMatrix=new F,this.tmpMatrix2=new F,this.tmpMatrixForMask=new F,this.tmpMatrixForDraw=new F,this.CHANNEL_COLORS=new Array;var i=new C;(i=new C).r=0,i.g=0,i.b=0,i.a=1,this.CHANNEL_COLORS.push(i),(i=new C).r=1,i.g=0,i.b=0,i.a=0,this.CHANNEL_COLORS.push(i),(i=new C).r=0,i.g=1,i.b=0,i.a=0,this.CHANNEL_COLORS.push(i),(i=new C).r=0,i.g=0,i.b=1,i.a=0,this.CHANNEL_COLORS.push(i);for(var r=0;r<this.CHANNEL_COLORS.length;r++)this.dp_webgl.setChannelFlagAsColor(r,this.CHANNEL_COLORS[r])}}function s(t,e,i){this.clipIDList=new Array,this.clipIDList=i,this.clippingMaskDrawIndexList=new Array;for(var r=0;r<i.length;r++)this.clippingMaskDrawIndexList.push(e.getDrawDataIndex(i[r]));this.clippedDrawContextList=new Array,this.isUsing=!0,this.layoutChannelNo=0,this.layoutBounds=new P,this.allClippedDrawRect=new P,this.matrixForMask=new Float32Array(16),this.matrixForDraw=new Float32Array(16),this.owner=t}function n(t,e){this._$gP=t,this.drawDataIndex=e}function o(){e||(this.color=null)}function a(){e||(this._$dP=null,this._$eo=null,this._$V0=null,this._$dP=1e3,this._$eo=1e3,this._$V0=1,this._$a0())}function l(){}function h(){this._$r=null,this._$0S=null}function u(){e||(this.x=null,this.y=null,this.width=null,this.height=null)}function _(t){e||st.prototype.constructor.call(this,t)}function c(t){e||st.prototype.constructor.call(this,t)}function g(){e||(this._$vo=null,this._$F2=null,this._$ao=400,this._$1S=400,g._$42++)}function p(){e||(this.p1=new d,this.p2=new d,this._$Fo=0,this._$Db=0,this._$L2=0,this._$M2=0,this._$ks=0,this._$9b=0,this._$iP=0,this._$iT=0,this._$lL=new Array,this._$qP=new Array,this.setup(.3,.5,.1))}function d(){this._$p=1,this.x=0,this.y=0,this.vx=0,this.vy=0,this.ax=0,this.ay=0,this.fx=0,this.fy=0,this._$s0=0,this._$70=0,this._$7L=0,this._$HL=0}function f(t,e,i){this._$wL=null,this.scale=null,this._$V0=null,this._$wL=t,this.scale=e,this._$V0=i}function $(t,e,i,r){f.prototype.constructor.call(this,e,i,r),this._$tL=null,this._$tL=t}function y(t,e,i){this._$wL=null,this.scale=null,this._$V0=null,this._$wL=t,this.scale=e,this._$V0=i}function S(t,e,i,r){y.prototype.constructor.call(this,e,i,r),this._$YP=null,this._$YP=t}function x(){e||(this._$fL=0,this._$gL=0,this._$B0=1,this._$z0=1,this._$qT=0,this.reflectX=!1,this.reflectY=!1)}i._$0s=1,i._$4s=2,i._$42=0,i._$62=function(t,e){try{if(e instanceof ArrayBuffer&&(e=new DataView(e)),!(e instanceof DataView))throw new _t("_$SS#loadModel(b) / b _$x be DataView or ArrayBuffer");var r,s=new Pt(e),n=s._$ST(),o=s._$ST(),a=s._$ST();if(109!=n||111!=o||99!=a)throw new _t("_$gi _$C _$li , _$Q0 _$P0.");if(r=s._$ST(),s._$gr(r),r>U._$T7)throw t._$NP|=i._$4s,new _t("_$gi _$C _$li , _$n0 _$_ version _$li ( SDK : "+U._$T7+" < _$f0 : "+r+" )@_$SS#loadModel()\n");var h=s._$nP();if(r>=U._$s7){var u=s._$9T(),_=s._$9T();if(-30584!=u||-30584!=_)throw t._$NP|=i._$0s,new _t("_$gi _$C _$li , _$0 _$6 _$Ui.")}t._$KS(h);var c=t.getModelContext();c.setDrawParam(t.getDrawParam()),c.init()}catch(t){l._$Rb(t)}},i.prototype._$KS=function(t){this._$MT=t},i.prototype.getModelImpl=function(){return null==this._$MT&&(this._$MT=new g,this._$MT._$zP()),this._$MT},i.prototype.getCanvasWidth=function(){return null==this._$MT?0:this._$MT.getCanvasWidth()},i.prototype.getCanvasHeight=function(){return null==this._$MT?0:this._$MT.getCanvasHeight()},i.prototype.getParamFloat=function(t){return"number"!=typeof t&&(t=this._$5S.getParamIndex(c.getID(t))),this._$5S.getParamFloat(t)},i.prototype.setParamFloat=function(t,e,i){"number"!=typeof t&&(t=this._$5S.getParamIndex(c.getID(t))),arguments.length<3&&(i=1),this._$5S.setParamFloat(t,this._$5S.getParamFloat(t)*(1-i)+e*i)},i.prototype.addToParamFloat=function(t,e,i){"number"!=typeof t&&(t=this._$5S.getParamIndex(c.getID(t))),arguments.length<3&&(i=1),this._$5S.setParamFloat(t,this._$5S.getParamFloat(t)+e*i)},i.prototype.multParamFloat=function(t,e,i){"number"!=typeof t&&(t=this._$5S.getParamIndex(c.getID(t))),arguments.length<3&&(i=1),this._$5S.setParamFloat(t,this._$5S.getParamFloat(t)*(1+(e-1)*i))},i.prototype.getParamIndex=function(t){return this._$5S.getParamIndex(c.getID(t))},i.prototype.loadParam=function(){this._$5S.loadParam()},i.prototype.saveParam=function(){this._$5S.saveParam()},i.prototype.init=function(){this._$5S.init()},i.prototype.update=function(){this._$5S.update()},i.prototype._$Rs=function(){return l._$li("_$60 _$PT _$Rs()"),-1},i.prototype._$Ds=function(t){l._$li("_$60 _$PT _$SS#_$Ds() \n")},i.prototype._$K2=function(){},i.prototype.draw=function(){},i.prototype.getModelContext=function(){return this._$5S},i.prototype._$s2=function(){return this._$NP},i.prototype._$P7=function(t,e,i,r){var s=-1,n=0,o=this;if(0!=i)if(1==t.length){g=t[0];var a=0!=o.getParamFloat(g),l=(p=e[0],o.getPartsOpacity(p)),h=i/r;a?(l+=h)>1&&(l=1):(l-=h)<0&&(l=0),o.setPartsOpacity(p,l)}else{for(c=0;c<t.length;c++){g=t[c];if(d=0!=o.getParamFloat(g)){if(s>=0)break;s=c;p=e[c];n=o.getPartsOpacity(p),(n+=i/r)>1&&(n=1)}}s<0&&(console.log("No _$wi _$q0/ _$U default[%s]",t[0]),s=0,n=1,o.loadParam(),o.setParamFloat(t[s],n),o.saveParam());for(c=0;c<t.length;c++){p=e[c];if(s==c)o.setPartsOpacity(p,n);else{var u,_=o.getPartsOpacity(p);(1-(u=n<.5?-.5*n/.5+1:.5*(1-n)/.5))*(1-n)>.15&&(u=1-.15/(1-n)),_>u&&(_=u),o.setPartsOpacity(p,_)}}}else for(var c=0;c<t.length;c++){var g=t[c],p=e[c],d=0!=o.getParamFloat(g);o.setPartsOpacity(p,d?1:0)}},i.prototype.setPartsOpacity=function(t,e){"number"!=typeof t&&(t=this._$5S.getPartsDataIndex(_.getID(t))),this._$5S.setPartsOpacity(t,e)},i.prototype.getPartsDataIndex=function(t){return t instanceof _||(t=_.getID(t)),this._$5S.getPartsDataIndex(t)},i.prototype.getPartsOpacity=function(t){return"number"!=typeof t&&(t=this._$5S.getPartsDataIndex(_.getID(t))),t<0?0:this._$5S.getPartsOpacity(t)},i.prototype.getDrawParam=function(){},i.prototype.getDrawDataIndex=function(t){return this._$5S.getDrawDataIndex(D.getID(t))},i.prototype.getDrawData=function(t){return this._$5S.getDrawData(t)},i.prototype.getTransformedPoints=function(t){var e=this._$5S._$C2(t);return e instanceof gt?e.getTransformedPoints():null},i.prototype.getIndexArray=function(t){if(t<0||t>=this._$5S._$aS.length)return null;var e=this._$5S._$aS[t];return null!=e&&e.getType()==W._$wb&&e instanceof ct?e.getIndexArray():null},r.CHANNEL_COUNT=4,r.RENDER_TEXTURE_USE_MIPMAP=!1,r.NOT_USED_FRAME=-100,r.prototype._$L7=function(){if(this.tmpModelToViewMatrix&&(this.tmpModelToViewMatrix=null),this.tmpMatrix2&&(this.tmpMatrix2=null),this.tmpMatrixForMask&&(this.tmpMatrixForMask=null),this.tmpMatrixForDraw&&(this.tmpMatrixForDraw=null),this.tmpBoundsOnModel&&(this.tmpBoundsOnModel=null),this.CHANNEL_COLORS){for(var t=this.CHANNEL_COLORS.length-1;t>=0;--t)this.CHANNEL_COLORS.splice(t,1);this.CHANNEL_COLORS=[]}this.releaseShader()},r.prototype.releaseShader=function(){for(var t=ht.frameBuffers.length,e=0;e<t;e++)this.gl.deleteFramebuffer(ht.frameBuffers[e].framebuffer);ht.frameBuffers=[],ht.glContext=[]},r.prototype.init=function(t,e,i){for(var r=0;r<e.length;r++){var n=e[r].getClipIDList();if(null!=n){var o=this.findSameClip(n);null==o&&(o=new s(this,t,n),this.clipContextList.push(o));var a=e[r].getDrawDataID(),l=t.getDrawDataIndex(a);o.addClippedDrawData(a,l),i[r].clipBufPre_clipContext=o}}},r.prototype.getMaskRenderTexture=function(){var t;return t=this.dp_webgl.createFramebuffer(),ht.frameBuffers[this.dp_webgl.glno]=t,this.dp_webgl.glno},r.prototype.setupClip=function(t,e){for(var i=0,r=0;r<this.clipContextList.length;r++){var s=this.clipContextList[r];this.calcClippedDrawTotalBounds(t,s),s.isUsing&&i++}if(i>0){var n=e.gl.getParameter(e.gl.FRAMEBUFFER_BINDING),o=new Array(4);o[0]=0,o[1]=0,o[2]=e.gl.canvas.width,o[3]=e.gl.canvas.height,e.gl.viewport(0,0,ht.clippingMaskBufferSize,ht.clippingMaskBufferSize),this.setupLayoutBounds(i),e.gl.bindFramebuffer(e.gl.FRAMEBUFFER,ht.frameBuffers[this.curFrameNo].framebuffer),e.gl.clearColor(0,0,0,0),e.gl.clear(e.gl.COLOR_BUFFER_BIT);for(r=0;r<this.clipContextList.length;r++){var a=(s=this.clipContextList[r]).allClippedDrawRect,l=(s.layoutChannelNo,s.layoutBounds);this.tmpBoundsOnModel._$jL(a),this.tmpBoundsOnModel.expand(.05*a.width,.05*a.height);var h=l.width/this.tmpBoundsOnModel.width,u=l.height/this.tmpBoundsOnModel.height;this.tmpMatrix2.identity(),this.tmpMatrix2.translate(-1,-1,0),this.tmpMatrix2.scale(2,2,1),this.tmpMatrix2.translate(l.x,l.y,0),this.tmpMatrix2.scale(h,u,1),this.tmpMatrix2.translate(-this.tmpBoundsOnModel.x,-this.tmpBoundsOnModel.y,0),this.tmpMatrixForMask.setMatrix(this.tmpMatrix2.m),this.tmpMatrix2.identity(),this.tmpMatrix2.translate(l.x,l.y,0),this.tmpMatrix2.scale(h,u,1),this.tmpMatrix2.translate(-this.tmpBoundsOnModel.x,-this.tmpBoundsOnModel.y,0),this.tmpMatrixForDraw.setMatrix(this.tmpMatrix2.m);for(var _=this.tmpMatrixForMask.getArray(),c=0;c<16;c++)s.matrixForMask[c]=_[c];var g=this.tmpMatrixForDraw.getArray();for(c=0;c<16;c++)s.matrixForDraw[c]=g[c];for(var p=s.clippingMaskDrawIndexList.length,d=0;d<p;d++){var f=s.clippingMaskDrawIndexList[d],m=t.getDrawData(f),$=t._$C2(f);e.setClipBufPre_clipContextForMask(s),m.draw(e,t,$)}}e.gl.bindFramebuffer(e.gl.FRAMEBUFFER,n),e.setClipBufPre_clipContextForMask(null),e.gl.viewport(o[0],o[1],o[2],o[3])}},r.prototype.getColorBuffer=function(){return this.colorBuffer},r.prototype.findSameClip=function(t){for(var e=0;e<this.clipContextList.length;e++){var i=this.clipContextList[e],r=i.clipIDList.length;if(r==t.length){for(var s=0,n=0;n<r;n++)for(var o=i.clipIDList[n],a=0;a<r;a++)if(t[a]==o){s++;break}if(s==r)return i}}return null},r.prototype.calcClippedDrawTotalBounds=function(t,e){for(var i=t._$Ri.getModelImpl().getCanvasWidth(),r=t._$Ri.getModelImpl().getCanvasHeight(),s=i>r?i:r,n=s,o=s,a=0,l=0,h=e.clippedDrawContextList.length,u=0;u<h;u++){var _=e.clippedDrawContextList[u].drawDataIndex,c=t._$C2(_);if(c._$yo()){for(var g=c.getTransformedPoints(),p=g.length,d=[],f=[],m=0,$=k._$i2;$<p;$+=k._$No)d[m]=g[$],f[m]=g[$+1],m++;var y=Math.min.apply(null,d),S=Math.min.apply(null,f),x=Math.max.apply(null,d),v=Math.max.apply(null,f);y<n&&(n=y),S<o&&(o=S),x>a&&(a=x),v>l&&(l=v)}}if(n==s)e.allClippedDrawRect.x=0,e.allClippedDrawRect.y=0,e.allClippedDrawRect.width=0,e.allClippedDrawRect.height=0,e.isUsing=!1;else{var P=a-n,T=l-o;e.allClippedDrawRect.x=n,e.allClippedDrawRect.y=o,e.allClippedDrawRect.width=P,e.allClippedDrawRect.height=T,e.isUsing=!0}},r.prototype.setupLayoutBounds=function(t){var e=t/r.CHANNEL_COUNT,i=t%r.CHANNEL_COUNT;e=~~e,i=~~i;for(var s=0,n=0;n<r.CHANNEL_COUNT;n++){var o=e+(n<i?1:0);if(0==o);else if(1==o)(_=this.clipContextList[s++]).layoutChannelNo=n,_.layoutBounds.x=0,_.layoutBounds.y=0,_.layoutBounds.width=1,_.layoutBounds.height=1;else if(2==o)for(var a=0;a<o;a++){var h=0;u=~~(u=a%2),(_=this.clipContextList[s++]).layoutChannelNo=n,_.layoutBounds.x=.5*u,_.layoutBounds.y=0,_.layoutBounds.width=.5,_.layoutBounds.height=1}else if(o<=4)for(a=0;a<o;a++){u=~~(u=a%2),h=~~(h=a/2),(_=this.clipContextList[s++]).layoutChannelNo=n,_.layoutBounds.x=.5*u,_.layoutBounds.y=.5*h,_.layoutBounds.width=.5,_.layoutBounds.height=.5}else if(o<=9)for(a=0;a<o;a++){var u,_;u=~~(u=a%3),h=~~(h=a/3),(_=this.clipContextList[s++]).layoutChannelNo=n,_.layoutBounds.x=u/3,_.layoutBounds.y=h/3,_.layoutBounds.width=1/3,_.layoutBounds.height=1/3}else l._$li("_$6 _$0P mask count : %d",o)}},s.prototype.addClippedDrawData=function(t,e){var i=new n(t,e);this.clippedDrawContextList.push(i)},a._$JT=function(t,e,i){var r=t/e,s=i/e,n=1-(1-s)*(1-s),o=1-(1-s)*(1-s),a=1/3*(1-s)*n+(s*(2/3)+1/3*(1-s))*(1-n),l=(s+2/3*(1-s))*o+(s*(1/3)+2/3*(1-s))*(1-o);if(r<=0)return 0;if(r>=1)return 1;var h=r*r;return(1-3*l+3*a-0)*(r*h)+(3*l-6*a+0)*h+(3*a-0)*r+0},a.prototype._$a0=function(){},a.prototype.setFadeIn=function(t){this._$dP=t},a.prototype.setFadeOut=function(t){this._$eo=t},a.prototype._$pT=function(t){this._$V0=t},a.prototype.getFadeOut=function(){return this._$eo},a.prototype._$4T=function(){return this._$eo},a.prototype._$mT=function(){return this._$V0},a.prototype.getDurationMSec=function(){return-1},a.prototype.getLoopDurationMSec=function(){return-1},a.prototype.updateParam=function(t,e){if(e._$AT&&!e._$9L){var i=b.getUserTimeMSec();if(e._$z2<0){e._$z2=i,e._$bs=i;var r=this.getDurationMSec();e._$Do<0&&(e._$Do=r<=0?-1:e._$z2+r)}var s=this._$V0;0<=(s=s*(0==this._$dP?1:ut._$r2((i-e._$bs)/this._$dP))*(0==this._$eo||e._$Do<0?1:ut._$r2((e._$Do-i)/this._$eo)))&&s<=1||console.log("### assert!! ### "),this.updateParamExe(t,i,s,e),e._$Do>0&&e._$Do<i&&(e._$9L=!0)}},a.prototype.updateParamExe=function(t,e,i,r){},l._$8s=0,l._$fT=new Object,l.start=function(t){var e=l._$fT[t];null==e&&((e=new h)._$r=t,l._$fT[t]=e),e._$0S=b.getSystemTimeMSec()},l.dump=function(t){var e=l._$fT[t];if(null!=e){var i=b.getSystemTimeMSec()-e._$0S;return console.log(t+" : "+i+"ms"),i}return-1},l.end=function(t){var e=l._$fT[t];return null!=e?b.getSystemTimeMSec()-e._$0S:-1},l._$li=function(t,e){console.log("_$li : "+t+"\n",e)},l._$Ji=function(t,e){console.log(t,e)},l._$dL=function(t,e){console.log(t,e),console.log("\n")},l._$KL=function(t,e){for(var i=0;i<e;i++)i%16==0&&i>0?console.log("\n"):i%8==0&&i>0&&console.log("  "),console.log("%02X ",255&t[i]);console.log("\n")},l._$nr=function(t,e,i){console.log("%s\n",t);for(var r=e.length,s=0;s<r;++s)console.log("%5d",e[s]),console.log("%s\n",i),console.log(",");console.log("\n")},l._$Rb=function(t){console.log("dump exception : "+t),console.log("stack :: "+t.stack)},u.prototype._$8P=function(){return.5*(this.x+this.x+this.width)},u.prototype._$6P=function(){return.5*(this.y+this.y+this.height)},u.prototype._$EL=function(){return this.x+this.width},u.prototype._$5T=function(){return this.y+this.height},u.prototype._$jL=function(t,e,i,r){this.x=t,this.y=e,this.width=i,this.height=r},u.prototype._$jL=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},_.prototype=new st,_._$tP=new Object,_._$27=function(){_._$tP.clear()},_.getID=function(t){var e=_._$tP[t];return null==e&&(e=new _(t),_._$tP[t]=e),e},_.prototype._$3s=function(){return new _},c.prototype=new st,c._$tP=new Object,c._$27=function(){c._$tP.clear()},c.getID=function(t){var e=c._$tP[t];return null==e&&(e=new c(t),c._$tP[t]=e),e},c.prototype._$3s=function(){return new c},g._$42=0,g.prototype._$zP=function(){null==this._$vo&&(this._$vo=new nt),null==this._$F2&&(this._$F2=new Array)},g.prototype.getCanvasWidth=function(){return this._$ao},g.prototype.getCanvasHeight=function(){return this._$1S},g.prototype._$F0=function(t){this._$vo=t._$nP(),this._$F2=t._$nP(),this._$ao=t._$6L(),this._$1S=t._$6L()},g.prototype._$6S=function(t){this._$F2.push(t)},g.prototype._$Xr=function(){return this._$F2},g.prototype._$E2=function(){return this._$vo},p.prototype.setup=function(t,e,i){this._$ks=this._$Yb(),this.p2._$xT(),3==arguments.length&&(this._$Fo=t,this._$L2=e,this.p1._$p=i,this.p2._$p=i,this.p2.y=t,this.setup())},p.prototype.getPhysicsPoint1=function(){return this.p1},p.prototype.getPhysicsPoint2=function(){return this.p2},p.prototype._$qr=function(){return this._$Db},p.prototype._$pr=function(t){this._$Db=t},p.prototype._$5r=function(){return this._$M2},p.prototype._$Cs=function(){return this._$9b},p.prototype._$Yb=function(){return-180*Math.atan2(this.p1.x-this.p2.x,-(this.p1.y-this.p2.y))/Math.PI},p.prototype.addSrcParam=function(t,e,i,r){var s=new $(t,e,i,r);this._$lL.push(s)},p.prototype.addTargetParam=function(t,e,i,r){var s=new S(t,e,i,r);this._$qP.push(s)},p.prototype.update=function(t,e){if(0==this._$iP)return this._$iP=this._$iT=e,void(this._$Fo=Math.sqrt((this.p1.x-this.p2.x)*(this.p1.x-this.p2.x)+(this.p1.y-this.p2.y)*(this.p1.y-this.p2.y)));var i=(e-this._$iT)/1e3;if(0!=i){for(var r=this._$lL.length-1;r>=0;--r){this._$lL[r]._$oP(t,this)}this._$oo(t,i),this._$M2=this._$Yb(),this._$9b=(this._$M2-this._$ks)/i,this._$ks=this._$M2}for(r=this._$qP.length-1;r>=0;--r){this._$qP[r]._$YS(t,this)}this._$iT=e},p.prototype._$oo=function(t,e){e<.033&&(e=.033);var i=1/e;this.p1.vx=(this.p1.x-this.p1._$s0)*i,this.p1.vy=(this.p1.y-this.p1._$70)*i,this.p1.ax=(this.p1.vx-this.p1._$7L)*i,this.p1.ay=(this.p1.vy-this.p1._$HL)*i,this.p1.fx=this.p1.ax*this.p1._$p,this.p1.fy=this.p1.ay*this.p1._$p,this.p1._$xT();var r,s,n=-Math.atan2(this.p1.y-this.p2.y,this.p1.x-this.p2.x),o=Math.cos(n),a=Math.sin(n),l=9.8*this.p2._$p,h=this._$Db*Mt._$bS,u=l*Math.cos(n-h);r=u*a,s=u*o;var _=-this.p1.fx*a*a,c=-this.p1.fy*a*o,g=-this.p2.vx*this._$L2,p=-this.p2.vy*this._$L2;this.p2.fx=r+_+g,this.p2.fy=s+c+p,this.p2.ax=this.p2.fx/this.p2._$p,this.p2.ay=this.p2.fy/this.p2._$p,this.p2.vx+=this.p2.ax*e,this.p2.vy+=this.p2.ay*e,this.p2.x+=this.p2.vx*e,this.p2.y+=this.p2.vy*e;var d=Math.sqrt((this.p1.x-this.p2.x)*(this.p1.x-this.p2.x)+(this.p1.y-this.p2.y)*(this.p1.y-this.p2.y));this.p2.x=this.p1.x+this._$Fo*(this.p2.x-this.p1.x)/d,this.p2.y=this.p1.y+this._$Fo*(this.p2.y-this.p1.y)/d,this.p2.vx=(this.p2.x-this.p2._$s0)*i,this.p2.vy=(this.p2.y-this.p2._$70)*i,this.p2._$xT()},d.prototype._$xT=function(){this._$s0=this.x,this._$70=this.y,this._$7L=this.vx,this._$HL=this.vy},f.prototype._$oP=function(t,e){},$.prototype=new f,$.prototype._$oP=function(t,e){var i=this.scale*t.getParamFloat(this._$wL),r=e.getPhysicsPoint1();switch(this._$tL){default:case p.Src.SRC_TO_X:r.x=r.x+(i-r.x)*this._$V0;break;case p.Src.SRC_TO_Y:r.y=r.y+(i-r.y)*this._$V0;break;case p.Src.SRC_TO_G_ANGLE:var s=e._$qr();s+=(i-s)*this._$V0,e._$pr(s)}},y.prototype._$YS=function(t,e){},S.prototype=new y,S.prototype._$YS=function(t,e){switch(this._$YP){default:case p.Target.TARGET_FROM_ANGLE:t.setParamFloat(this._$wL,this.scale*e._$5r(),this._$V0);break;case p.Target.TARGET_FROM_ANGLE_V:t.setParamFloat(this._$wL,this.scale*e._$Cs(),this._$V0)}},p.Src=function(){},p.Src.SRC_TO_X="SRC_TO_X",p.Src.SRC_TO_Y="SRC_TO_Y",p.Src.SRC_TO_G_ANGLE="SRC_TO_G_ANGLE",p.Target=function(){},p.Target.TARGET_FROM_ANGLE="TARGET_FROM_ANGLE",p.Target.TARGET_FROM_ANGLE_V="TARGET_FROM_ANGLE_V",x.prototype.init=function(t){this._$fL=t._$fL,this._$gL=t._$gL,this._$B0=t._$B0,this._$z0=t._$z0,this._$qT=t._$qT,this.reflectX=t.reflectX,this.reflectY=t.reflectY},x.prototype._$F0=function(t){this._$fL=t._$_T(),this._$gL=t._$_T(),this._$B0=t._$_T(),this._$z0=t._$_T(),this._$qT=t._$_T(),t.getFormatVersion()>=U.LIVE2D_FORMAT_VERSION_V2_10_SDK2&&(this.reflectX=t._$po(),this.reflectY=t._$po())},x.prototype._$e=function(){};var v=function(){};function P(){e||(this.x=null,this.y=null,this.width=null,this.height=null)}function T(){}function M(){e||(this.x=null,this.y=null)}function w(){e||(this._$gP=null,this._$dr=null,this._$GS=null,this._$qb=null,this._$Lb=null,this._$mS=null,this.clipID=null,this.clipIDList=new Array)}function I(){e||(this._$Eb=I._$ps,this._$lT=1,this._$C0=1,this._$tT=1,this._$WL=1,this.culling=!1,this.matrix4x4=new Float32Array(16),this.premultipliedAlpha=!1,this.anisotropy=0,this.clippingProcess=I.CLIPPING_PROCESS_NONE,this.clipBufPre_clipContextMask=null,this.clipBufPre_clipContextDraw=null,this.CHANNEL_COLORS=new Array)}function C(){e||(this.a=1,this.r=1,this.g=1,this.b=1,this.scale=1,this._$ho=1,this.blendMode=ht.L2D_COLOR_BLEND_MODE_MULT)}function L(){e||(this._$kP=null,this._$dr=null,this._$Ai=!0,this._$mS=null)}function b(){}function E(){e||(this._$VP=0,this._$wL=null,this._$GP=null,this._$8o=E._$ds,this._$2r=-1,this._$O2=0,this._$ri=0)}function B(){}function A(){e||(this._$Ob=null)}function F(){this.m=new Float32Array(16),this.identity()}function D(t){e||st.prototype.constructor.call(this,t)}function R(){e||(this._$7=1,this._$f=0,this._$H=0,this._$g=1,this._$k=0,this._$w=0,this._$hi=STATE_IDENTITY,this._$Z=_$pS)}function V(){e||(a.prototype.constructor.call(this),this.motions=new Array,this._$7r=null,this._$7r=V._$Co++,this._$D0=30,this._$yT=0,this._$E=!0,this.loopFadeIn=!0,this._$AS=-1,_$a0())}function O(){this._$P=new Float32Array(100),this.size=0}function N(){this._$4P=null,this._$I0=null,this._$RP=null}function k(){}function U(){}function z(t){e||(this._$QT=!0,this._$co=-1,this._$qo=0,this._$pb=new Array(z._$is),this._$_2=new Float32Array(z._$is),this._$vr=new Float32Array(z._$is),this._$Rr=new Float32Array(z._$is),this._$Or=new Float32Array(z._$is),this._$fs=new Float32Array(z._$is),this._$Js=new Array(z._$is),this._$3S=new Array,this._$aS=new Array,this._$Bo=null,this._$F2=new Array,this._$db=new Array,this._$8b=new Array,this._$Hr=new Array,this._$Ws=null,this._$Vs=null,this._$Er=null,this._$Es=new Int16Array(k._$Qb),this._$ZP=new Float32Array(2*k._$1r),this._$Ri=t,this._$b0=z._$HP++,this.clipManager=null,this.dp_webgl=null)}function Y(){}function G(){e||(this._$12=null,this._$bb=null,this._$_L=null,this._$jo=null,this._$iL=null,this._$0L=null,this._$Br=null,this._$Dr=null,this._$Cb=null,this._$mr=null,this._$_L=X.STATE_FIRST,this._$Br=4e3,this._$Dr=100,this._$Cb=50,this._$mr=150,this._$jo=!0,this._$iL="PARAM_EYE_L_OPEN",this._$0L="PARAM_EYE_R_OPEN")}v._$ni=function(t,e,i,r,s,n,o,a,l){var h=o*n-a*s;if(0==h)return null;var u,_=((t-i)*n-(e-r)*s)/h;return u=0!=s?(t-i-_*o)/s:(e-r-_*a)/n,isNaN(u)&&(u=(t-i-_*o)/s,isNaN(u)&&(u=(e-r-_*a)/n),isNaN(u)&&(console.log("a is NaN @UtVector#_$ni() "),console.log("v1x : "+s),console.log("v1x != 0 ? "+(0!=s)))),null==l?new Array(u,_):(l[0]=u,l[1]=_,l)},P.prototype._$8P=function(){return this.x+.5*this.width},P.prototype._$6P=function(){return this.y+.5*this.height},P.prototype._$EL=function(){return this.x+this.width},P.prototype._$5T=function(){return this.y+this.height},P.prototype._$jL=function(t,e,i,r){this.x=t,this.y=e,this.width=i,this.height=r},P.prototype._$jL=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},P.prototype.contains=function(t,e){return this.x<=this.x&&this.y<=this.y&&this.x<=this.x+this.width&&this.y<=this.y+this.height},P.prototype.expand=function(t,e){this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e},T._$Z2=function(t,e,i,r){var s=e._$Q2(t,i),n=t._$vs(),o=t._$Tr();if(e._$zr(n,o,s),s<=0)return r[n[0]];if(1==s)return(a=r[n[0]])+((l=r[n[1]])-a)*(y=o[0])|0;if(2==s){var a=r[n[0]],l=r[n[1]],h=r[n[2]],u=r[n[3]];return(v=a+(l-a)*(y=o[0])|0)+((h+(u-h)*y|0)-v)*(S=o[1])|0}if(3==s){var _=r[n[0]],c=r[n[1]],g=r[n[2]],p=r[n[3]],d=r[n[4]],f=r[n[5]],m=r[n[6]],$=r[n[7]];return(v=(a=_+(c-_)*(y=o[0])|0)+((l=g+(p-g)*y|0)-a)*(S=o[1])|0)+(((h=d+(f-d)*y|0)+((u=m+($-m)*y|0)-h)*S|0)-v)*(x=o[2])|0}if(4==s){var y,S,x,v,P=r[n[0]],T=r[n[1]],M=r[n[2]],w=r[n[3]],I=r[n[4]],C=r[n[5]],L=r[n[6]],b=r[n[7]],E=r[n[8]],B=r[n[9]],A=r[n[10]],F=r[n[11]],D=r[n[12]],R=r[n[13]],V=r[n[14]],O=r[n[15]];return(v=(a=(_=P+(T-P)*(y=o[0])|0)+((c=M+(w-M)*y|0)-_)*(S=o[1])|0)+((l=(g=I+(C-I)*y|0)+((p=L+(b-L)*y|0)-g)*S|0)-a)*(x=o[2])|0)+(((h=(d=E+(B-E)*y|0)+((f=A+(F-A)*y|0)-d)*S|0)+((u=(m=D+(R-D)*y|0)+(($=V+(O-V)*y|0)-m)*S|0)-h)*x|0)-v)*o[3]|0}for(var N=1<<s,k=new Float32Array(N),U=0;U<N;U++){for(var z=U,Y=1,G=0;G<s;G++)Y*=z%2==0?1-o[G]:o[G],z/=2;k[U]=Y}for(var X=new Float32Array(N),j=0;j<N;j++)X[j]=r[n[j]];var H=0;for(j=0;j<N;j++)H+=k[j]*X[j];return H+.5|0},T._$br=function(t,e,i,r){var s=e._$Q2(t,i),n=t._$vs(),o=t._$Tr();if(e._$zr(n,o,s),s<=0)return r[n[0]];if(1==s)return(a=r[n[0]])+((l=r[n[1]])-a)*(_=o[0]);if(2==s){var a=r[n[0]],l=r[n[1]],h=r[n[2]],u=r[n[3]],_=o[0];return(1-(S=o[1]))*(a+(l-a)*_)+S*(h+(u-h)*_)}if(3==s){var c=r[n[0]],g=r[n[1]],p=r[n[2]],d=r[n[3]],f=r[n[4]],m=r[n[5]],$=r[n[6]],y=r[n[7]],S=(_=o[0],o[1]);return(1-(V=o[2]))*((1-S)*(c+(g-c)*_)+S*(p+(d-p)*_))+V*((1-S)*(f+(m-f)*_)+S*($+(y-$)*_))}if(4==s){var x=r[n[0]],v=r[n[1]],P=r[n[2]],T=r[n[3]],M=r[n[4]],w=r[n[5]],I=r[n[6]],C=r[n[7]],L=r[n[8]],b=r[n[9]],E=r[n[10]],B=r[n[11]],A=r[n[12]],F=r[n[13]],D=r[n[14]],R=r[n[15]],V=(_=o[0],S=o[1],o[2]),O=o[3];return(1-O)*((1-V)*((1-S)*(x+(v-x)*_)+S*(P+(T-P)*_))+V*((1-S)*(M+(w-M)*_)+S*(I+(C-I)*_)))+O*((1-V)*((1-S)*(L+(b-L)*_)+S*(E+(B-E)*_))+V*((1-S)*(A+(F-A)*_)+S*(D+(R-D)*_)))}for(var N=1<<s,k=new Float32Array(N),U=0;U<N;U++){for(var z=U,Y=1,G=0;G<s;G++)Y*=z%2==0?1-o[G]:o[G],z/=2;k[U]=Y}for(var X=new Float32Array(N),j=0;j<N;j++)X[j]=r[n[j]];var H=0;for(j=0;j<N;j++)H+=k[j]*X[j];return H},T._$Vr=function(t,e,i,r,s,n,o,a){var l=e._$Q2(t,i),h=t._$vs(),u=t._$Tr();e._$zr(h,u,l);var _=2*r,c=o;if(l<=0){var g=s[h[0]];if(2==a&&0==o)b._$jT(g,0,n,0,_);else for(var p=0;p<_;)n[c]=g[p++],n[c+1]=g[p++],c+=a}else if(1==l){g=s[h[0]];var d=s[h[1]],f=1-(y=u[0]);for(p=0;p<_;)n[c]=g[p]*f+d[p]*y,++p,n[c+1]=g[p]*f+d[p]*y,++p,c+=a}else if(2==l){g=s[h[0]],d=s[h[1]];var m=s[h[2]],$=s[h[3]],y=u[0],S=(z=1-(A=u[1]))*(f=1-y),x=z*y,v=A*f,P=A*y;for(p=0;p<_;)n[c]=S*g[p]+x*d[p]+v*m[p]+P*$[p],++p,n[c+1]=S*g[p]+x*d[p]+v*m[p]+P*$[p],++p,c+=a}else if(3==l){var T=s[h[0]],M=s[h[1]],w=s[h[2]],I=s[h[3]],C=s[h[4]],L=s[h[5]],E=s[h[6]],B=s[h[7]],A=(y=u[0],u[1]),F=(Y=1-(ot=u[2]))*(z=1-A)*(f=1-y),D=Y*z*y,R=Y*A*f,V=Y*A*y,O=ot*z*f,N=ot*z*y,k=ot*A*f,U=ot*A*y;for(p=0;p<_;)n[c]=F*T[p]+D*M[p]+R*w[p]+V*I[p]+O*C[p]+N*L[p]+k*E[p]+U*B[p],++p,n[c+1]=F*T[p]+D*M[p]+R*w[p]+V*I[p]+O*C[p]+N*L[p]+k*E[p]+U*B[p],++p,c+=a}else if(4==l){var z,Y,G=s[h[0]],X=s[h[1]],j=s[h[2]],H=s[h[3]],q=s[h[4]],W=s[h[5]],J=s[h[6]],Q=s[h[7]],Z=s[h[8]],K=s[h[9]],tt=s[h[10]],et=s[h[11]],it=s[h[12]],rt=s[h[13]],st=s[h[14]],nt=s[h[15]],ot=(y=u[0],A=u[1],u[2]),at=u[3],lt=1-at,ht=lt*(Y=1-ot)*(z=1-A)*(f=1-y),ut=lt*Y*z*y,_t=lt*Y*A*f,ct=lt*Y*A*y,gt=lt*ot*z*f,pt=lt*ot*z*y,dt=lt*ot*A*f,ft=lt*ot*A*y,mt=at*Y*z*f,$t=at*Y*z*y,yt=at*Y*A*f,St=at*Y*A*y,xt=at*ot*z*f,vt=at*ot*z*y,Pt=at*ot*A*f,Tt=at*ot*A*y;for(p=0;p<_;)n[c]=ht*G[p]+ut*X[p]+_t*j[p]+ct*H[p]+gt*q[p]+pt*W[p]+dt*J[p]+ft*Q[p]+mt*Z[p]+$t*K[p]+yt*tt[p]+St*et[p]+xt*it[p]+vt*rt[p]+Pt*st[p]+Tt*nt[p],++p,n[c+1]=ht*G[p]+ut*X[p]+_t*j[p]+ct*H[p]+gt*q[p]+pt*W[p]+dt*J[p]+ft*Q[p]+mt*Z[p]+$t*K[p]+yt*tt[p]+St*et[p]+xt*it[p]+vt*rt[p]+Pt*st[p]+Tt*nt[p],++p,c+=a}else{for(var Mt=1<<l,wt=new Float32Array(Mt),It=0;It<Mt;It++){for(var Ct=It,Lt=1,bt=0;bt<l;bt++)Lt*=Ct%2==0?1-u[bt]:u[bt],Ct/=2;wt[It]=Lt}for(var Et=new Float32Array(Mt),Bt=0;Bt<Mt;Bt++)Et[Bt]=s[h[Bt]];for(p=0;p<_;){var At=0,Ft=0,Dt=p+1;for(Bt=0;Bt<Mt;Bt++)At+=wt[Bt]*Et[Bt][p],Ft+=wt[Bt]*Et[Bt][Dt];p+=2,n[c]=At,n[c+1]=Ft,c+=a}}},M.prototype._$HT=function(t,e){this.x=t,this.y=e},M.prototype._$HT=function(t){this.x=t.x,this.y=t.y},w._$ur=-2,w._$ES=500,w._$wb=2,w._$8S=3,w._$52=w._$ES,w._$R2=w._$ES,w._$or=function(){return w._$52},w._$Pr=function(){return w._$R2},w.prototype.convertClipIDForV2_11=function(t){var e=[];return null==t||0==t.length?null:/,/.test(t)?e=t.id.split(","):(e.push(t.id),e)},w.prototype._$F0=function(t){this._$gP=t._$nP(),this._$dr=t._$nP(),this._$GS=t._$nP(),this._$qb=t._$6L(),this._$Lb=t._$cS(),this._$mS=t._$Tb(),t.getFormatVersion()>=U._$T7?(this.clipID=t._$nP(),this.clipIDList=this.convertClipIDForV2_11(this.clipID)):this.clipIDList=[],this._$MS(this._$Lb)},w.prototype.getClipIDList=function(){return this.clipIDList},w.prototype.init=function(t){},w.prototype._$Nr=function(t,e){if(e._$IS[0]=!1,e._$Us=T._$Z2(t,this._$GS,e._$IS,this._$Lb),ht._$Zs);else if(e._$IS[0])return;e._$7s=T._$br(t,this._$GS,e._$IS,this._$mS)},w.prototype._$2b=function(t,e){},w.prototype.getDrawDataID=function(){return this._$gP},w.prototype._$j2=function(t){this._$gP=t},w.prototype.getOpacity=function(t,e){return e._$7s},w.prototype._$zS=function(t,e){return e._$Us},w.prototype._$MS=function(t){for(var e=t.length-1;e>=0;--e){var i=t[e];i<w._$52?w._$52=i:i>w._$R2&&(w._$R2=i)}},w.prototype.getTargetBaseDataID=function(){return this._$dr},w.prototype._$gs=function(t){this._$dr=t},w.prototype._$32=function(){return null!=this._$dr&&this._$dr!=yt._$2o()},w.prototype.preDraw=function(t,e,i){},w.prototype.draw=function(t,e,i){},w.prototype.getType=function(){},w.prototype._$B2=function(t,e,i){},I._$ps=32,I.CLIPPING_PROCESS_NONE=0,I.CLIPPING_PROCESS_OVERWRITE_ALPHA=1,I.CLIPPING_PROCESS_MULTIPLY_ALPHA=2,I.CLIPPING_PROCESS_DRAW=3,I.CLIPPING_PROCESS_CLEAR_ALPHA=4,I.prototype.setChannelFlagAsColor=function(t,e){this.CHANNEL_COLORS[t]=e},I.prototype.getChannelFlagAsColor=function(t){return this.CHANNEL_COLORS[t]},I.prototype._$ZT=function(){},I.prototype._$Uo=function(t,e,i,r,s,n,o){},I.prototype._$Rs=function(){return-1},I.prototype._$Ds=function(t){},I.prototype.setBaseColor=function(t,e,i,r){t<0?t=0:t>1&&(t=1),e<0?e=0:e>1&&(e=1),i<0?i=0:i>1&&(i=1),r<0?r=0:r>1&&(r=1),this._$lT=t,this._$C0=e,this._$tT=i,this._$WL=r},I.prototype._$WP=function(t){this.culling=t},I.prototype.setMatrix=function(t){for(var e=0;e<16;e++)this.matrix4x4[e]=t[e]},I.prototype._$IT=function(){return this.matrix4x4},I.prototype.setPremultipliedAlpha=function(t){this.premultipliedAlpha=t},I.prototype.isPremultipliedAlpha=function(){return this.premultipliedAlpha},I.prototype.setAnisotropy=function(t){this.anisotropy=t},I.prototype.getAnisotropy=function(){return this.anisotropy},I.prototype.getClippingProcess=function(){return this.clippingProcess},I.prototype.setClippingProcess=function(t){this.clippingProcess=t},I.prototype.setClipBufPre_clipContextForMask=function(t){this.clipBufPre_clipContextMask=t},I.prototype.getClipBufPre_clipContextMask=function(){return this.clipBufPre_clipContextMask},I.prototype.setClipBufPre_clipContextForDraw=function(t){this.clipBufPre_clipContextDraw=t},I.prototype.getClipBufPre_clipContextDraw=function(){return this.clipBufPre_clipContextDraw},L._$ur=-2,L._$c2=1,L._$_b=2,L.prototype._$F0=function(t){this._$kP=t._$nP(),this._$dr=t._$nP()},L.prototype.readV2_opacity=function(t){t.getFormatVersion()>=U.LIVE2D_FORMAT_VERSION_V2_10_SDK2&&(this._$mS=t._$Tb())},L.prototype.init=function(t){},L.prototype._$Nr=function(t,e){},L.prototype.interpolateOpacity=function(t,e,i,r){null==this._$mS?i.setInterpolatedOpacity(1):i.setInterpolatedOpacity(T._$br(t,e,r,this._$mS))},L.prototype._$2b=function(t,e){},L.prototype._$nb=function(t,e,i,r,s,n,o){},L.prototype.getType=function(){},L.prototype._$gs=function(t){this._$dr=t},L.prototype._$a2=function(t){this._$kP=t},L.prototype.getTargetBaseDataID=function(){return this._$dr},L.prototype.getBaseDataID=function(){return this._$kP},L.prototype._$32=function(){return null!=this._$dr&&this._$dr!=yt._$2o()},b._$W2=0,b._$CS=b._$W2,b._$Mo=function(){return!0},b._$XP=function(t){try{for(var e=getTimeMSec();getTimeMSec()-e<t;);}catch(t){t._$Rb()}},b.getUserTimeMSec=function(){return b._$CS==b._$W2?b.getSystemTimeMSec():b._$CS},b.setUserTimeMSec=function(t){b._$CS=t},b.updateUserTimeMSec=function(){return b._$CS=b.getSystemTimeMSec()},b.getTimeMSec=function(){return(new Date).getTime()},b.getSystemTimeMSec=function(){return(new Date).getTime()},b._$Q=function(t){},b._$jT=function(t,e,i,r,s){for(var n=0;n<s;n++)i[r+n]=t[e+n]},E._$ds=-2,E.prototype._$F0=function(t){this._$wL=t._$nP(),this._$VP=t._$6L(),this._$GP=t._$nP()},E.prototype.getParamIndex=function(t){return this._$2r!=t&&(this._$8o=E._$ds),this._$8o},E.prototype._$Pb=function(t,e){this._$8o=t,this._$2r=e},E.prototype.getParamID=function(){return this._$wL},E.prototype._$yP=function(t){this._$wL=t},E.prototype._$N2=function(){return this._$VP},E.prototype._$d2=function(){return this._$GP},E.prototype._$t2=function(t,e){this._$VP=t,this._$GP=e},E.prototype._$Lr=function(){return this._$O2},E.prototype._$wr=function(t){this._$O2=t},E.prototype._$SL=function(){return this._$ri},E.prototype._$AL=function(t){this._$ri=t},B.startsWith=function(t,e,i){var r=e+i.length;if(r>=t.length)return!1;for(var s=e;s<r;s++)if(B.getChar(t,s)!=i.charAt(s-e))return!1;return!0},B.getChar=function(t,e){return String.fromCharCode(t.getUint8(e))},B.createString=function(t,e,i){for(var r=new ArrayBuffer(2*i),s=new Uint16Array(r),n=0;n<i;n++)s[n]=t.getUint8(e+n);return String.fromCharCode.apply(null,s)},B._$LS=function(t,e,i,r){t instanceof ArrayBuffer&&(t=new DataView(t));var s=i,n=!1,o=!1,a=0,l=B.getChar(t,s);"-"==l&&(n=!0,s++);for(var h=!1;s<e;s++){switch(l=B.getChar(t,s)){case"0":a*=10;break;case"1":a=10*a+1;break;case"2":a=10*a+2;break;case"3":a=10*a+3;break;case"4":a=10*a+4;break;case"5":a=10*a+5;break;case"6":a=10*a+6;break;case"7":a=10*a+7;break;case"8":a=10*a+8;break;case"9":a=10*a+9;break;case".":o=!0,s++,h=!0;break;default:h=!0}if(h)break}if(o)for(var u=.1,_=!1;s<e;s++){switch(l=B.getChar(t,s)){case"0":break;case"1":a+=1*u;break;case"2":a+=2*u;break;case"3":a+=3*u;break;case"4":a+=4*u;break;case"5":a+=5*u;break;case"6":a+=6*u;break;case"7":a+=7*u;break;case"8":a+=8*u;break;case"9":a+=9*u;break;default:_=!0}if(u*=.1,_)break}return n&&(a=-a),r[0]=s,a},A.prototype._$zP=function(){this._$Ob=new Array},A.prototype._$F0=function(t){this._$Ob=t._$nP()},A.prototype._$Ur=function(t){if(t._$WS())return!0;for(var e=t._$v2(),i=this._$Ob.length-1;i>=0;--i){var r=this._$Ob[i].getParamIndex(e);if(r==E._$ds&&(r=t.getParamIndex(this._$Ob[i].getParamID())),t._$Xb(r))return!0}return!1},A.prototype._$Q2=function(t,e){for(var i,r,s=this._$Ob.length,n=t._$v2(),o=0,a=0;a<s;a++){var l=this._$Ob[a];if((i=l.getParamIndex(n))==E._$ds&&(i=t.getParamIndex(l.getParamID()),l._$Pb(i,n)),i<0)throw new Exception("err 23242 : "+l.getParamID());var h=i<0?0:t.getParamFloat(i);r=l._$N2();var u,_,c=l._$d2(),g=-1,p=0;if(r<1);else if(1==r)(u=c[0])-k._$J<h&&h<u+k._$J?(g=0,p=0):(g=0,e[0]=!0);else if(h<(u=c[0])-k._$J)g=0,e[0]=!0;else if(h<u+k._$J)g=0;else{for(var d=!1,f=1;f<r;++f){if(h<(_=c[f])+k._$J){_-k._$J<h?g=f:(g=f-1,p=(h-u)/(_-u),o++),d=!0;break}u=_}d||(g=r-1,p=0,e[0]=!0)}l._$wr(g),l._$AL(p)}return o},A.prototype._$zr=function(t,e,i){var r=1<<i;r+1>k._$Qb&&console.log("err 23245\n");for(var s=this._$Ob.length,n=1,o=1,a=0,l=0;l<r;++l)t[l]=0;for(var h=0;h<s;++h){var u=this._$Ob[h];if(0==u._$SL()){if((_=u._$Lr()*n)<0&&ht._$3T)throw new Exception("err 23246");for(l=0;l<r;++l)t[l]+=_}else{var _=n*u._$Lr(),c=n*(u._$Lr()+1);for(l=0;l<r;++l)t[l]+=(l/o|0)%2==0?_:c;e[a++]=u._$SL(),o*=2}n*=u._$N2()}t[r]=65535,e[a]=-1},A.prototype._$h2=function(t,e,i){for(var r=new Float32Array(e),s=0;s<e;++s)r[s]=i[s];var n=new E;n._$yP(t),n._$t2(e,r),this._$Ob.push(n)},A.prototype._$J2=function(t){for(var e=t,i=this._$Ob.length,r=0;r<i;++r){var s=this._$Ob[r],n=s._$N2(),o=e%s._$N2(),a=s._$d2()[o];console.log("%s[%d]=%7.2f / ",s.getParamID(),o,a),e/=n}console.log("\n")},A.prototype.getParamCount=function(){return this._$Ob.length},A.prototype._$zs=function(){return this._$Ob},F.prototype.identity=function(){for(var t=0;t<16;t++)this.m[t]=t%5==0?1:0},F.prototype.getArray=function(){return this.m},F.prototype.getCopyMatrix=function(){return new Float32Array(this.m)},F.prototype.setMatrix=function(t){if(null!=t&&16==t.length)for(var e=0;e<16;e++)this.m[e]=t[e]},F.prototype.mult=function(t,e,i){return null==e?null:(this==e?this.mult_safe(this.m,t.m,e.m,i):this.mult_fast(this.m,t.m,e.m,i),e)},F.prototype.mult_safe=function(t,e,i,r){if(t==i){var s=new Array(16);this.mult_fast(t,e,s,r);for(var n=15;n>=0;--n)i[n]=s[n]}else this.mult_fast(t,e,i,r)},F.prototype.mult_fast=function(t,e,i,r){r?(i[0]=t[0]*e[0]+t[4]*e[1]+t[8]*e[2],i[4]=t[0]*e[4]+t[4]*e[5]+t[8]*e[6],i[8]=t[0]*e[8]+t[4]*e[9]+t[8]*e[10],i[12]=t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12],i[1]=t[1]*e[0]+t[5]*e[1]+t[9]*e[2],i[5]=t[1]*e[4]+t[5]*e[5]+t[9]*e[6],i[9]=t[1]*e[8]+t[5]*e[9]+t[9]*e[10],i[13]=t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13],i[2]=t[2]*e[0]+t[6]*e[1]+t[10]*e[2],i[6]=t[2]*e[4]+t[6]*e[5]+t[10]*e[6],i[10]=t[2]*e[8]+t[6]*e[9]+t[10]*e[10],i[14]=t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14],i[3]=i[7]=i[11]=0,i[15]=1):(i[0]=t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],i[4]=t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],i[8]=t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],i[12]=t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],i[1]=t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],i[5]=t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],i[9]=t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],i[13]=t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],i[2]=t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],i[6]=t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],i[10]=t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],i[14]=t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],i[3]=t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],i[7]=t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],i[11]=t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],i[15]=t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15])},F.prototype.translate=function(t,e,i){this.m[12]=this.m[0]*t+this.m[4]*e+this.m[8]*i+this.m[12],this.m[13]=this.m[1]*t+this.m[5]*e+this.m[9]*i+this.m[13],this.m[14]=this.m[2]*t+this.m[6]*e+this.m[10]*i+this.m[14],this.m[15]=this.m[3]*t+this.m[7]*e+this.m[11]*i+this.m[15]},F.prototype.scale=function(t,e,i){this.m[0]*=t,this.m[4]*=e,this.m[8]*=i,this.m[1]*=t,this.m[5]*=e,this.m[9]*=i,this.m[2]*=t,this.m[6]*=e,this.m[10]*=i,this.m[3]*=t,this.m[7]*=e,this.m[11]*=i},F.prototype.rotateX=function(t){var e=Mt.fcos(t),i=Mt._$9(t),r=this.m[4];this.m[4]=r*e+this.m[8]*i,this.m[8]=r*-i+this.m[8]*e,r=this.m[5],this.m[5]=r*e+this.m[9]*i,this.m[9]=r*-i+this.m[9]*e,r=this.m[6],this.m[6]=r*e+this.m[10]*i,this.m[10]=r*-i+this.m[10]*e,r=this.m[7],this.m[7]=r*e+this.m[11]*i,this.m[11]=r*-i+this.m[11]*e},F.prototype.rotateY=function(t){var e=Mt.fcos(t),i=Mt._$9(t),r=this.m[0];this.m[0]=r*e+this.m[8]*-i,this.m[8]=r*i+this.m[8]*e,r=this.m[1],this.m[1]=r*e+this.m[9]*-i,this.m[9]=r*i+this.m[9]*e,r=m[2],this.m[2]=r*e+this.m[10]*-i,this.m[10]=r*i+this.m[10]*e,r=m[3],this.m[3]=r*e+this.m[11]*-i,this.m[11]=r*i+this.m[11]*e},F.prototype.rotateZ=function(t){var e=Mt.fcos(t),i=Mt._$9(t),r=this.m[0];this.m[0]=r*e+this.m[4]*i,this.m[4]=r*-i+this.m[4]*e,r=this.m[1],this.m[1]=r*e+this.m[5]*i,this.m[5]=r*-i+this.m[5]*e,r=this.m[2],this.m[2]=r*e+this.m[6]*i,this.m[6]=r*-i+this.m[6]*e,r=this.m[3],this.m[3]=r*e+this.m[7]*i,this.m[7]=r*-i+this.m[7]*e},D.prototype=new st,D._$tP=new Object,D._$27=function(){D._$tP.clear()},D.getID=function(t){var e=D._$tP[t];return null==e&&(e=new D(t),D._$tP[t]=e),e},D.prototype._$3s=function(){return new D},R._$kS=-1,R._$pS=0,R._$hb=1,R.STATE_IDENTITY=0,R._$gb=1,R._$fo=2,R._$go=4,R.prototype.transform=function(t,e,i){var r,s,n,o,a,l,h=0,u=0;switch(this._$hi){default:return;case R._$go|R._$fo|R._$gb:for(r=this._$7,s=this._$H,n=this._$k,o=this._$f,a=this._$g,l=this._$w;--i>=0;){var _=t[h++],c=t[h++];e[u++]=r*_+s*c+n,e[u++]=o*_+a*c+l}return;case R._$go|R._$fo:for(r=this._$7,s=this._$H,o=this._$f,a=this._$g;--i>=0;){_=t[h++],c=t[h++];e[u++]=r*_+s*c,e[u++]=o*_+a*c}return;case R._$go|R._$gb:for(s=this._$H,n=this._$k,o=this._$f,l=this._$w;--i>=0;){_=t[h++];e[u++]=s*t[h++]+n,e[u++]=o*_+l}return;case R._$go:for(s=this._$H,o=this._$f;--i>=0;){_=t[h++];e[u++]=s*t[h++],e[u++]=o*_}return;case R._$fo|R._$gb:for(r=this._$7,n=this._$k,a=this._$g,l=this._$w;--i>=0;)e[u++]=r*t[h++]+n,e[u++]=a*t[h++]+l;return;case R._$fo:for(r=this._$7,a=this._$g;--i>=0;)e[u++]=r*t[h++],e[u++]=a*t[h++];return;case R._$gb:for(n=this._$k,l=this._$w;--i>=0;)e[u++]=t[h++]+n,e[u++]=t[h++]+l;return;case R.STATE_IDENTITY:return void(t==e&&h==u||b._$jT(t,h,e,u,2*i))}},R.prototype.update=function(){0==this._$H&&0==this._$f?1==this._$7&&1==this._$g?0==this._$k&&0==this._$w?(this._$hi=R.STATE_IDENTITY,this._$Z=R._$pS):(this._$hi=R._$gb,this._$Z=R._$hb):0==this._$k&&0==this._$w?(this._$hi=R._$fo,this._$Z=R._$kS):(this._$hi=R._$fo|R._$gb,this._$Z=R._$kS):0==this._$7&&0==this._$g?0==this._$k&&0==this._$w?(this._$hi=R._$go,this._$Z=R._$kS):(this._$hi=R._$go|R._$gb,this._$Z=R._$kS):0==this._$k&&0==this._$w?(this._$hi=R._$go|R._$fo,this._$Z=R._$kS):(this._$hi=R._$go|R._$fo|R._$gb,this._$Z=R._$kS)},R.prototype._$RT=function(t){this._$IT(t);var e=t[0],i=t[2],r=t[1],s=t[3],n=Math.sqrt(e*e+r*r),o=e*s-i*r;0==n?ht._$so&&console.log("affine._$RT() / rt==0"):(t[0]=n,t[1]=o/n,t[2]=(r*s+e*i)/o,t[3]=Math.atan2(r,e))},R.prototype._$ho=function(t,e,i,r){var s=new Float32Array(6),n=new Float32Array(6);t._$RT(s),e._$RT(n);var o=new Float32Array(6);o[0]=s[0]+(n[0]-s[0])*i,o[1]=s[1]+(n[1]-s[1])*i,o[2]=s[2]+(n[2]-s[2])*i,o[3]=s[3]+(n[3]-s[3])*i,o[4]=s[4]+(n[4]-s[4])*i,o[5]=s[5]+(n[5]-s[5])*i,r._$CT(o)},R.prototype._$CT=function(t){var e=Math.cos(t[3]),i=Math.sin(t[3]);this._$7=t[0]*e,this._$f=t[0]*i,this._$H=t[1]*(t[2]*e-i),this._$g=t[1]*(t[2]*i+e),this._$k=t[4],this._$w=t[5],this.update()},R.prototype._$IT=function(t){t[0]=this._$7,t[1]=this._$f,t[2]=this._$H,t[3]=this._$g,t[4]=this._$k,t[5]=this._$w},V.prototype=new a,V._$cs="VISIBLE:",V._$ar="LAYOUT:",V._$Co=0,V._$D2=[],V._$1T=1,V.loadMotion=function(t){var e=new V,i=[0],r=t.length;e._$yT=0;for(var s=0;s<r;++s){var n=255&t[s];if("\n"!=n&&"\r"!=n)if("#"!=n)if("$"!=n){if("a"<=n&&n<="z"||"A"<=n&&n<="Z"||"_"==n){for(h=s,u=-1;s<r&&("\r"!=(n=255&t[s])&&"\n"!=n);++s)if("="==n){u=s;break}if(u>=0){var o=new N;B.startsWith(t,h,V._$cs)?(o._$RP=N._$hs,o._$4P=new String(t,h,u-h)):B.startsWith(t,h,V._$ar)?(o._$4P=new String(t,h+7,u-h-7),B.startsWith(t,h+7,"ANCHOR_X")?o._$RP=N._$xs:B.startsWith(t,h+7,"ANCHOR_Y")?o._$RP=N._$us:B.startsWith(t,h+7,"SCALE_X")?o._$RP=N._$qs:B.startsWith(t,h+7,"SCALE_Y")?o._$RP=N._$Ys:B.startsWith(t,h+7,"X")?o._$RP=N._$ws:B.startsWith(t,h+7,"Y")&&(o._$RP=N._$Ns)):(o._$RP=N._$Fr,o._$4P=new String(t,h,u-h)),e.motions.push(o);var a=0;for(V._$D2.clear(),s=u+1;s<r&&("\r"!=(n=255&t[s])&&"\n"!=n);++s)if(","!=n&&" "!=n&&"\t"!=n){c=B._$LS(t,r,s,i);if(i[0]>0){V._$D2.push(c),a++;var l=i[0];if(l<s){console.log("_$n0 _$hi . @Live2DMotion loadMotion()\n");break}s=l}}o._$I0=V._$D2._$BL(),a>e._$yT&&(e._$yT=a)}}}else{for(var h=s,u=-1;s<r&&("\r"!=(n=255&t[s])&&"\n"!=n);++s)if("="==n){u=s;break}var _=!1;if(u>=0)for(u==h+4&&"f"==t[h+1]&&"p"==t[h+2]&&"s"==t[h+3]&&(_=!0),s=u+1;s<r&&("\r"!=(n=255&t[s])&&"\n"!=n);++s)if(","!=n&&" "!=n&&"\t"!=n){var c=B._$LS(t,r,s,i);i[0]>0&&_&&5<c&&c<121&&(e._$D0=c),s=i[0]}for(;s<r&&("\n"!=t[s]&&"\r"!=t[s]);++s);}else for(;s<r&&("\n"!=t[s]&&"\r"!=t[s]);++s);}return e._$AS=1e3*e._$yT/e._$D0|0,e},V.prototype.getDurationMSec=function(){return this._$AS},V.prototype.dump=function(){for(var t=0;t<this.motions.length;t++){var e=this.motions[t];console.log("_$wL[%s] [%d]. ",e._$4P,e._$I0.length);for(var i=0;i<e._$I0.length&&i<10;i++)console.log("%5.2f ,",e._$I0[i]);console.log("\n")}},V.prototype.updateParamExe=function(t,e,i,r){for(var s=(e-r._$z2)*this._$D0/1e3,n=0|s,o=s-n,a=0;a<this.motions.length;a++){var l=this.motions[a],h=l._$I0.length,u=l._$4P;if(l._$RP==N._$hs){var _=l._$I0[n>=h?h-1:n];t.setParamFloat(u,_)}else if(N._$ws<=l._$RP&&l._$RP<=N._$Ys);else{var c=t.getParamFloat(u),g=l._$I0[n>=h?h-1:n],p=c+(g+(l._$I0[n+1>=h?h-1:n+1]-g)*o-c)*i;t.setParamFloat(u,p)}}n>=this._$yT&&(this._$E?(r._$z2=e,this.loopFadeIn&&(r._$bs=e)):r._$9L=!0)},V.prototype._$r0=function(){return this._$E},V.prototype._$aL=function(t){this._$E=t},V.prototype.isLoopFadeIn=function(){return this.loopFadeIn},V.prototype.setLoopFadeIn=function(t){this.loopFadeIn=t},O.prototype.clear=function(){this.size=0},O.prototype.add=function(t){if(this._$P.length<=this.size){var e=new Float32Array(2*this.size);b._$jT(this._$P,0,e,0,this.size),this._$P=e}this._$P[this.size++]=t},O.prototype._$BL=function(){var t=new Float32Array(this.size);return b._$jT(this._$P,0,t,0,this.size),t},N._$Fr=0,N._$hs=1,N._$ws=100,N._$Ns=101,N._$xs=102,N._$us=103,N._$qs=104,N._$Ys=105,k._$Ms=1,k._$Qs=2,k._$i2=0,k._$No=2,k._$do=k._$Ms,k._$Ls=!0,k._$1r=5,k._$Qb=65,k._$J=1e-4,k._$FT=.001,k._$Ss=3,U._$o7=6,U._$S7=7,U._$s7=8,U._$77=9,U.LIVE2D_FORMAT_VERSION_V2_10_SDK2=10,U.LIVE2D_FORMAT_VERSION_V2_11_SDK2_1=11,U._$T7=U.LIVE2D_FORMAT_VERSION_V2_11_SDK2_1,U._$Is=-2004318072,U._$h0=0,U._$4L=23,U._$7P=33,U._$uT=function(t){console.log("_$bo :: _$6 _$mo _$E0 : %d\n",t)},U._$9o=function(t){if(t<40)return U._$uT(t),null;if(t<50)return U._$uT(t),null;if(t<60)return U._$uT(t),null;if(t<100)switch(t){case 65:return new tt;case 66:return new A;case 67:return new E;case 68:return new H;case 69:return new x;case 70:return new ct;default:return U._$uT(t),null}else if(t<150)switch(t){case 131:return new at;case 133:return new it;case 136:return new g;case 137:return new nt;case 142:return new J}return U._$uT(t),null},z._$HP=0,z._$_0=!0,z._$V2=-1,z._$W0=-1,z._$jr=!1,z._$ZS=!0,z._$tr=-1e6,z._$lr=1e6,z._$is=32,z._$e=!1,z.prototype.getDrawDataIndex=function(t){for(var e=this._$aS.length-1;e>=0;--e)if(null!=this._$aS[e]&&this._$aS[e].getDrawDataID()==t)return e;return-1},z.prototype.getDrawData=function(t){if(t instanceof D){if(null==this._$Bo){this._$Bo=new Object;for(var e=this._$aS.length,i=0;i<e;i++){var r=this._$aS[i],s=r.getDrawDataID();null!=s&&(this._$Bo[s]=r)}}return this._$Bo[id]}return t<this._$aS.length?this._$aS[t]:null},z.prototype.release=function(){this._$3S.clear(),this._$aS.clear(),this._$F2.clear(),null!=this._$Bo&&this._$Bo.clear(),this._$db.clear(),this._$8b.clear(),this._$Hr.clear()},z.prototype.init=function(){this._$co++,this._$F2.length>0&&this.release();for(var t=this._$Ri.getModelImpl(),e=t._$Xr(),i=e.length,s=new Array,n=new Array,o=0;o<i;++o){var a=e[o];this._$F2.push(a),this._$Hr.push(a.init(this));for(var l=a.getBaseData(),h=l.length,u=0;u<h;++u)s.push(l[u]);for(u=0;u<h;++u){var _=l[u].init(this);_._$l2(o),n.push(_)}var c=a.getDrawData(),g=c.length;for(u=0;u<g;++u){var p=c[u],d=p.init(this);d._$IP=o,this._$aS.push(p),this._$8b.push(d)}}for(var f=s.length,m=yt._$2o();;){var $=!1;for(o=0;o<f;++o){var y=s[o];if(null!=y){var S=y.getTargetBaseDataID();(null==S||S==m||this.getBaseDataIndex(S)>=0)&&(this._$3S.push(y),this._$db.push(n[o]),s[o]=null,$=!0)}}if(!$)break}var x=t._$E2();if(null!=x){var v=x._$1s();if(null!=v){var P=v.length;for(o=0;o<P;++o){var T=v[o];null!=T&&this._$02(T.getParamID(),T.getDefaultValue(),T.getMinValue(),T.getMaxValue())}}}this.clipManager=new r(this.dp_webgl),this.clipManager.init(this,this._$aS,this._$8b),this._$QT=!0},z.prototype.update=function(){z._$e&&l.start("_$zL");for(var t=this._$_2.length,e=0;e<t;e++)this._$_2[e]!=this._$vr[e]&&(this._$Js[e]=z._$ZS,this._$vr[e]=this._$_2[e]);var i=this._$3S.length,r=this._$aS.length,s=W._$or(),n=W._$Pr()-s+1;(null==this._$Ws||this._$Ws.length<n)&&(this._$Ws=new Int16Array(n),this._$Vs=new Int16Array(n));for(e=0;e<n;e++)this._$Ws[e]=z._$V2,this._$Vs[e]=z._$V2;(null==this._$Er||this._$Er.length<r)&&(this._$Er=new Int16Array(r));for(e=0;e<r;e++)this._$Er[e]=z._$W0;z._$e&&l.dump("_$zL"),z._$e&&l.start("_$UL");for(var o=null,a=0;a<i;++a){var h=this._$3S[a],u=this._$db[a];try{h._$Nr(this,u),h._$2b(this,u)}catch(t){null==o&&(o=t)}}null!=o&&z._$_0&&l._$Rb(o),z._$e&&l.dump("_$UL"),z._$e&&l.start("_$DL");for(var _=null,c=0;c<r;++c){var g=this._$aS[c],p=this._$8b[c];try{if(g._$Nr(this,p),p._$u2())continue;g._$2b(this,p);var d,f=Math.floor(g._$zS(this,p)-s);try{d=this._$Vs[f]}catch(t){console.log("_$li :: %s / %s \t\t\t\t@@_$fS\n",t.toString(),g.getDrawDataID().toString()),f=Math.floor(g._$zS(this,p)-s);continue}d==z._$V2?this._$Ws[f]=c:this._$Er[d]=c,this._$Vs[f]=c}catch(t){null==_&&(_=t,ht._$sT(ht._$H7))}}null!=_&&z._$_0&&l._$Rb(_),z._$e&&l.dump("_$DL"),z._$e&&l.start("_$eL");for(e=this._$Js.length-1;e>=0;e--)this._$Js[e]=z._$jr;return this._$QT=!1,z._$e&&l.dump("_$eL"),!1},z.prototype.preDraw=function(t){null!=this.clipManager&&(t._$ZT(),this.clipManager.setupClip(this,t))},z.prototype.draw=function(t){if(null!=this._$Ws){var e=this._$Ws.length;t._$ZT();for(var i=0;i<e;++i){var r=this._$Ws[i];if(r!=z._$V2)for(;;){var s=this._$aS[r],n=this._$8b[r];if(n._$yo()){var o=n._$IP,a=this._$Hr[o];n._$VS=a.getPartsOpacity(),s.draw(t,this,n)}var h=this._$Er[r];if(h<=r||h==z._$W0)break;r=h}}}else l._$li("call _$Ri.update() before _$Ri.draw() ")},z.prototype.getParamIndex=function(t){for(var e=this._$pb.length-1;e>=0;--e)if(this._$pb[e]==t)return e;return this._$02(t,0,z._$tr,z._$lr)},z.prototype._$BS=function(t){return this.getBaseDataIndex(t)},z.prototype.getBaseDataIndex=function(t){for(var e=this._$3S.length-1;e>=0;--e)if(null!=this._$3S[e]&&this._$3S[e].getBaseDataID()==t)return e;return-1},z.prototype._$UT=function(t,e){var i=new Float32Array(e);return b._$jT(t,0,i,0,t.length),i},z.prototype._$02=function(t,e,i,r){if(this._$qo>=this._$pb.length){var s=this._$pb.length,n=new Array(2*s);b._$jT(this._$pb,0,n,0,s),this._$pb=n,this._$_2=this._$UT(this._$_2,2*s),this._$vr=this._$UT(this._$vr,2*s),this._$Rr=this._$UT(this._$Rr,2*s),this._$Or=this._$UT(this._$Or,2*s);var o=new Array;b._$jT(this._$Js,0,o,0,s),this._$Js=o}return this._$pb[this._$qo]=t,this._$_2[this._$qo]=e,this._$vr[this._$qo]=e,this._$Rr[this._$qo]=i,this._$Or[this._$qo]=r,this._$Js[this._$qo]=z._$ZS,this._$qo++},z.prototype._$Zo=function(t,e){this._$3S[t]=e},z.prototype.setParamFloat=function(t,e){e<this._$Rr[t]&&(e=this._$Rr[t]),e>this._$Or[t]&&(e=this._$Or[t]),this._$_2[t]=e},z.prototype.loadParam=function(){var t=this._$_2.length;t>this._$fs.length&&(t=this._$fs.length),b._$jT(this._$fs,0,this._$_2,0,t)},z.prototype.saveParam=function(){var t=this._$_2.length;t>this._$fs.length&&(this._$fs=new Float32Array(t)),b._$jT(this._$_2,0,this._$fs,0,t)},z.prototype._$v2=function(){return this._$co},z.prototype._$WS=function(){return this._$QT},z.prototype._$Xb=function(t){return this._$Js[t]==z._$ZS},z.prototype._$vs=function(){return this._$Es},z.prototype._$Tr=function(){return this._$ZP},z.prototype.getBaseData=function(t){return this._$3S[t]},z.prototype.getParamFloat=function(t){return this._$_2[t]},z.prototype.getParamMax=function(t){return this._$Or[t]},z.prototype.getParamMin=function(t){return this._$Rr[t]},z.prototype.setPartsOpacity=function(t,e){this._$Hr[t].setPartsOpacity(e)},z.prototype.getPartsOpacity=function(t){return this._$Hr[t].getPartsOpacity()},z.prototype.getPartsDataIndex=function(t){for(var e=this._$F2.length-1;e>=0;--e)if(null!=this._$F2[e]&&this._$F2[e]._$p2()==t)return e;return-1},z.prototype._$q2=function(t){return this._$db[t]},z.prototype._$C2=function(t){return this._$8b[t]},z.prototype._$Bb=function(t){return this._$Hr[t]},z.prototype._$5s=function(t,e){for(var i=this._$Ws.length,r=t,s=0;s<i;++s){var n=this._$Ws[s];if(n!=z._$V2)for(;;){var o=this._$8b[n];o._$yo()&&(o._$GT()._$B2(this,o,r),r+=e);var a=this._$Er[n];if(a<=n||a==z._$W0)break;n=a}}},z.prototype.setDrawParam=function(t){this.dp_webgl=t},z.prototype.getDrawParam=function(){return this.dp_webgl},Y._$0T=function(t){return Y._$0T(new _$5(t))},Y._$0T=function(t){if(!t.exists())throw new _$ls(t._$3b());for(var e,i=t.length(),r=new Int8Array(i),s=new _$Xs(new _$kb(t),8192),n=0;(e=s.read(r,n,i-n))>0;)n+=e;return r},Y._$C=function(t){var e=null,i=null;try{e=t instanceof Array?t:new _$Xs(t,8192),i=new _$js;for(var r,s=new Int8Array(1e3);(r=e.read(s))>0;)i.write(s,0,r);return i._$TS()}finally{null!=t&&t.close(),null!=i&&(i.flush(),i.close())}},G.prototype._$T2=function(){return b.getUserTimeMSec()+Math._$10()*(2*this._$Br-1)},G.prototype._$uo=function(t){this._$Br=t},G.prototype._$QS=function(t,e,i){this._$Dr=t,this._$Cb=e,this._$mr=i},G.prototype._$7T=function(t){var e,i=b.getUserTimeMSec(),r=0;switch(this._$_L){case STATE_CLOSING:(r=(i-this._$bb)/this._$Dr)>=1&&(r=1,this._$_L=X.STATE_CLOSED,this._$bb=i),e=1-r;break;case STATE_CLOSED:(r=(i-this._$bb)/this._$Cb)>=1&&(this._$_L=X.STATE_OPENING,this._$bb=i),e=0;break;case STATE_OPENING:(r=(i-this._$bb)/this._$mr)>=1&&(r=1,this._$_L=X.STATE_INTERVAL,this._$12=this._$T2()),e=r;break;case STATE_INTERVAL:this._$12<i&&(this._$_L=X.STATE_CLOSING,this._$bb=i),e=1;break;case STATE_FIRST:default:this._$_L=X.STATE_INTERVAL,this._$12=this._$T2(),e=1}this._$jo||(e=-e),t.setParamFloat(this._$iL,e),t.setParamFloat(this._$0L,e)};var X=function(){};function j(){e||(I.prototype.constructor.call(this),this._$sb=new Int32Array(j._$As),this._$U2=new Array,this.transform=null,this.gl=null,null==j._$NT&&(j._$NT=j._$9r(256),j._$vS=j._$9r(256),j._$no=j._$vb(256)))}function H(){e||(L.prototype.constructor.call(this),this._$GS=null,this._$Y0=null)}function q(t){lt.prototype.constructor.call(this,t),this._$8r=L._$ur,this._$Yr=null,this._$Wr=null}function W(){e||(w.prototype.constructor.call(this),this._$gP=null,this._$dr=null,this._$GS=null,this._$qb=null,this._$Lb=null,this._$mS=null)}function J(){e||(this._$NL=null,this._$3S=null,this._$aS=null,J._$42++)}function Q(){e||(i.prototype.constructor.call(this),this._$zo=new j)}function Z(){e||(a.prototype.constructor.call(this),this.motions=new Array,this._$o2=null,this._$7r=Z._$Co++,this._$D0=30,this._$yT=0,this._$E=!1,this.loopFadeIn=!0,this._$rr=-1,this._$eP=0)}function K(t,e){return String.fromCharCode(t.getUint8(e))}function O(){this._$P=new Float32Array(100),this.size=0}function N(){this._$4P=null,this._$I0=null,this._$RP=null}function tt(){e||(L.prototype.constructor.call(this),this._$o=0,this._$A=0,this._$GS=null,this._$Eo=null)}function et(t){lt.prototype.constructor.call(this,t),this._$8r=L._$ur,this._$Cr=null,this._$hr=null}function it(){e||(this.visible=!0,this._$g0=!1,this._$NL=null,this._$3S=null,this._$aS=null,it._$42++)}function rt(t){this._$VS=null,this._$e0=null,this._$e0=t}function st(t){e||(this.id=t)}function nt(){e||(this._$4S=null)}function ot(t,e){this.canvas=t,this.context=e,this.viewport=new Array(0,0,t.width,t.height),this._$6r=1,this._$xP=0,this._$3r=1,this._$uP=0,this._$Qo=-1,this.cacheImages={}}function at(){e||(this._$TT=null,this._$LT=null,this._$FS=null,this._$wL=null)}function lt(t){e||(this._$e0=null,this._$IP=null,this._$JS=!1,this._$AT=!0,this._$e0=t,this.totalScale=1,this._$7s=1,this.totalOpacity=1)}function ht(){}function ut(){}function _t(t){e||(this._$ib=t)}function ct(){e||(W.prototype.constructor.call(this),this._$LP=-1,this._$d0=0,this._$Yo=0,this._$JP=null,this._$5P=null,this._$BP=null,this._$Eo=null,this._$Qi=null,this._$6s=ct._$ms,this.culling=!0,this.gl_cacheImage=null,this.instanceNo=ct._$42++)}function gt(t){wt.prototype.constructor.call(this,t),this._$8r=W._$ur,this._$Cr=null,this._$hr=null}function pt(){e||(this.x=null,this.y=null)}function dt(t){e||(i.prototype.constructor.call(this),this.drawParamWebGL=new St(t),this.drawParamWebGL.setGL(ht.getGL(t)))}function ft(){e||(this.motions=null,this._$eb=!1,this.motions=new Array)}function mt(){this._$w0=null,this._$AT=!0,this._$9L=!1,this._$z2=-1,this._$bs=-1,this._$Do=-1,this._$sr=null,this._$sr=mt._$Gs++}function $t(){this.m=new Array(1,0,0,0,1,0,0,0,1)}function yt(t){e||st.prototype.constructor.call(this,t)}function St(t){e||(I.prototype.constructor.call(this),this.textures=new Array,this.transform=null,this.gl=null,this.glno=t,this.firstDraw=!0,this.anisotropyExt=null,this.maxAnisotropy=0,this._$As=32,this._$Gr=!1,this._$NT=null,this._$vS=null,this._$no=null,this.vertShader=null,this.fragShader=null,this.vertShaderOff=null,this.fragShaderOff=null)}function xt(t,e,i){return null==e&&(e=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,i,t.DYNAMIC_DRAW),e}function vt(t,e,i){return null==e&&(e=t.createBuffer()),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),t.bufferData(t.ELEMENT_ARRAY_BUFFER,i,t.DYNAMIC_DRAW),e}function Pt(t){e||(this._$P=new Int8Array(8),this._$R0=new DataView(this._$P.buffer),this._$3i=new Int8Array(1e3),this._$hL=0,this._$v0=0,this._$S2=0,this._$Ko=new Array,this._$T=t,this._$F=0)}X.STATE_FIRST="STATE_FIRST",X.STATE_INTERVAL="STATE_INTERVAL",X.STATE_CLOSING="STATE_CLOSING",X.STATE_CLOSED="STATE_CLOSED",X.STATE_OPENING="STATE_OPENING",j.prototype=new I,j._$As=32,j._$Gr=!1,j._$NT=null,j._$vS=null,j._$no=null,j._$9r=function(t){return new Float32Array(t)},j._$vb=function(t){return new Int16Array(t)},j._$cr=function(t,e){return null==t||t._$yL()<e.length?((t=j._$9r(2*e.length)).put(e),t._$oT(0)):(t.clear(),t.put(e),t._$oT(0)),t},j._$mb=function(t,e){return null==t||t._$yL()<e.length?((t=j._$vb(2*e.length)).put(e),t._$oT(0)):(t.clear(),t.put(e),t._$oT(0)),t},j._$Hs=function(){return j._$Gr},j._$as=function(t){j._$Gr=t},j.prototype.setGL=function(t){this.gl=t},j.prototype.setTransform=function(t){this.transform=t},j.prototype._$ZT=function(){},j.prototype._$Uo=function(t,e,i,r,s,n,o,a){if(!(n<.01)){var l=this._$U2[t],h=n>.9?ht.EXPAND_W:0;this.gl.drawElements(l,i,r,s,n,h,this.transform,a)}},j.prototype._$Rs=function(){throw new Error("_$Rs")},j.prototype._$Ds=function(t){throw new Error("_$Ds")},j.prototype._$K2=function(){for(var t=0;t<this._$sb.length;t++){0!=this._$sb[t]&&(this.gl._$Sr(1,this._$sb,t),this._$sb[t]=0)}},j.prototype.setTexture=function(t,e){this._$sb.length<t+1&&this._$nS(t),this._$sb[t]=e},j.prototype.setTexture=function(t,e){this._$sb.length<t+1&&this._$nS(t),this._$U2[t]=e},j.prototype._$nS=function(t){var e=Math.max(2*this._$sb.length,t+1+10),i=new Int32Array(e);b._$jT(this._$sb,0,i,0,this._$sb.length),this._$sb=i;var r=new Array;b._$jT(this._$U2,0,r,0,this._$U2.length),this._$U2=r},H.prototype=new L,H._$Xo=new Float32Array(2),H._$io=new Float32Array(2),H._$0o=new Float32Array(2),H._$Lo=new Float32Array(2),H._$To=new Float32Array(2),H._$Po=new Float32Array(2),H._$gT=new Array,H.prototype._$zP=function(){this._$GS=new A,this._$GS._$zP(),this._$Y0=new Array},H.prototype.getType=function(){return L._$c2},H.prototype._$F0=function(t){L.prototype._$F0.call(this,t),this._$GS=t._$nP(),this._$Y0=t._$nP(),L.prototype.readV2_opacity.call(this,t)},H.prototype.init=function(t){var e=new q(this);return e._$Yr=new x,this._$32()&&(e._$Wr=new x),e},H.prototype._$Nr=function(t,e){this!=e._$GT()&&console.log("### assert!! ### ");var i=e;if(this._$GS._$Ur(t)){var r=H._$gT;r[0]=!1;var s=this._$GS._$Q2(t,r);e._$Ib(r[0]),this.interpolateOpacity(t,this._$GS,e,r);var n=t._$vs(),o=t._$Tr();if(this._$GS._$zr(n,o,s),s<=0){var a=this._$Y0[n[0]];i._$Yr.init(a)}else if(1==s){a=this._$Y0[n[0]];var l=this._$Y0[n[1]],h=o[0];i._$Yr._$fL=a._$fL+(l._$fL-a._$fL)*h,i._$Yr._$gL=a._$gL+(l._$gL-a._$gL)*h,i._$Yr._$B0=a._$B0+(l._$B0-a._$B0)*h,i._$Yr._$z0=a._$z0+(l._$z0-a._$z0)*h,i._$Yr._$qT=a._$qT+(l._$qT-a._$qT)*h}else if(2==s){a=this._$Y0[n[0]],l=this._$Y0[n[1]];var u=this._$Y0[n[2]],_=this._$Y0[n[3]],c=(h=o[0],o[1]),g=a._$fL+(l._$fL-a._$fL)*h,p=u._$fL+(_._$fL-u._$fL)*h;i._$Yr._$fL=g+(p-g)*c,g=a._$gL+(l._$gL-a._$gL)*h,p=u._$gL+(_._$gL-u._$gL)*h,i._$Yr._$gL=g+(p-g)*c,g=a._$B0+(l._$B0-a._$B0)*h,p=u._$B0+(_._$B0-u._$B0)*h,i._$Yr._$B0=g+(p-g)*c,g=a._$z0+(l._$z0-a._$z0)*h,p=u._$z0+(_._$z0-u._$z0)*h,i._$Yr._$z0=g+(p-g)*c,g=a._$qT+(l._$qT-a._$qT)*h,p=u._$qT+(_._$qT-u._$qT)*h,i._$Yr._$qT=g+(p-g)*c}else if(3==s){var d=this._$Y0[n[0]],f=this._$Y0[n[1]],m=this._$Y0[n[2]],$=this._$Y0[n[3]],y=this._$Y0[n[4]],S=this._$Y0[n[5]],x=this._$Y0[n[6]],v=this._$Y0[n[7]],P=(h=o[0],c=o[1],o[2]),T=(g=d._$fL+(f._$fL-d._$fL)*h,p=m._$fL+($._$fL-m._$fL)*h,y._$fL+(S._$fL-y._$fL)*h),M=x._$fL+(v._$fL-x._$fL)*h;i._$Yr._$fL=(1-P)*(g+(p-g)*c)+P*(T+(M-T)*c),g=d._$gL+(f._$gL-d._$gL)*h,p=m._$gL+($._$gL-m._$gL)*h,T=y._$gL+(S._$gL-y._$gL)*h,M=x._$gL+(v._$gL-x._$gL)*h,i._$Yr._$gL=(1-P)*(g+(p-g)*c)+P*(T+(M-T)*c),g=d._$B0+(f._$B0-d._$B0)*h,p=m._$B0+($._$B0-m._$B0)*h,T=y._$B0+(S._$B0-y._$B0)*h,M=x._$B0+(v._$B0-x._$B0)*h,i._$Yr._$B0=(1-P)*(g+(p-g)*c)+P*(T+(M-T)*c),g=d._$z0+(f._$z0-d._$z0)*h,p=m._$z0+($._$z0-m._$z0)*h,T=y._$z0+(S._$z0-y._$z0)*h,M=x._$z0+(v._$z0-x._$z0)*h,i._$Yr._$z0=(1-P)*(g+(p-g)*c)+P*(T+(M-T)*c),g=d._$qT+(f._$qT-d._$qT)*h,p=m._$qT+($._$qT-m._$qT)*h,T=y._$qT+(S._$qT-y._$qT)*h,M=x._$qT+(v._$qT-x._$qT)*h,i._$Yr._$qT=(1-P)*(g+(p-g)*c)+P*(T+(M-T)*c)}else if(4==s){var w=this._$Y0[n[0]],I=this._$Y0[n[1]],C=this._$Y0[n[2]],L=this._$Y0[n[3]],b=this._$Y0[n[4]],E=this._$Y0[n[5]],B=this._$Y0[n[6]],A=this._$Y0[n[7]],F=this._$Y0[n[8]],D=this._$Y0[n[9]],R=this._$Y0[n[10]],V=this._$Y0[n[11]],O=this._$Y0[n[12]],N=this._$Y0[n[13]],k=this._$Y0[n[14]],U=this._$Y0[n[15]],z=(h=o[0],c=o[1],P=o[2],o[3]),Y=(g=w._$fL+(I._$fL-w._$fL)*h,p=C._$fL+(L._$fL-C._$fL)*h,T=b._$fL+(E._$fL-b._$fL)*h,M=B._$fL+(A._$fL-B._$fL)*h,F._$fL+(D._$fL-F._$fL)*h),G=R._$fL+(V._$fL-R._$fL)*h,X=O._$fL+(N._$fL-O._$fL)*h,j=k._$fL+(U._$fL-k._$fL)*h;i._$Yr._$fL=(1-z)*((1-P)*(g+(p-g)*c)+P*(T+(M-T)*c))+z*((1-P)*(Y+(G-Y)*c)+P*(X+(j-X)*c)),g=w._$gL+(I._$gL-w._$gL)*h,p=C._$gL+(L._$gL-C._$gL)*h,T=b._$gL+(E._$gL-b._$gL)*h,M=B._$gL+(A._$gL-B._$gL)*h,Y=F._$gL+(D._$gL-F._$gL)*h,G=R._$gL+(V._$gL-R._$gL)*h,X=O._$gL+(N._$gL-O._$gL)*h,j=k._$gL+(U._$gL-k._$gL)*h,i._$Yr._$gL=(1-z)*((1-P)*(g+(p-g)*c)+P*(T+(M-T)*c))+z*((1-P)*(Y+(G-Y)*c)+P*(X+(j-X)*c)),g=w._$B0+(I._$B0-w._$B0)*h,p=C._$B0+(L._$B0-C._$B0)*h,T=b._$B0+(E._$B0-b._$B0)*h,M=B._$B0+(A._$B0-B._$B0)*h,Y=F._$B0+(D._$B0-F._$B0)*h,G=R._$B0+(V._$B0-R._$B0)*h,X=O._$B0+(N._$B0-O._$B0)*h,j=k._$B0+(U._$B0-k._$B0)*h,i._$Yr._$B0=(1-z)*((1-P)*(g+(p-g)*c)+P*(T+(M-T)*c))+z*((1-P)*(Y+(G-Y)*c)+P*(X+(j-X)*c)),g=w._$z0+(I._$z0-w._$z0)*h,p=C._$z0+(L._$z0-C._$z0)*h,T=b._$z0+(E._$z0-b._$z0)*h,M=B._$z0+(A._$z0-B._$z0)*h,Y=F._$z0+(D._$z0-F._$z0)*h,G=R._$z0+(V._$z0-R._$z0)*h,X=O._$z0+(N._$z0-O._$z0)*h,j=k._$z0+(U._$z0-k._$z0)*h,i._$Yr._$z0=(1-z)*((1-P)*(g+(p-g)*c)+P*(T+(M-T)*c))+z*((1-P)*(Y+(G-Y)*c)+P*(X+(j-X)*c)),g=w._$qT+(I._$qT-w._$qT)*h,p=C._$qT+(L._$qT-C._$qT)*h,T=b._$qT+(E._$qT-b._$qT)*h,M=B._$qT+(A._$qT-B._$qT)*h,Y=F._$qT+(D._$qT-F._$qT)*h,G=R._$qT+(V._$qT-R._$qT)*h,X=O._$qT+(N._$qT-O._$qT)*h,j=k._$qT+(U._$qT-k._$qT)*h,i._$Yr._$qT=(1-z)*((1-P)*(g+(p-g)*c)+P*(T+(M-T)*c))+z*((1-P)*(Y+(G-Y)*c)+P*(X+(j-X)*c))}else{for(var q=0|Math.pow(2,s),W=new Float32Array(q),J=0;J<q;J++){for(var Q=J,Z=1,K=0;K<s;K++)Z*=Q%2==0?1-o[K]:o[K],Q/=2;W[J]=Z}for(var tt=new Array,et=0;et<q;et++)tt[et]=this._$Y0[n[et]];var it=0,rt=0,st=0,nt=0,ot=0;for(et=0;et<q;et++)it+=W[et]*tt[et]._$fL,rt+=W[et]*tt[et]._$gL,st+=W[et]*tt[et]._$B0,nt+=W[et]*tt[et]._$z0,ot+=W[et]*tt[et]._$qT;i._$Yr._$fL=it,i._$Yr._$gL=rt,i._$Yr._$B0=st,i._$Yr._$z0=nt,i._$Yr._$qT=ot}a=this._$Y0[n[0]];i._$Yr.reflectX=a.reflectX,i._$Yr.reflectY=a.reflectY}},H.prototype._$2b=function(t,e){this!=e._$GT()&&console.log("### assert!! ### ");var i=e;if(i._$hS(!0),this._$32()){var r=this.getTargetBaseDataID();if(i._$8r==L._$ur&&(i._$8r=t.getBaseDataIndex(r)),i._$8r<0)ht._$so&&l._$li("_$L _$0P _$G :: %s",r),i._$hS(!1);else{var s=t.getBaseData(i._$8r);if(null!=s){var n=t._$q2(i._$8r),o=H._$Xo;o[0]=i._$Yr._$fL,o[1]=i._$Yr._$gL;var a=H._$io;a[0]=0,a[1]=-.1,n._$GT().getType()==L._$c2?a[1]=-10:a[1]=-.1;var h=H._$0o;this._$Jr(t,s,n,o,a,h);var u=Mt._$92(a,h);s._$nb(t,n,o,o,1,0,2),i._$Wr._$fL=o[0],i._$Wr._$gL=o[1],i._$Wr._$B0=i._$Yr._$B0,i._$Wr._$z0=i._$Yr._$z0,i._$Wr._$qT=i._$Yr._$qT-u*Mt._$NS;var _=n.getTotalScale();i.setTotalScale_notForClient(_*i._$Wr._$B0);var c=n.getTotalOpacity();i.setTotalOpacity(c*i.getInterpolatedOpacity()),i._$Wr.reflectX=i._$Yr.reflectX,i._$Wr.reflectY=i._$Yr.reflectY,i._$hS(n._$yo())}else i._$hS(!1)}}else i.setTotalScale_notForClient(i._$Yr._$B0),i.setTotalOpacity(i.getInterpolatedOpacity())},H.prototype._$nb=function(t,e,i,r,s,n,o){this!=e._$GT()&&console.log("### assert!! ### ");for(var a,l,h=e,u=null!=h._$Wr?h._$Wr:h._$Yr,_=Math.sin(Mt._$bS*u._$qT),c=Math.cos(Mt._$bS*u._$qT),g=h.getTotalScale(),p=u.reflectX?-1:1,d=u.reflectY?-1:1,f=c*g*p,m=-_*g*d,$=_*g*p,y=c*g*d,S=u._$fL,x=u._$gL,v=s*o,P=n;P<v;P+=o)a=i[P],l=i[P+1],r[P]=f*a+m*l+S,r[P+1]=$*a+y*l+x},H.prototype._$Jr=function(t,e,i,r,s,n){e!=i._$GT()&&console.log("### assert!! ### ");var o=H._$Lo;H._$Lo[0]=r[0],H._$Lo[1]=r[1],e._$nb(t,i,o,o,1,0,2);for(var a=H._$To,l=H._$Po,h=1,u=0;u<10;u++){if(l[0]=r[0]+h*s[0],l[1]=r[1]+h*s[1],e._$nb(t,i,l,a,1,0,2),a[0]-=o[0],a[1]-=o[1],0!=a[0]||0!=a[1])return n[0]=a[0],void(n[1]=a[1]);if(l[0]=r[0]-h*s[0],l[1]=r[1]-h*s[1],e._$nb(t,i,l,a,1,0,2),a[0]-=o[0],a[1]-=o[1],0!=a[0]||0!=a[1])return a[0]=-a[0],a[0]=-a[0],n[0]=a[0],void(n[1]=a[1]);h*=.1}ht._$so&&console.log("_$L0 to transform _$SP\n")},q.prototype=new lt,W.prototype=new w,W._$ur=-2,W._$ES=500,W._$wb=2,W._$8S=3,W._$os=4,W._$52=W._$ES,W._$R2=W._$ES,W._$Sb=function(t){for(var e=t.length-1;e>=0;--e){var i=t[e];i<W._$52?W._$52=i:i>W._$R2&&(W._$R2=i)}},W._$or=function(){return W._$52},W._$Pr=function(){return W._$R2},W.prototype._$F0=function(t){this._$gP=t._$nP(),this._$dr=t._$nP(),this._$GS=t._$nP(),this._$qb=t._$6L(),this._$Lb=t._$cS(),this._$mS=t._$Tb(),t.getFormatVersion()>=U._$T7?(this.clipID=t._$nP(),this.clipIDList=this.convertClipIDForV2_11(this.clipID)):this.clipIDList=null,W._$Sb(this._$Lb)},W.prototype.getClipIDList=function(){return this.clipIDList},W.prototype._$Nr=function(t,e){if(e._$IS[0]=!1,e._$Us=T._$Z2(t,this._$GS,e._$IS,this._$Lb),ht._$Zs);else if(e._$IS[0])return;e._$7s=T._$br(t,this._$GS,e._$IS,this._$mS)},W.prototype._$2b=function(t){},W.prototype.getDrawDataID=function(){return this._$gP},W.prototype._$j2=function(t){this._$gP=t},W.prototype.getOpacity=function(t,e){return e._$7s},W.prototype._$zS=function(t,e){return e._$Us},W.prototype.getTargetBaseDataID=function(){return this._$dr},W.prototype._$gs=function(t){this._$dr=t},W.prototype._$32=function(){return null!=this._$dr&&this._$dr!=yt._$2o()},W.prototype.getType=function(){},J._$42=0,J.prototype._$1b=function(){return this._$3S},J.prototype.getDrawDataList=function(){return this._$aS},J.prototype._$F0=function(t){this._$NL=t._$nP(),this._$aS=t._$nP(),this._$3S=t._$nP()},J.prototype._$kr=function(t){t._$Zo(this._$3S),t._$xo(this._$aS),this._$3S=null,this._$aS=null},Q.prototype=new i,Q.loadModel=function(t){var e=new Q;return i._$62(e,t),e},Q.loadModel=function(t){var e=new Q;return i._$62(e,t),e},Q._$to=function(){return new Q},Q._$er=function(t){var e=new _$5("../_$_r/_$t0/_$Ri/_$_P._$d");if(0==e.exists())throw new _$ls("_$t0 _$_ _$6 _$Ui :: "+e._$PL());for(var i=["../_$_r/_$t0/_$Ri/_$_P.512/_$CP._$1","../_$_r/_$t0/_$Ri/_$_P.512/_$vP._$1","../_$_r/_$t0/_$Ri/_$_P.512/_$EP._$1","../_$_r/_$t0/_$Ri/_$_P.512/_$pP._$1"],r=Q.loadModel(e._$3b()),s=0;s<i.length;s++){var n=new _$5(i[s]);if(0==n.exists())throw new _$ls("_$t0 _$_ _$6 _$Ui :: "+n._$PL());r.setTexture(s,_$nL._$_o(t,n._$3b()))}return r},Q.prototype.setGL=function(t){this._$zo.setGL(t)},Q.prototype.setTransform=function(t){this._$zo.setTransform(t)},Q.prototype.draw=function(){this._$5S.draw(this._$zo)},Q.prototype._$K2=function(){this._$zo._$K2()},Q.prototype.setTexture=function(t,e){null==this._$zo&&l._$li("_$Yi for QT _$ki / _$XS() is _$6 _$ui!!"),this._$zo.setTexture(t,e)},Q.prototype.setTexture=function(t,e){null==this._$zo&&l._$li("_$Yi for QT _$ki / _$XS() is _$6 _$ui!!"),this._$zo.setTexture(t,e)},Q.prototype._$Rs=function(){return this._$zo._$Rs()},Q.prototype._$Ds=function(t){this._$zo._$Ds(t)},Q.prototype.getDrawParam=function(){return this._$zo},Z.prototype=new a,Z._$cs="VISIBLE:",Z._$ar="LAYOUT:",Z.MTN_PREFIX_FADEIN="FADEIN:",Z.MTN_PREFIX_FADEOUT="FADEOUT:",Z._$Co=0,Z._$1T=1,Z.loadMotion=function(t){var e=Y._$C(t);return Z.loadMotion(e)},Z.loadMotion=function(t){t instanceof ArrayBuffer&&(t=new DataView(t));var e=new Z,i=[0],r=t.byteLength;e._$yT=0;for(var s=0;s<r;++s){var n=K(t,s),o=n.charCodeAt(0);if("\n"!=n&&"\r"!=n)if("#"!=n)if("$"!=n){if(97<=o&&o<=122||65<=o&&o<=90||"_"==n){for(_=s,c=-1;s<r&&("\r"!=(n=K(t,s))&&"\n"!=n);++s)if("="==n){c=s;break}if(c>=0){var a=new N;B.startsWith(t,_,Z._$cs)?(a._$RP=N._$hs,a._$4P=B.createString(t,_,c-_)):B.startsWith(t,_,Z._$ar)?(a._$4P=B.createString(t,_+7,c-_-7),B.startsWith(t,_+7,"ANCHOR_X")?a._$RP=N._$xs:B.startsWith(t,_+7,"ANCHOR_Y")?a._$RP=N._$us:B.startsWith(t,_+7,"SCALE_X")?a._$RP=N._$qs:B.startsWith(t,_+7,"SCALE_Y")?a._$RP=N._$Ys:B.startsWith(t,_+7,"X")?a._$RP=N._$ws:B.startsWith(t,_+7,"Y")&&(a._$RP=N._$Ns)):(a._$RP=N._$Fr,a._$4P=B.createString(t,_,c-_)),e.motions.push(a);var l=0,h=[];for(s=c+1;s<r&&("\r"!=(n=K(t,s))&&"\n"!=n);++s)if(","!=n&&" "!=n&&"\t"!=n){p=B._$LS(t,r,s,i);if(i[0]>0){h.push(p),l++;var u=i[0];if(u<s){console.log("_$n0 _$hi . @Live2DMotion loadMotion()\n");break}s=u-1}}a._$I0=new Float32Array(h),l>e._$yT&&(e._$yT=l)}}}else{for(var _=s,c=-1;s<r&&("\r"!=(n=K(t,s))&&"\n"!=n);++s)if("="==n){c=s;break}var g=!1;if(c>=0)for(c==_+4&&"f"==K(t,_+1)&&"p"==K(t,_+2)&&"s"==K(t,_+3)&&(g=!0),s=c+1;s<r&&("\r"!=(n=K(t,s))&&"\n"!=n);++s)if(","!=n&&" "!=n&&"\t"!=n){var p=B._$LS(t,r,s,i);i[0]>0&&g&&5<p&&p<121&&(e._$D0=p),s=i[0]}for(;s<r&&("\n"!=K(t,s)&&"\r"!=K(t,s));++s);}else for(;s<r&&("\n"!=K(t,s)&&"\r"!=K(t,s));++s);}return e._$rr=1e3*e._$yT/e._$D0|0,e},Z.prototype.getDurationMSec=function(){return this._$E?-1:this._$rr},Z.prototype.getLoopDurationMSec=function(){return this._$rr},Z.prototype.dump=function(){for(var t=0;t<this.motions.length;t++){var e=this.motions[t];console.log("_$wL[%s] [%d]. ",e._$4P,e._$I0.length);for(var i=0;i<e._$I0.length&&i<10;i++)console.log("%5.2f ,",e._$I0[i]);console.log("\n")}},Z.prototype.updateParamExe=function(t,e,i,r){for(var s=(e-r._$z2)*this._$D0/1e3,n=0|s,o=s-n,a=0;a<this.motions.length;a++){var l=this.motions[a],h=l._$I0.length,u=l._$4P;if(l._$RP==N._$hs){var _=l._$I0[n>=h?h-1:n];t.setParamFloat(u,_)}else if(N._$ws<=l._$RP&&l._$RP<=N._$Ys);else{var c=t.getParamIndex(u),g=t.getModelContext(),p=.4*(g.getParamMax(c)-g.getParamMin(c)),d=g.getParamFloat(c),f=l._$I0[n>=h?h-1:n],m=l._$I0[n+1>=h?h-1:n+1],$=d+((f<m&&m-f>p||f>m&&f-m>p?f:f+(m-f)*o)-d)*i;t.setParamFloat(u,$)}}n>=this._$yT&&(this._$E?(r._$z2=e,this.loopFadeIn&&(r._$bs=e)):r._$9L=!0),this._$eP=i},Z.prototype._$r0=function(){return this._$E},Z.prototype._$aL=function(t){this._$E=t},Z.prototype._$S0=function(){return this._$D0},Z.prototype._$U0=function(t){this._$D0=t},Z.prototype.isLoopFadeIn=function(){return this.loopFadeIn},Z.prototype.setLoopFadeIn=function(t){this.loopFadeIn=t},O.prototype.clear=function(){this.size=0},O.prototype.add=function(t){if(this._$P.length<=this.size){var e=new Float32Array(2*this.size);b._$jT(this._$P,0,e,0,this.size),this._$P=e}this._$P[this.size++]=t},O.prototype._$BL=function(){var t=new Float32Array(this.size);return b._$jT(this._$P,0,t,0,this.size),t},N._$Fr=0,N._$hs=1,N._$ws=100,N._$Ns=101,N._$xs=102,N._$us=103,N._$qs=104,N._$Ys=105,tt.prototype=new L,tt._$gT=new Array,tt.prototype._$zP=function(){this._$GS=new A,this._$GS._$zP()},tt.prototype._$F0=function(t){L.prototype._$F0.call(this,t),this._$A=t._$6L(),this._$o=t._$6L(),this._$GS=t._$nP(),this._$Eo=t._$nP(),L.prototype.readV2_opacity.call(this,t)},tt.prototype.init=function(t){var e=new et(this),i=(this._$o+1)*(this._$A+1);return null!=e._$Cr&&(e._$Cr=null),e._$Cr=new Float32Array(2*i),null!=e._$hr&&(e._$hr=null),this._$32()?e._$hr=new Float32Array(2*i):e._$hr=null,e},tt.prototype._$Nr=function(t,e){var i=e;if(this._$GS._$Ur(t)){var r=this._$VT(),s=tt._$gT;s[0]=!1,T._$Vr(t,this._$GS,s,r,this._$Eo,i._$Cr,0,2),e._$Ib(s[0]),this.interpolateOpacity(t,this._$GS,e,s)}},tt.prototype._$2b=function(t,e){var i=e;if(i._$hS(!0),this._$32()){var r=this.getTargetBaseDataID();if(i._$8r==L._$ur&&(i._$8r=t.getBaseDataIndex(r)),i._$8r<0)ht._$so&&l._$li("_$L _$0P _$G :: %s",r),i._$hS(!1);else{var s=t.getBaseData(i._$8r),n=t._$q2(i._$8r);if(null!=s&&n._$yo()){var o=n.getTotalScale();i.setTotalScale_notForClient(o);var a=n.getTotalOpacity();i.setTotalOpacity(a*i.getInterpolatedOpacity()),s._$nb(t,n,i._$Cr,i._$hr,this._$VT(),0,2),i._$hS(!0)}else i._$hS(!1)}}else i.setTotalOpacity(i.getInterpolatedOpacity())},tt.prototype._$nb=function(t,e,i,r,s,n,o){var a=e,l=null!=a._$hr?a._$hr:a._$Cr;tt.transformPoints_sdk2(i,r,s,n,o,l,this._$o,this._$A)},tt.transformPoints_sdk2=function(e,i,r,s,n,o,a,l){for(var h,u,_,c=r*n,g=0,p=0,d=0,f=0,m=0,$=0,y=!1,S=s;S<c;S+=n){var x,v,P,T;if(P=e[S],v=(T=e[S+1])*l,(x=P*a)<0||v<0||a<=x||l<=v){var M=a+1;if(!y){y=!0,g=.25*(o[2*(0+0*M)]+o[2*(a+0*M)]+o[2*(0+l*M)]+o[2*(a+l*M)]),p=.25*(o[2*(0+0*M)+1]+o[2*(a+0*M)+1]+o[2*(0+l*M)+1]+o[2*(a+l*M)+1]);var w=o[2*(a+l*M)]-o[2*(0+0*M)],I=o[2*(a+l*M)+1]-o[2*(0+0*M)+1],C=o[2*(a+0*M)]-o[2*(0+l*M)],L=o[2*(a+0*M)+1]-o[2*(0+l*M)+1];g-=.5*((d=.5*(w+C))+(m=.5*(w-C))),p-=.5*((f=.5*(I+L))+($=.5*(I-L)))}if(-2<P&&P<3&&-2<T&&T<3)if(P<=0)if(T<=0){var b=o[2*(0+0*M)],E=o[2*(0+0*M)+1],B=g-2*d,A=p-2*f,F=g-2*m,D=p-2*$,R=g-2*d-2*m,V=p-2*f-2*$;(O=.5*(P- -2))+(N=.5*(T- -2))<=1?(i[S]=R+(F-R)*O+(B-R)*N,i[S+1]=V+(D-V)*O+(A-V)*N):(i[S]=b+(B-b)*(1-O)+(F-b)*(1-N),i[S+1]=E+(A-E)*(1-O)+(D-E)*(1-N))}else if(T>=1){F=o[2*(0+l*M)],D=o[2*(0+l*M)+1],R=g-2*d+1*m,V=p-2*f+1*$,b=g+3*m,E=p+3*$,B=g-2*d+3*m,A=p-2*f+3*$;(O=.5*(P- -2))+(N=.5*(T-1))<=1?(i[S]=R+(F-R)*O+(B-R)*N,i[S+1]=V+(D-V)*O+(A-V)*N):(i[S]=b+(B-b)*(1-O)+(F-b)*(1-N),i[S+1]=E+(A-E)*(1-O)+(D-E)*(1-N))}else{(z=0|v)==l&&(z=l-1);var O=.5*(P- -2),N=v-z,k=z/l,U=(z+1)/l;F=o[2*(0+z*M)],D=o[2*(0+z*M)+1],b=o[2*(0+(z+1)*M)],E=o[2*(0+(z+1)*M)+1],R=g-2*d+k*m,V=p-2*f+k*$,B=g-2*d+U*m,A=p-2*f+U*$;O+N<=1?(i[S]=R+(F-R)*O+(B-R)*N,i[S+1]=V+(D-V)*O+(A-V)*N):(i[S]=b+(B-b)*(1-O)+(F-b)*(1-N),i[S+1]=E+(A-E)*(1-O)+(D-E)*(1-N))}else if(1<=P)if(T<=0){B=o[2*(a+0*M)],A=o[2*(a+0*M)+1],b=g+3*d,E=p+3*f,R=g+1*d-2*m,V=p+1*f-2*$,F=g+3*d-2*m,D=p+3*f-2*$;(O=.5*(P-1))+(N=.5*(T- -2))<=1?(i[S]=R+(F-R)*O+(B-R)*N,i[S+1]=V+(D-V)*O+(A-V)*N):(i[S]=b+(B-b)*(1-O)+(F-b)*(1-N),i[S+1]=E+(A-E)*(1-O)+(D-E)*(1-N))}else if(T>=1){R=o[2*(a+l*M)],V=o[2*(a+l*M)+1],F=g+3*d+1*m,D=p+3*f+1*$,B=g+1*d+3*m,A=p+1*f+3*$,b=g+3*d+3*m,E=p+3*f+3*$;(O=.5*(P-1))+(N=.5*(T-1))<=1?(i[S]=R+(F-R)*O+(B-R)*N,i[S+1]=V+(D-V)*O+(A-V)*N):(i[S]=b+(B-b)*(1-O)+(F-b)*(1-N),i[S+1]=E+(A-E)*(1-O)+(D-E)*(1-N))}else{var z;(z=0|v)==l&&(z=l-1);O=.5*(P-1),N=v-z,k=z/l,U=(z+1)/l,R=o[2*(a+z*M)],V=o[2*(a+z*M)+1],B=o[2*(a+(z+1)*M)],A=o[2*(a+(z+1)*M)+1],F=g+3*d+k*m,D=p+3*f+k*$,b=g+3*d+U*m,E=p+3*f+U*$;O+N<=1?(i[S]=R+(F-R)*O+(B-R)*N,i[S+1]=V+(D-V)*O+(A-V)*N):(i[S]=b+(B-b)*(1-O)+(F-b)*(1-N),i[S+1]=E+(A-E)*(1-O)+(D-E)*(1-N))}else if(T<=0){(X=0|x)==a&&(X=a-1);O=x-X,N=.5*(T- -2);var Y=X/a,G=(X+1)/a;B=o[2*(X+0*M)],A=o[2*(X+0*M)+1],b=o[2*(X+1+0*M)],E=o[2*(X+1+0*M)+1],R=g+Y*d-2*m,V=p+Y*f-2*$,F=g+G*d-2*m,D=p+G*f-2*$;O+N<=1?(i[S]=R+(F-R)*O+(B-R)*N,i[S+1]=V+(D-V)*O+(A-V)*N):(i[S]=b+(B-b)*(1-O)+(F-b)*(1-N),i[S+1]=E+(A-E)*(1-O)+(D-E)*(1-N))}else if(T>=1){var X;(X=0|x)==a&&(X=a-1);O=x-X,N=.5*(T-1),Y=X/a,G=(X+1)/a,R=o[2*(X+l*M)],V=o[2*(X+l*M)+1],F=o[2*(X+1+l*M)],D=o[2*(X+1+l*M)+1],B=g+Y*d+3*m,A=p+Y*f+3*$,b=g+G*d+3*m,E=p+G*f+3*$;O+N<=1?(i[S]=R+(F-R)*O+(B-R)*N,i[S+1]=V+(D-V)*O+(A-V)*N):(i[S]=b+(B-b)*(1-O)+(F-b)*(1-N),i[S+1]=E+(A-E)*(1-O)+(D-E)*(1-N))}else t.err.printf("_$li calc : %.4f , %.4f\t\t\t\t\t@@BDBoxGrid\n",P,T);else i[S]=g+P*d+T*m,i[S+1]=p+P*f+T*$}else h=2*((0|x)+(0|v)*(a+1)),(u=x-(0|x))+(_=v-(0|v))<1?(i[S]=o[h]*(1-u-_)+o[h+2]*u+o[h+2*(a+1)]*_,i[S+1]=o[h+1]*(1-u-_)+o[h+3]*u+o[h+2*(a+1)+1]*_):(i[S]=o[h+2*(a+1)+2]*(u-1+_)+o[h+2*(a+1)]*(1-u)+o[h+2]*(1-_),i[S+1]=o[h+2*(a+1)+3]*(u-1+_)+o[h+2*(a+1)+1]*(1-u)+o[h+3]*(1-_))}},tt.prototype.transformPoints_sdk1=function(t,e,i,r,s,n,o){for(var a,l,h,u,_,c,g,p=e,d=this._$o,f=this._$A,m=s*o,$=null!=p._$hr?p._$hr:p._$Cr,y=n;y<m;y+=o)ht._$ts?((a=i[y])<0?a=0:a>1&&(a=1),(l=i[y+1])<0?l=0:l>1&&(l=1),(h=0|(a*=d))>d-1&&(h=d-1),(u=0|(l*=f))>f-1&&(u=f-1),c=a-h,g=l-u,_=2*(h+u*(d+1))):(c=(a=i[y]*d)-(0|a),g=(l=i[y+1]*f)-(0|l),_=2*((0|a)+(0|l)*(d+1))),c+g<1?(r[y]=$[_]*(1-c-g)+$[_+2]*c+$[_+2*(d+1)]*g,r[y+1]=$[_+1]*(1-c-g)+$[_+3]*c+$[_+2*(d+1)+1]*g):(r[y]=$[_+2*(d+1)+2]*(c-1+g)+$[_+2*(d+1)]*(1-c)+$[_+2]*(1-g),r[y+1]=$[_+2*(d+1)+3]*(c-1+g)+$[_+2*(d+1)+1]*(1-c)+$[_+3]*(1-g))},tt.prototype._$VT=function(){return(this._$o+1)*(this._$A+1)},tt.prototype.getType=function(){return L._$_b},et.prototype=new lt,it._$42=0,it.prototype._$zP=function(){this._$3S=new Array,this._$aS=new Array},it.prototype._$F0=function(t){this._$g0=t._$8L(),this.visible=t._$8L(),this._$NL=t._$nP(),this._$3S=t._$nP(),this._$aS=t._$nP()},it.prototype.init=function(t){var e=new rt(this);return e.setPartsOpacity(this.isVisible()?1:0),e},it.prototype._$6o=function(t){if(null==this._$3S)throw new Error("_$3S _$6 _$Wo@_$6o");this._$3S.push(t)},it.prototype._$3o=function(t){if(null==this._$aS)throw new Error("_$aS _$6 _$Wo@_$3o");this._$aS.push(t)},it.prototype._$Zo=function(t){this._$3S=t},it.prototype._$xo=function(t){this._$aS=t},it.prototype.isVisible=function(){return this.visible},it.prototype._$uL=function(){return this._$g0},it.prototype._$KP=function(t){this.visible=t},it.prototype._$ET=function(t){this._$g0=t},it.prototype.getBaseData=function(){return this._$3S},it.prototype.getDrawData=function(){return this._$aS},it.prototype._$p2=function(){return this._$NL},it.prototype._$ob=function(t){this._$NL=t},it.prototype.getPartsID=function(){return this._$NL},it.prototype._$MP=function(t){this._$NL=t},rt.prototype=new function(){},rt.prototype.getPartsOpacity=function(){return this._$VS},rt.prototype.setPartsOpacity=function(t){this._$VS=t},st._$L7=function(){c._$27(),yt._$27(),D._$27(),_._$27()},st.prototype.toString=function(){return this.id},nt.prototype._$1s=function(){return this._$4S},nt.prototype._$zP=function(){this._$4S=new Array},nt.prototype._$F0=function(t){this._$4S=t._$nP()},nt.prototype._$Ks=function(t){this._$4S.push(t)},ot.tr=new $t,ot._$50=new $t,ot._$Ti=new Array(0,0),ot._$Pi=new Array(0,0),ot._$B=new Array(0,0),ot.prototype._$lP=function(t,e,i,r){this.viewport=new Array(t,e,i,r)},ot.prototype._$bL=function(){this.context.save();var t=this.viewport;null!=t&&(this.context.beginPath(),this.context._$Li(t[0],t[1],t[2],t[3]),this.context.clip())},ot.prototype._$ei=function(){this.context.restore()},ot.prototype.drawElements=function(t,e,i,r,s,n,o,a){try{s!=this._$Qo&&(this._$Qo=s,this.context.globalAlpha=s);for(var h=e.length,u=t.width,_=t.height,c=this.context,g=this._$xP,p=this._$uP,d=this._$6r,f=this._$3r,m=ot.tr,$=ot._$Ti,y=ot._$Pi,S=ot._$B,x=0;x<h;x+=3){c.save();var P=e[x],T=e[x+1],M=e[x+2],w=g+d*i[2*P],I=p+f*i[2*P+1],C=g+d*i[2*T],L=p+f*i[2*T+1],b=g+d*i[2*M],E=p+f*i[2*M+1];o&&(o._$PS(w,I,S),w=S[0],I=S[1],o._$PS(C,L,S),C=S[0],L=S[1],o._$PS(b,E,S),b=S[0],E=S[1]);var B=u*r[2*P],A=_-_*r[2*P+1],F=u*r[2*T],D=_-_*r[2*T+1],R=u*r[2*M],V=_-_*r[2*M+1],O=Math.atan2(D-A,F-B),N=Math.atan2(L-I,C-w),k=C-w,U=L-I,z=Math.sqrt(k*k+U*U),Y=F-B,G=D-A,X=z/Math.sqrt(Y*Y+G*G);v._$ni(R,V,B,A,F-B,D-A,-(D-A),F-B,$),v._$ni(b,E,w,I,C-w,L-I,-(L-I),C-w,y);var j=(y[0]-$[0])/$[1],H=Math.min(B,F,R),q=Math.max(B,F,R),W=Math.min(A,D,V),J=Math.max(A,D,V),Q=Math.floor(H),Z=Math.floor(W),K=Math.ceil(q),tt=Math.ceil(J);m.identity(),m.translate(w,I),m.rotate(N),m.scale(1,y[1]/$[1]),m.shear(j,0),m.scale(X,X),m.rotate(-O),m.translate(-B,-A),m.setContext(c);if(n||(n=1.2),ht.IGNORE_EXPAND&&(n=0),ht.USE_CACHED_POLYGON_IMAGE){var et=a._$e0;if(et.gl_cacheImage=et.gl_cacheImage||{},!et.gl_cacheImage[x]){var it=ot.createCanvas(K-Q,tt-Z);ht.DEBUG_DATA.LDGL_CANVAS_MB=ht.DEBUG_DATA.LDGL_CANVAS_MB||0,ht.DEBUG_DATA.LDGL_CANVAS_MB+=(K-Q)*(tt-Z)*4;var rt=it.getContext("2d");rt.translate(-Q,-Z),ot.clip(rt,m,n,z,B,A,F,D,R,V,w,I,C,L,b,E),rt.drawImage(t,0,0),et.gl_cacheImage[x]={cacheCanvas:it,cacheContext:rt}}c.drawImage(et.gl_cacheImage[x].cacheCanvas,Q,Z)}else ht.IGNORE_CLIP||ot.clip(c,m,n,z,B,A,F,D,R,V,w,I,C,L,b,E),ht.USE_ADJUST_TRANSLATION&&(H=0,q=u,W=0,J=_),c.drawImage(t,H,W,q-H,J-W,H,W,q-H,J-W);c.restore()}}catch(t){l._$Rb(t)}},ot.clip=function(t,e,i,r,s,n,o,a,l,h,u,_,c,g,p,d){i>.02?ot.expandClip(t,e,i,r,u,_,c,g,p,d):ot.clipWithTransform(t,null,s,n,o,a,l,h)},ot.expandClip=function(t,e,i,r,s,n,o,a,l,h){var u=o-s,_=a-n,c=l-s,g=h-n,p=u*g-_*c>0?i:-i,d=-_,f=u,m=l-o,$=h-a,y=-$,S=m,x=Math.sqrt(m*m+$*$),v=-g,P=c,T=Math.sqrt(c*c+g*g),M=s-p*d/r,w=n-p*f/r,I=o-p*d/r,C=a-p*f/r,L=o-p*y/x,b=a-p*S/x,E=l-p*y/x,B=h-p*S/x,A=s+p*v/T,F=n+p*P/T,D=l+p*v/T,R=h+p*P/T,V=ot._$50;return null!=e._$P2(V)&&(ot.clipWithTransform(t,V,M,w,I,C,L,b,E,B,D,R,A,F),!0)},ot.clipWithTransform=function(t,e,i,r,s,n,o,a){if(arguments.length<7)l._$li("err : @LDGL.clip()");else if(arguments[1]instanceof $t){var h=ot._$B,u=e,_=arguments;if(t.beginPath(),u){u._$PS(_[2],_[3],h),t.moveTo(h[0],h[1]);for(var c=4;c<_.length;c+=2)u._$PS(_[c],_[c+1],h),t.lineTo(h[0],h[1])}else{t.moveTo(_[2],_[3]);for(c=4;c<_.length;c+=2)t.lineTo(_[c],_[c+1])}t.clip()}else l._$li("err : a[0] is _$6 LDTransform @LDGL.clip()")},ot.createCanvas=function(t,e){var i=document.createElement("canvas");return i.setAttribute("width",t),i.setAttribute("height",e),i||l._$li("err : "+i),i},ot.dumpValues=function(){for(var t="",e=0;e<arguments.length;e++)t+="["+e+"]= "+arguments[e].toFixed(3)+" , ";console.log(t)},at.prototype._$F0=function(t){this._$TT=t._$_T(),this._$LT=t._$_T(),this._$FS=t._$_T(),this._$wL=t._$nP()},at.prototype.getMinValue=function(){return this._$TT},at.prototype.getMaxValue=function(){return this._$LT},at.prototype.getDefaultValue=function(){return this._$FS},at.prototype.getParamID=function(){return this._$wL},lt.prototype._$yo=function(){return this._$AT&&!this._$JS},lt.prototype._$hS=function(t){this._$AT=t},lt.prototype._$GT=function(){return this._$e0},lt.prototype._$l2=function(t){this._$IP=t},lt.prototype.getPartsIndex=function(){return this._$IP},lt.prototype._$x2=function(){return this._$JS},lt.prototype._$Ib=function(t){this._$JS=t},lt.prototype.getTotalScale=function(){return this.totalScale},lt.prototype.setTotalScale_notForClient=function(t){this.totalScale=t},lt.prototype.getInterpolatedOpacity=function(){return this._$7s},lt.prototype.setInterpolatedOpacity=function(t){this._$7s=t},lt.prototype.getTotalOpacity=function(t){return this.totalOpacity},lt.prototype.setTotalOpacity=function(t){this.totalOpacity=t},ht._$2s="2.1.00_1",ht._$Kr=201001e3,ht._$sP=!0,ht._$so=!0,ht._$cb=!1,ht._$3T=!0,ht._$Ts=!0,ht._$fb=!0,ht._$ts=!0,ht.L2D_DEFORMER_EXTEND=!0,ht._$Wb=!1,ht._$yr=!1,ht._$Zs=!1,ht.L2D_NO_ERROR=0,ht._$i7=1e3,ht._$9s=1001,ht._$es=1100,ht._$r7=2e3,ht._$07=2001,ht._$b7=2002,ht._$H7=4e3,ht.L2D_COLOR_BLEND_MODE_MULT=0,ht.L2D_COLOR_BLEND_MODE_ADD=1,ht.L2D_COLOR_BLEND_MODE_INTERPOLATE=2,ht._$6b=!0,ht._$cT=0,ht.clippingMaskBufferSize=256,ht.glContext=new Array,ht.frameBuffers=new Array,ht.fTexture=new Array,ht.IGNORE_CLIP=!1,ht.IGNORE_EXPAND=!1,ht.EXPAND_W=2,ht.USE_ADJUST_TRANSLATION=!0,ht.USE_CANVAS_TRANSFORM=!0,ht.USE_CACHED_POLYGON_IMAGE=!1,ht.DEBUG_DATA={},ht.PROFILE_IOS_SPEED={PROFILE_NAME:"iOS Speed",USE_ADJUST_TRANSLATION:!0,USE_CACHED_POLYGON_IMAGE:!0,EXPAND_W:4},ht.PROFILE_IOS_QUALITY={PROFILE_NAME:"iOS HiQ",USE_ADJUST_TRANSLATION:!0,USE_CACHED_POLYGON_IMAGE:!1,EXPAND_W:2},ht.PROFILE_IOS_DEFAULT=ht.PROFILE_IOS_QUALITY,ht.PROFILE_ANDROID={PROFILE_NAME:"Android",USE_ADJUST_TRANSLATION:!1,USE_CACHED_POLYGON_IMAGE:!1,EXPAND_W:2},ht.PROFILE_DESKTOP={PROFILE_NAME:"Desktop",USE_ADJUST_TRANSLATION:!1,USE_CACHED_POLYGON_IMAGE:!1,EXPAND_W:2},ht.initProfile=function(){It.isIOS()?ht.setupProfile(ht.PROFILE_IOS_DEFAULT):It.isAndroid()?ht.setupProfile(ht.PROFILE_ANDROID):ht.setupProfile(ht.PROFILE_DESKTOP)},ht.setupProfile=function(t,e){if("number"==typeof t)switch(t){case 9901:t=ht.PROFILE_IOS_SPEED;break;case 9902:t=ht.PROFILE_IOS_QUALITY;break;case 9903:t=ht.PROFILE_IOS_DEFAULT;break;case 9904:t=ht.PROFILE_ANDROID;break;case 9905:t=ht.PROFILE_DESKTOP;break;default:alert("profile _$6 _$Ui : "+t)}for(var i in arguments.length<2&&(e=!0),e&&console.log("profile : "+t.PROFILE_NAME),t)ht[i]=t[i],e&&console.log("  ["+i+"] = "+t[i])},ht.init=function(){if(ht._$6b){console.log("Live2D %s",ht._$2s),ht._$6b=!1;!0,ht.initProfile()}},ht.getVersionStr=function(){return ht._$2s},ht.getVersionNo=function(){return ht._$Kr},ht._$sT=function(t){ht._$cT=t},ht.getError=function(){var t=ht._$cT;return ht._$cT=0,t},ht.dispose=function(){ht.glContext=[],ht.frameBuffers=[],ht.fTexture=[]},ht.setGL=function(t,e){var i=e||0;ht.glContext[i]=t},ht.getGL=function(t){return ht.glContext[t]},ht.setClippingMaskBufferSize=function(t){ht.clippingMaskBufferSize=t},ht.getClippingMaskBufferSize=function(){return ht.clippingMaskBufferSize},ht.deleteBuffer=function(t){ht.getGL(t).deleteFramebuffer(ht.frameBuffers[t].framebuffer),delete ht.frameBuffers[t],delete ht.glContext[t]},ut._$r2=function(t){return t<0?0:t>1?1:.5-.5*Math.cos(t*Mt.PI_F)},_t._$fr=-1,_t.prototype.toString=function(){return this._$ib},ct.prototype=new W,ct._$42=0,ct._$Os=30,ct._$ms=0,ct._$ns=1,ct._$_s=2,ct._$gT=new Array,ct.prototype._$_S=function(t){this._$LP=t},ct.prototype.getTextureNo=function(){return this._$LP},ct.prototype._$ZL=function(){return this._$Qi},ct.prototype._$H2=function(){return this._$JP},ct.prototype.getNumPoints=function(){return this._$d0},ct.prototype.getType=function(){return W._$wb},ct.prototype._$B2=function(t,e,i){var r=e,s=null!=r._$hr?r._$hr:r._$Cr;switch(k._$do){default:case k._$Ms:throw new Error("_$L _$ro ");case k._$Qs:for(var n=this._$d0-1;n>=0;--n){s[n*k._$No+4]=i}}},ct.prototype._$zP=function(){this._$GS=new A,this._$GS._$zP()},ct.prototype._$F0=function(t){W.prototype._$F0.call(this,t),this._$LP=t._$6L(),this._$d0=t._$6L(),this._$Yo=t._$6L();var e=t._$nP();this._$BP=new Int16Array(3*this._$Yo);for(var i=3*this._$Yo-1;i>=0;--i)this._$BP[i]=e[i];if(this._$Eo=t._$nP(),this._$Qi=t._$nP(),t.getFormatVersion()>=U._$s7){if(this._$JP=t._$6L(),0!=this._$JP){if(0!=(1&this._$JP)){var r=t._$6L();null==this._$5P&&(this._$5P=new Object),this._$5P._$Hb=parseInt(r)}0!=(this._$JP&ct._$Os)?this._$6s=(this._$JP&ct._$Os)>>1:this._$6s=ct._$ms,0!=(32&this._$JP)&&(this.culling=!1)}}else this._$JP=0},ct.prototype.init=function(t){var e=new gt(this),i=this._$d0*k._$No,r=this._$32();switch(null!=e._$Cr&&(e._$Cr=null),e._$Cr=new Float32Array(i),null!=e._$hr&&(e._$hr=null),e._$hr=r?new Float32Array(i):null,k._$do){default:case k._$Ms:if(k._$Ls)for(var s=this._$d0-1;s>=0;--s){var n=s<<1;this._$Qi[n+1]=1-this._$Qi[n+1]}break;case k._$Qs:for(s=this._$d0-1;s>=0;--s){n=s<<1;var o=s*k._$No,a=this._$Qi[n],l=this._$Qi[n+1];e._$Cr[o]=a,e._$Cr[o+1]=l,e._$Cr[o+4]=0,r&&(e._$hr[o]=a,e._$hr[o+1]=l,e._$hr[o+4]=0)}}return e},ct.prototype._$Nr=function(t,e){var i=e;if(this!=i._$GT()&&console.log("### assert!! ### "),this._$GS._$Ur(t)&&(W.prototype._$Nr.call(this,t,i),!i._$IS[0])){var r=ct._$gT;r[0]=!1,T._$Vr(t,this._$GS,r,this._$d0,this._$Eo,i._$Cr,k._$i2,k._$No)}},ct.prototype._$2b=function(t,e){try{this!=e._$GT()&&console.log("### assert!! ### ");var i=!1;e._$IS[0]&&(i=!0);var r=e;if(!i&&(W.prototype._$2b.call(this,t),this._$32())){var s=this.getTargetBaseDataID();if(r._$8r==W._$ur&&(r._$8r=t.getBaseDataIndex(s)),r._$8r<0)ht._$so&&l._$li("_$L _$0P _$G :: %s",s);else{var n=t.getBaseData(r._$8r),o=t._$q2(r._$8r);null==n||o._$x2()?r._$AT=!1:(n._$nb(t,o,r._$Cr,r._$hr,this._$d0,k._$i2,k._$No),r._$AT=!0),r.baseOpacity=o.getTotalOpacity()}}}catch(t){throw t}},ct.prototype.draw=function(t,e,i){if(this!=i._$GT()&&console.log("### assert!! ### "),!i._$IS[0]){var r=i,s=this._$LP;s<0&&(s=1);var n=this.getOpacity(e,r)*i._$VS*i.baseOpacity,o=null!=r._$hr?r._$hr:r._$Cr;t.setClipBufPre_clipContextForDraw(i.clipBufPre_clipContext),t._$WP(this.culling),t._$Uo(s,3*this._$Yo,this._$BP,o,this._$Qi,n,this._$6s,r)}},ct.prototype.dump=function(){console.log("  _$yi( %d ) , _$d0( %d ) , _$Yo( %d ) \n",this._$LP,this._$d0,this._$Yo),console.log("  _$Oi _$di = { ");for(var t=0;t<this._$BP.length;t++)console.log("%5d ,",this._$BP[t]);console.log("\n  _$5i _$30");for(t=0;t<this._$Eo.length;t++){console.log("\n    _$30[%d] = ",t);for(var e=this._$Eo[t],i=0;i<e.length;i++)console.log("%6.2f, ",e[i])}console.log("\n")},ct.prototype._$72=function(t){return null==this._$5P?null:this._$5P[t]},ct.prototype.getIndexArray=function(){return this._$BP},gt.prototype=new wt,gt.prototype.getTransformedPoints=function(){return null!=this._$hr?this._$hr:this._$Cr},pt.prototype._$HT=function(t){this.x=t.x,this.y=t.y},pt.prototype._$HT=function(t,e){this.x=t,this.y=e},dt.prototype=new i,dt.loadModel=function(t){var e=new dt;return i._$62(e,t),e},dt.loadModel=function(t,e){var r=new dt(e||0);return i._$62(r,t),r},dt._$to=function(){return new dt},dt._$er=function(t){var e=new _$5("../_$_r/_$t0/_$Ri/_$_P._$d");if(0==e.exists())throw new _$ls("_$t0 _$_ _$6 _$Ui :: "+e._$PL());for(var i=["../_$_r/_$t0/_$Ri/_$_P.512/_$CP._$1","../_$_r/_$t0/_$Ri/_$_P.512/_$vP._$1","../_$_r/_$t0/_$Ri/_$_P.512/_$EP._$1","../_$_r/_$t0/_$Ri/_$_P.512/_$pP._$1"],r=dt.loadModel(e._$3b()),s=0;s<i.length;s++){var n=new _$5(i[s]);if(0==n.exists())throw new _$ls("_$t0 _$_ _$6 _$Ui :: "+n._$PL());r.setTexture(s,_$nL._$_o(t,n._$3b()))}return r},dt.prototype.setGL=function(t){ht.setGL(t)},dt.prototype.setTransform=function(t){this.drawParamWebGL.setTransform(t)},dt.prototype.update=function(){this._$5S.update(),this._$5S.preDraw(this.drawParamWebGL)},dt.prototype.draw=function(){this._$5S.draw(this.drawParamWebGL)},dt.prototype._$K2=function(){this.drawParamWebGL._$K2()},dt.prototype.setTexture=function(t,e){null==this.drawParamWebGL&&l._$li("_$Yi for QT _$ki / _$XS() is _$6 _$ui!!"),this.drawParamWebGL.setTexture(t,e)},dt.prototype.setTexture=function(t,e){null==this.drawParamWebGL&&l._$li("_$Yi for QT _$ki / _$XS() is _$6 _$ui!!"),this.drawParamWebGL.setTexture(t,e)},dt.prototype._$Rs=function(){return this.drawParamWebGL._$Rs()},dt.prototype._$Ds=function(t){this.drawParamWebGL._$Ds(t)},dt.prototype.getDrawParam=function(){return this.drawParamWebGL},dt.prototype.setMatrix=function(t){this.drawParamWebGL.setMatrix(t)},dt.prototype.setPremultipliedAlpha=function(t){this.drawParamWebGL.setPremultipliedAlpha(t)},dt.prototype.isPremultipliedAlpha=function(){return this.drawParamWebGL.isPremultipliedAlpha()},dt.prototype.setAnisotropy=function(t){this.drawParamWebGL.setAnisotropy(t)},dt.prototype.getAnisotropy=function(){return this.drawParamWebGL.getAnisotropy()},ft.prototype._$tb=function(){return this.motions},ft.prototype.startMotion=function(t,e){for(var i=null,r=this.motions.length,s=0;s<r;++s)null!=(i=this.motions[s])&&(i._$qS(i._$w0.getFadeOut()),this._$eb&&l._$Ji("MotionQueueManager[size:%2d]->startMotion() / start _$K _$3 (m%d)\n",r,i._$sr));if(null==t)return-1;(i=new mt)._$w0=t,this.motions.push(i);var n=i._$sr;return this._$eb&&l._$Ji("MotionQueueManager[size:%2d]->startMotion() / new _$w0 (m%d)\n",r,n),n},ft.prototype.updateParam=function(t){try{for(var e=!1,i=0;i<this.motions.length;i++){var r=this.motions[i];if(null!=r){var s=r._$w0;null!=s?(s.updateParam(t,r),e=!0,r.isFinished()&&(this._$eb&&l._$Ji("MotionQueueManager[size:%2d]->updateParam() / _$T0 _$w0 (m%d)\n",this.motions.length-1,r._$sr),this.motions.splice(i,1),i--)):(this.motions=this.motions.splice(i,1),i--)}else this.motions.splice(i,1),i--}return e}catch(t){return l._$li(t),!0}},ft.prototype.isFinished=function(t){if(arguments.length>=1){for(var e=0;e<this.motions.length;e++){if(null!=(i=this.motions[e])&&(i._$sr==t&&!i.isFinished()))return!1}return!0}for(e=0;e<this.motions.length;e++){var i;if(null!=(i=this.motions[e])){var r=i._$w0;if(null!=r){if(!i.isFinished())return!1}else this.motions.splice(e,1),e--}else this.motions.splice(e,1),e--}return!0},ft.prototype.stopAllMotions=function(){for(var t=0;t<this.motions.length;t++){var e=this.motions[t];if(null!=e){e._$w0;this.motions.splice(t,1),t--}else this.motions.splice(t,1),t--}},ft.prototype._$Zr=function(t){this._$eb=t},ft.prototype._$e=function(){console.log("-- _$R --\n");for(var t=0;t<this.motions.length;t++){var e=this.motions[t]._$w0;console.log("MotionQueueEnt[%d] :: %s\n",this.motions.length,e.toString())}},mt._$Gs=0,mt.prototype.isFinished=function(){return this._$9L},mt.prototype._$qS=function(t){var e=b.getUserTimeMSec()+t;(this._$Do<0||e<this._$Do)&&(this._$Do=e)},mt.prototype._$Bs=function(){return this._$sr},$t.prototype.setContext=function(t){var e=this.m;t.transform(e[0],e[1],e[3],e[4],e[6],e[7])},$t.prototype.toString=function(){for(var t="LDTransform { ",e=0;e<9;e++)t+=this.m[e].toFixed(2)+" ,";return t+=" }"},$t.prototype.identity=function(){var t=this.m;t[0]=t[4]=t[8]=1,t[1]=t[2]=t[3]=t[5]=t[6]=t[7]=0},$t.prototype._$PS=function(t,e,i){null==i&&(i=new Array(0,0));var r=this.m;return i[0]=r[0]*t+r[3]*e+r[6],i[1]=r[1]*t+r[4]*e+r[7],i},$t.prototype._$P2=function(t){t||(t=new $t);var e=this.m,i=e[0],r=e[1],s=e[2],n=e[3],o=e[4],a=e[5],l=e[6],h=e[7],u=e[8],_=i*o*u+r*a*l+s*n*h-i*a*h-s*o*l-r*n*u;if(0==_)return null;var c=1/_;return t.m[0]=c*(o*u-h*a),t.m[1]=c*(h*s-r*u),t.m[2]=c*(r*a-o*s),t.m[3]=c*(l*a-n*u),t.m[4]=c*(i*u-l*s),t.m[5]=c*(n*s-i*a),t.m[6]=c*(n*h-l*o),t.m[7]=c*(l*r-i*h),t.m[8]=c*(i*o-n*r),t},$t.prototype.transform=function(t,e,i){null==i&&(i=new Array(0,0));var r=this.m;return i[0]=r[0]*t+r[3]*e+r[6],i[1]=r[1]*t+r[4]*e+r[7],i},$t.prototype.translate=function(t,e){var i=this.m;i[6]=i[0]*t+i[3]*e+i[6],i[7]=i[1]*t+i[4]*e+i[7],i[8]=i[2]*t+i[5]*e+i[8]},$t.prototype.scale=function(t,e){var i=this.m;i[0]*=t,i[1]*=t,i[2]*=t,i[3]*=e,i[4]*=e,i[5]*=e},$t.prototype.shear=function(t,e){var i=this.m,r=i[0]+i[3]*e,s=i[1]+i[4]*e,n=i[2]+i[5]*e;i[3]=i[0]*t+i[3],i[4]=i[1]*t+i[4],i[5]=i[2]*t+i[5],i[0]=r,i[1]=s,i[2]=n},$t.prototype.rotate=function(t){var e=this.m,i=Math.cos(t),r=Math.sin(t),s=e[0]*i+e[3]*r,n=e[1]*i+e[4]*r,o=e[2]*i+e[5]*r;e[3]=-e[0]*r+e[3]*i,e[4]=-e[1]*r+e[4]*i,e[5]=-e[2]*r+e[5]*i,e[0]=s,e[1]=n,e[2]=o},$t.prototype.concatenate=function(t){var e=this.m,i=t.m,r=e[0]*i[0]+e[3]*i[1]+e[6]*i[2],s=e[1]*i[0]+e[4]*i[1]+e[7]*i[2],n=e[2]*i[0]+e[5]*i[1]+e[8]*i[2],o=e[0]*i[3]+e[3]*i[4]+e[6]*i[5],a=e[1]*i[3]+e[4]*i[4]+e[7]*i[5],l=e[2]*i[3]+e[5]*i[4]+e[8]*i[5],h=e[0]*i[6]+e[3]*i[7]+e[6]*i[8],u=e[1]*i[6]+e[4]*i[7]+e[7]*i[8],_=e[2]*i[6]+e[5]*i[7]+e[8]*i[8];m[0]=r,m[1]=s,m[2]=n,m[3]=o,m[4]=a,m[5]=l,m[6]=h,m[7]=u,m[8]=_},yt.prototype=new st,yt._$eT=null,yt._$tP=new Object,yt._$2o=function(){return null==yt._$eT&&(yt._$eT=yt.getID("DST_BASE")),yt._$eT},yt._$27=function(){yt._$tP.clear(),yt._$eT=null},yt.getID=function(t){var e=yt._$tP[t];return null==e&&(e=new yt(t),yt._$tP[t]=e),e},yt.prototype._$3s=function(){return new yt},St.prototype=new I,St._$9r=function(t){return new Float32Array(t)},St._$vb=function(t){return new Int16Array(t)},St._$cr=function(t,e){return null==t||t._$yL()<e.length?((t=St._$9r(2*e.length)).put(e),t._$oT(0)):(t.clear(),t.put(e),t._$oT(0)),t},St._$mb=function(t,e){return null==t||t._$yL()<e.length?((t=St._$vb(2*e.length)).put(e),t._$oT(0)):(t.clear(),t.put(e),t._$oT(0)),t},St._$Hs=function(){return this._$Gr},St._$as=function(t){this._$Gr=t},St.prototype.getGL=function(){return this.gl},St.prototype.setGL=function(t){this.gl=t},St.prototype.setTransform=function(t){this.transform=t},St.prototype._$ZT=function(){var t=this.gl;this.firstDraw&&(this.initShader(),this.firstDraw=!1,this.anisotropyExt=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic"),this.anisotropyExt&&(this.maxAnisotropy=t.getParameter(this.anisotropyExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.DEPTH_TEST),t.frontFace(t.CW),t.enable(t.BLEND),t.colorMask(1,1,1,1),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)},St.prototype._$Uo=function(t,e,i,r,s,n,o,a){if(!(n<.01&&null==this.clipBufPre_clipContextMask)){n>.9&&ht.EXPAND_W;var l=this.gl;if(null==this.gl)throw new Error("gl is null");var h,u,_,c,g=1*this._$C0*n,p=1*this._$tT*n,d=1*this._$WL*n,f=this._$lT*n;if(null!=this.clipBufPre_clipContextMask){l.frontFace(l.CCW),l.useProgram(this.shaderProgram),this._$vS=xt(l,this._$vS,r),this._$no=vt(l,this._$no,i),l.enableVertexAttribArray(this.a_position_Loc),l.vertexAttribPointer(this.a_position_Loc,2,l.FLOAT,!1,0,0),this._$NT=xt(l,this._$NT,s),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,this.textures[t]),l.uniform1i(this.s_texture0_Loc,1),l.enableVertexAttribArray(this.a_texCoord_Loc),l.vertexAttribPointer(this.a_texCoord_Loc,2,l.FLOAT,!1,0,0),l.uniformMatrix4fv(this.u_matrix_Loc,!1,this.getClipBufPre_clipContextMask().matrixForMask);var m=this.getClipBufPre_clipContextMask().layoutChannelNo,$=this.getChannelFlagAsColor(m);l.uniform4f(this.u_channelFlag,$.r,$.g,$.b,$.a);var y=this.getClipBufPre_clipContextMask().layoutBounds;l.uniform4f(this.u_baseColor_Loc,2*y.x-1,2*y.y-1,2*y._$EL()-1,2*y._$5T()-1),l.uniform1i(this.u_maskFlag_Loc,!0)}else if(null!=this.getClipBufPre_clipContextDraw()){l.useProgram(this.shaderProgramOff),this._$vS=xt(l,this._$vS,r),this._$no=vt(l,this._$no,i),l.enableVertexAttribArray(this.a_position_Loc_Off),l.vertexAttribPointer(this.a_position_Loc_Off,2,l.FLOAT,!1,0,0),this._$NT=xt(l,this._$NT,s),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,this.textures[t]),l.uniform1i(this.s_texture0_Loc_Off,1),l.enableVertexAttribArray(this.a_texCoord_Loc_Off),l.vertexAttribPointer(this.a_texCoord_Loc_Off,2,l.FLOAT,!1,0,0),l.uniformMatrix4fv(this.u_clipMatrix_Loc_Off,!1,this.getClipBufPre_clipContextDraw().matrixForDraw),l.uniformMatrix4fv(this.u_matrix_Loc_Off,!1,this.matrix4x4),l.activeTexture(l.TEXTURE2),l.bindTexture(l.TEXTURE_2D,ht.fTexture[this.glno]),l.uniform1i(this.s_texture1_Loc_Off,2);m=this.getClipBufPre_clipContextDraw().layoutChannelNo,$=this.getChannelFlagAsColor(m);l.uniform4f(this.u_channelFlag_Loc_Off,$.r,$.g,$.b,$.a),l.uniform4f(this.u_baseColor_Loc_Off,g,p,d,f)}else l.useProgram(this.shaderProgram),this._$vS=xt(l,this._$vS,r),this._$no=vt(l,this._$no,i),l.enableVertexAttribArray(this.a_position_Loc),l.vertexAttribPointer(this.a_position_Loc,2,l.FLOAT,!1,0,0),this._$NT=xt(l,this._$NT,s),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,this.textures[t]),l.uniform1i(this.s_texture0_Loc,1),l.enableVertexAttribArray(this.a_texCoord_Loc),l.vertexAttribPointer(this.a_texCoord_Loc,2,l.FLOAT,!1,0,0),l.uniformMatrix4fv(this.u_matrix_Loc,!1,this.matrix4x4),l.uniform4f(this.u_baseColor_Loc,g,p,d,f),l.uniform1i(this.u_maskFlag_Loc,!1);if(this.culling?this.gl.enable(l.CULL_FACE):this.gl.disable(l.CULL_FACE),this.gl.enable(l.BLEND),null!=this.clipBufPre_clipContextMask)h=l.ONE,u=l.ONE_MINUS_SRC_ALPHA,_=l.ONE,c=l.ONE_MINUS_SRC_ALPHA;else switch(o){case ct._$ms:h=l.ONE,u=l.ONE_MINUS_SRC_ALPHA,_=l.ONE,c=l.ONE_MINUS_SRC_ALPHA;break;case ct._$ns:h=l.ONE,u=l.ONE,_=l.ZERO,c=l.ONE;break;case ct._$_s:h=l.DST_COLOR,u=l.ONE_MINUS_SRC_ALPHA,_=l.ZERO,c=l.ONE}l.blendEquationSeparate(l.FUNC_ADD,l.FUNC_ADD),l.blendFuncSeparate(h,u,_,c),this.anisotropyExt&&l.texParameteri(l.TEXTURE_2D,this.anisotropyExt.TEXTURE_MAX_ANISOTROPY_EXT,this.maxAnisotropy);var S=i.length;l.drawElements(l.TRIANGLES,S,l.UNSIGNED_SHORT,0),l.bindTexture(l.TEXTURE_2D,null)}},St.prototype._$Rs=function(){throw new Error("_$Rs")},St.prototype._$Ds=function(t){throw new Error("_$Ds")},St.prototype._$K2=function(){for(var t=0;t<this.textures.length;t++){0!=this.textures[t]&&(this.gl._$K2(1,this.textures,t),this.textures[t]=null)}},St.prototype.setTexture=function(t,e){this.textures[t]=e},St.prototype.initShader=function(){var t=this.gl;this.loadShaders2(),this.a_position_Loc=t.getAttribLocation(this.shaderProgram,"a_position"),this.a_texCoord_Loc=t.getAttribLocation(this.shaderProgram,"a_texCoord"),this.u_matrix_Loc=t.getUniformLocation(this.shaderProgram,"u_mvpMatrix"),this.s_texture0_Loc=t.getUniformLocation(this.shaderProgram,"s_texture0"),this.u_channelFlag=t.getUniformLocation(this.shaderProgram,"u_channelFlag"),this.u_baseColor_Loc=t.getUniformLocation(this.shaderProgram,"u_baseColor"),this.u_maskFlag_Loc=t.getUniformLocation(this.shaderProgram,"u_maskFlag"),this.a_position_Loc_Off=t.getAttribLocation(this.shaderProgramOff,"a_position"),this.a_texCoord_Loc_Off=t.getAttribLocation(this.shaderProgramOff,"a_texCoord"),this.u_matrix_Loc_Off=t.getUniformLocation(this.shaderProgramOff,"u_mvpMatrix"),this.u_clipMatrix_Loc_Off=t.getUniformLocation(this.shaderProgramOff,"u_ClipMatrix"),this.s_texture0_Loc_Off=t.getUniformLocation(this.shaderProgramOff,"s_texture0"),this.s_texture1_Loc_Off=t.getUniformLocation(this.shaderProgramOff,"s_texture1"),this.u_channelFlag_Loc_Off=t.getUniformLocation(this.shaderProgramOff,"u_channelFlag"),this.u_baseColor_Loc_Off=t.getUniformLocation(this.shaderProgramOff,"u_baseColor")},St.prototype.disposeShader=function(){var t=this.gl;this.shaderProgram&&(t.deleteProgram(this.shaderProgram),this.shaderProgram=null),this.shaderProgramOff&&(t.deleteProgram(this.shaderProgramOff),this.shaderProgramOff=null)},St.prototype.compileShader=function(t,e){var i=this.gl,r=e,s=i.createShader(t);if(null==s)return l._$Ji("_$L0 to create shader"),null;if(i.shaderSource(s,r),i.compileShader(s),!i.getShaderParameter(s,i.COMPILE_STATUS)){var n=i.getShaderInfoLog(s);return l._$Ji("_$L0 to compile shader : "+n),i.deleteShader(s),null}return s},St.prototype.loadShaders2=function(){var t=this.gl;if(this.shaderProgram=t.createProgram(),!this.shaderProgram)return!1;if(this.shaderProgramOff=t.createProgram(),!this.shaderProgramOff)return!1;if(this.vertShader=this.compileShader(t.VERTEX_SHADER,"attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;varying vec4       v_ClipPos;uniform mat4       u_mvpMatrix;void main(){    gl_Position = u_mvpMatrix * a_position;    v_ClipPos = u_mvpMatrix * a_position;    v_texCoord = a_texCoord;}"),!this.vertShader)return l._$Ji("Vertex shader compile _$li!"),!1;if(this.vertShaderOff=this.compileShader(t.VERTEX_SHADER,"attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;varying vec4       v_ClipPos;uniform mat4       u_mvpMatrix;uniform mat4       u_ClipMatrix;void main(){    gl_Position = u_mvpMatrix * a_position;    v_ClipPos = u_ClipMatrix * a_position;    v_texCoord = a_texCoord ;}"),!this.vertShaderOff)return l._$Ji("OffVertex shader compile _$li!"),!1;if(this.fragShader=this.compileShader(t.FRAGMENT_SHADER,"precision mediump float;varying vec2       v_texCoord;varying vec4       v_ClipPos;uniform sampler2D  s_texture0;uniform vec4       u_channelFlag;uniform vec4       u_baseColor;uniform bool       u_maskFlag;void main(){    vec4 smpColor;     if(u_maskFlag){        float isInside =             step(u_baseColor.x, v_ClipPos.x/v_ClipPos.w)          * step(u_baseColor.y, v_ClipPos.y/v_ClipPos.w)          * step(v_ClipPos.x/v_ClipPos.w, u_baseColor.z)          * step(v_ClipPos.y/v_ClipPos.w, u_baseColor.w);        smpColor = u_channelFlag * texture2D(s_texture0 , v_texCoord).a * isInside;    }else{        smpColor = texture2D(s_texture0 , v_texCoord) * u_baseColor;    }    gl_FragColor = smpColor;}"),!this.fragShader)return l._$Ji("Fragment shader compile _$li!"),!1;if(this.fragShaderOff=this.compileShader(t.FRAGMENT_SHADER,"precision mediump float ;varying vec2       v_texCoord;varying vec4       v_ClipPos;uniform sampler2D  s_texture0;uniform sampler2D  s_texture1;uniform vec4       u_channelFlag;uniform vec4       u_baseColor ;void main(){    vec4 col_formask = texture2D(s_texture0, v_texCoord) * u_baseColor;    vec4 clipMask = texture2D(s_texture1, v_ClipPos.xy / v_ClipPos.w) * u_channelFlag;    float maskVal = clipMask.r + clipMask.g + clipMask.b + clipMask.a;    col_formask = col_formask * maskVal;    gl_FragColor = col_formask;}"),!this.fragShaderOff)return l._$Ji("OffFragment shader compile _$li!"),!1;if(t.attachShader(this.shaderProgram,this.vertShader),t.attachShader(this.shaderProgram,this.fragShader),t.attachShader(this.shaderProgramOff,this.vertShaderOff),t.attachShader(this.shaderProgramOff,this.fragShaderOff),t.linkProgram(this.shaderProgram),t.linkProgram(this.shaderProgramOff),!t.getProgramParameter(this.shaderProgram,t.LINK_STATUS)){var e=t.getProgramInfoLog(this.shaderProgram);return l._$Ji("_$L0 to link program: "+e),this.vertShader&&(t.deleteShader(this.vertShader),this.vertShader=0),this.fragShader&&(t.deleteShader(this.fragShader),this.fragShader=0),this.shaderProgram&&(t.deleteProgram(this.shaderProgram),this.shaderProgram=0),this.vertShaderOff&&(t.deleteShader(this.vertShaderOff),this.vertShaderOff=0),this.fragShaderOff&&(t.deleteShader(this.fragShaderOff),this.fragShaderOff=0),this.shaderProgramOff&&(t.deleteProgram(this.shaderProgramOff),this.shaderProgramOff=0),!1}return!0},St.prototype.createFramebuffer=function(){var t=this.gl,e=ht.clippingMaskBufferSize,i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i);var r=t.createRenderbuffer();t.bindRenderbuffer(t.RENDERBUFFER,r),t.renderbufferStorage(t.RENDERBUFFER,t.RGBA4,e,e),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,r);var s=t.createTexture();return t.bindTexture(t.TEXTURE_2D,s),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,e,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0),t.bindTexture(t.TEXTURE_2D,null),t.bindRenderbuffer(t.RENDERBUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null),ht.fTexture[this.glno]=s,{framebuffer:i,renderbuffer:r,texture:ht.fTexture[this.glno]}},Pt.prototype._$fP=function(){var t,e,i,r=this._$ST();if(0==(128&r))return 255&r;if(0==(128&(t=this._$ST())))return(127&r)<<7|127&t;if(0==(128&(e=this._$ST())))return(127&r)<<14|(127&t)<<7|255&e;if(0==(128&(i=this._$ST())))return(127&r)<<21|(127&t)<<14|(127&e)<<7|255&i;throw new _t("_$L _$0P  _")},Pt.prototype.getFormatVersion=function(){return this._$S2},Pt.prototype._$gr=function(t){this._$S2=t},Pt.prototype._$3L=function(){return this._$fP()},Pt.prototype._$mP=function(){return this._$zT(),this._$F+=8,this._$T.getFloat64(this._$F-8)},Pt.prototype._$_T=function(){return this._$zT(),this._$F+=4,this._$T.getFloat32(this._$F-4)},Pt.prototype._$6L=function(){return this._$zT(),this._$F+=4,this._$T.getInt32(this._$F-4)},Pt.prototype._$ST=function(){return this._$zT(),this._$T.getInt8(this._$F++)},Pt.prototype._$9T=function(){return this._$zT(),this._$F+=2,this._$T.getInt16(this._$F-2)},Pt.prototype._$2T=function(){throw this._$zT(),this._$F+=8,new _t("_$L _$q read long")},Pt.prototype._$po=function(){return this._$zT(),0!=this._$T.getInt8(this._$F++)};var Tt=!0;function Mt(){}function wt(t){e||(this._$e0=null,this._$IP=null,this._$Us=null,this._$7s=null,this._$IS=[!1],this._$VS=null,this._$AT=!0,this.baseOpacity=1,this.clipBufPre_clipContext=null,this._$e0=t)}function It(){}Pt.prototype._$bT=function(){this._$zT();var t=this._$3L(),e=null;if(Tt)try{var i=new ArrayBuffer(2*t);e=new Uint16Array(i);for(var r=0;r<t;++r)e[r]=this._$T.getUint8(this._$F++);return String.fromCharCode.apply(null,e)}catch(t){Tt=!1}try{var s=new Array;if(null==e)for(r=0;r<t;++r)s[r]=this._$T.getUint8(this._$F++);else for(r=0;r<t;++r)s[r]=e[r];return String.fromCharCode.apply(null,s)}catch(t){console.log("read utf8 / _$rT _$L0 !! : "+t)}},Pt.prototype._$cS=function(){this._$zT();for(var t=this._$3L(),e=new Int32Array(t),i=0;i<t;i++)e[i]=this._$T.getInt32(this._$F),this._$F+=4;return e},Pt.prototype._$Tb=function(){this._$zT();for(var t=this._$3L(),e=new Float32Array(t),i=0;i<t;i++)e[i]=this._$T.getFloat32(this._$F),this._$F+=4;return e},Pt.prototype._$5b=function(){this._$zT();for(var t=this._$3L(),e=new Float64Array(t),i=0;i<t;i++)e[i]=this._$T.getFloat64(this._$F),this._$F+=8;return e},Pt.prototype._$nP=function(){return this._$Jb(-1)},Pt.prototype._$Jb=function(t){if(this._$zT(),t<0&&(t=this._$3L()),t==U._$7P){var e=this._$6L();if(0<=e&&e<this._$Ko.length)return this._$Ko[e];throw new _t("_$sL _$4i @_$m0")}var i=this._$4b(t);return this._$Ko.push(i),i},Pt.prototype._$4b=function(t){if(0==t)return null;if(50==t){var e=this._$bT();return s=D.getID(e)}if(51==t){e=this._$bT();return s=yt.getID(e)}if(134==t){e=this._$bT();return s=_.getID(e)}if(60==t){e=this._$bT();return s=c.getID(e)}if(t>=48){var i=U._$9o(t);return null!=i?(i._$F0(this),i):null}switch(t){case 1:return this._$bT();case 10:return new o(this._$6L(),!0);case 11:return new P(this._$mP(),this._$mP(),this._$mP(),this._$mP());case 12:return new P(this._$_T(),this._$_T(),this._$_T(),this._$_T());case 13:return new M(this._$mP(),this._$mP());case 14:return new M(this._$_T(),this._$_T());case 15:for(var r=this._$3L(),s=new Array(r),n=0;n<r;n++)s[n]=this._$nP();return s;case 17:return s=new R(this._$mP(),this._$mP(),this._$mP(),this._$mP(),this._$mP(),this._$mP());case 21:return new u(this._$6L(),this._$6L(),this._$6L(),this._$6L());case 22:return new pt(this._$6L(),this._$6L());case 23:throw new Error("_$L _$ro ");case 16:case 25:return this._$cS();case 26:return this._$5b();case 27:return this._$Tb();case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 18:case 19:case 20:case 24:case 28:throw new _t("_$6 _$q : _$nP() of 2-9 ,18,19,20,24,28 : "+t);default:throw new _t("_$6 _$q : _$nP() NO _$i : "+t)}},Pt.prototype._$8L=function(){return 0==this._$hL?this._$v0=this._$ST():8==this._$hL&&(this._$v0=this._$ST(),this._$hL=0),1==(this._$v0>>7-this._$hL++&1)},Pt.prototype._$zT=function(){0!=this._$hL&&(this._$hL=0)},Mt._$2S=Math.PI/180,Mt._$bS=Math.PI/180,Mt._$wS=180/Math.PI,Mt._$NS=180/Math.PI,Mt.PI_F=Math.PI,Mt._$kT=[0,.012368,.024734,.037097,.049454,.061803,.074143,.086471,.098786,.111087,.12337,.135634,.147877,.160098,.172295,.184465,.196606,.208718,.220798,.232844,.244854,.256827,.268761,.280654,.292503,.304308,.316066,.327776,.339436,.351044,.362598,.374097,.385538,.396921,.408243,.419502,.430697,.441826,.452888,.463881,.474802,.485651,.496425,.507124,.517745,.528287,.538748,.549126,.559421,.56963,.579752,.589785,.599728,.609579,.619337,.629,.638567,.648036,.657406,.666676,.675843,.684908,.693867,.70272,.711466,.720103,.72863,.737045,.745348,.753536,.76161,.769566,.777405,.785125,.792725,.800204,.807561,.814793,.821901,.828884,.835739,.842467,.849066,.855535,.861873,.868079,.874153,.880093,.885898,.891567,.897101,.902497,.907754,.912873,.917853,.922692,.92739,.931946,.936359,.940629,.944755,.948737,.952574,.956265,.959809,.963207,.966457,.96956,.972514,.97532,.977976,.980482,.982839,.985045,.987101,.989006,.990759,.992361,.993811,.995109,.996254,.997248,.998088,.998776,.999312,.999694,.999924,1],Mt._$92=function(t,e){var i=Math.atan2(t[1],t[0]),r=Math.atan2(e[1],e[0]);return Mt._$tS(i,r)},Mt._$tS=function(t,e){for(var i=t-e;i<-Math.PI;)i+=2*Math.PI;for(;i>Math.PI;)i-=2*Math.PI;return i},Mt._$9=function(t){return Math.sin(t)},Mt.fcos=function(t){return Math.cos(t)},wt.prototype._$u2=function(){return this._$IS[0]},wt.prototype._$yo=function(){return this._$AT&&!this._$IS[0]},wt.prototype._$GT=function(){return this._$e0},It._$W2=0,It.SYSTEM_INFO=null,It.USER_AGENT=navigator.userAgent,It.isIPhone=function(){return It.SYSTEM_INFO||It.setup(),It.SYSTEM_INFO._isIPhone},It.isIOS=function(){return It.SYSTEM_INFO||It.setup(),It.SYSTEM_INFO._isIPhone||It.SYSTEM_INFO._isIPad},It.isAndroid=function(){return It.SYSTEM_INFO||It.setup(),It.SYSTEM_INFO._isAndroid},It.getOSVersion=function(){return It.SYSTEM_INFO||It.setup(),It.SYSTEM_INFO.version},It.getOS=function(){return It.SYSTEM_INFO||It.setup(),It.SYSTEM_INFO._isIPhone||It.SYSTEM_INFO._isIPad?"iOS":It.SYSTEM_INFO._isAndroid?"Android":"_$Q0 OS"},It.setup=function(){var t,e=It.USER_AGENT;function i(t,e){for(var i=t.substring(e).split(/[ _,;\.]/),r=0,s=0;s<=2&&!isNaN(i[s]);s++){var n=parseInt(i[s]);if(n<0||n>999){l._$li("err : "+n+" @UtHtml5.setup()"),r=0;break}r+=n*Math.pow(1e3,2-s)}return r}var r=It.SYSTEM_INFO={userAgent:e};if((t=e.indexOf("iPhone OS "))>=0)r.os="iPhone",r._isIPhone=!0,r.version=i(e,t+"iPhone OS ".length);else if((t=e.indexOf("iPad"))>=0){if((t=e.indexOf("CPU OS"))<0)return void l._$li(" err : "+e+" @UtHtml5.setup()");r.os="iPad",r._isIPad=!0,r.version=i(e,t+"CPU OS ".length)}else(t=e.indexOf("Android"))>=0?(r.os="Android",r._isAndroid=!0,r.version=i(e,t+"Android ".length)):(r.os="-",r.version=-1)},window.UtSystem=b,window.UtDebug=l,window.LDTransform=$t,window.LDGL=ot,window.Live2D=ht,window.Live2DModelWebGL=dt,window.Live2DModelJS=Q,window.Live2DMotion=Z,window.MotionQueueManager=ft,window.PhysicsHair=p,window.AMotion=a,window.PartsDataID=_,window.DrawDataID=D,window.BaseDataID=yt,window.ParamID=c,ht.init();e=!1}()}).call(this,i(74))},function(t,e){t.exports={import:function(){throw new Error("System.import cannot be used indirectly")}}},function(t,e){!function(){"use strict";if(!self.fetch){n.prototype.append=function(t,e){t=r(t),e=s(e);var i=this.map[t];i||(i=[],this.map[t]=i),i.push(e)},n.prototype.delete=function(t){delete this.map[r(t)]},n.prototype.get=function(t){var e=this.map[r(t)];return e?e[0]:null},n.prototype.getAll=function(t){return this.map[r(t)]||[]},n.prototype.has=function(t){return this.map.hasOwnProperty(r(t))},n.prototype.set=function(t,e){this.map[r(t)]=[s(e)]},n.prototype.forEach=function(t,e){Object.getOwnPropertyNames(this.map).forEach((function(i){this.map[i].forEach((function(r){t.call(e,r,i,this)}),this)}),this)};var t="FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(t){return!1}}(),e="FormData"in self,i=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];h.call(u.prototype),h.call(g.prototype),self.Headers=n,self.Request=u,self.Response=g,self.fetch=function(e,i){var r;return r=u.prototype.isPrototypeOf(e)&&!i?e:new u(e,i),new Promise((function(e,i){var s=new XMLHttpRequest;s.onload=function(){var t=1223===s.status?204:s.status;if(t<100||t>599)i(new TypeError("Network request failed"));else{var r={status:t,statusText:s.statusText,headers:c(s),url:"responseURL"in s?s.responseURL:/^X-Request-URL:/m.test(s.getAllResponseHeaders())?s.getResponseHeader("X-Request-URL"):void 0},n="response"in s?s.response:s.responseText;e(new g(n,r))}},s.onerror=function(){i(new TypeError("Network request failed"))},s.open(r.method,r.url,!0),"include"===r.credentials&&(s.withCredentials=!0),"responseType"in s&&t&&(s.responseType="blob"),r.headers.forEach((function(t,e){s.setRequestHeader(e,t)})),s.send(void 0===r._bodyInit?null:r._bodyInit)}))},self.fetch.polyfill=!0}function r(t){if("string"!=typeof t&&(t=t.toString()),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function s(t){return"string"!=typeof t&&(t=t.toString()),t}function n(t){this.map={},t instanceof n?t.forEach((function(t,e){this.append(e,t)}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function o(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function a(t){return new Promise((function(e,i){t.onload=function(){e(t.result)},t.onerror=function(){i(t.error)}}))}function l(t){var e=new FileReader;return e.readAsArrayBuffer(t),a(e)}function h(){return this.bodyUsed=!1,this._initBody=function(i){if(this._bodyInit=i,"string"==typeof i)this._bodyText=i;else if(t&&Blob.prototype.isPrototypeOf(i))this._bodyBlob=i;else if(e&&FormData.prototype.isPrototypeOf(i))this._bodyFormData=i;else{if(i)throw new Error("unsupported BodyInit type");this._bodyText=""}},t?(this.blob=function(){var t=o(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(l)},this.text=function(){var t,e,i=o(this);if(i)return i;if(this._bodyBlob)return t=this._bodyBlob,(e=new FileReader).readAsText(t),a(e);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var t=o(this);return t||Promise.resolve(this._bodyText)},e&&(this.formData=function(){return this.text().then(_)}),this.json=function(){return this.text().then(JSON.parse)},this}function u(t,e){var r,s;if(e=e||{},this.url=t,this.credentials=e.credentials||"omit",this.headers=new n(e.headers),this.method=(r=e.method||"GET",s=r.toUpperCase(),i.indexOf(s)>-1?s:r),this.mode=e.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&e.body)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(e.body)}function _(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var i=t.split("="),r=i.shift().replace(/\+/g," "),s=i.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(s))}})),e}function c(t){var e=new n;return t.getAllResponseHeaders().trim().split("\n").forEach((function(t){var i=t.trim().split(":"),r=i.shift().trim(),s=i.join(":").trim();e.append(r,s)})),e}function g(t,e){e||(e={}),this._initBody(t),this.type="default",this.url=null,this.status=e.status,this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText,this.headers=e.headers instanceof n?e.headers:new n(e.headers),this.url=e.url||""}}()},function(t,e,i){"use strict";i.r(e),i.d(e,"loadlive2dv3",(function(){return lr})),i.d(e,"screenshot",(function(){return hr}));i(73);var r,s=i(2);(r||(r={})).csmString=class{constructor(t){this.s=t}append(t,e){return this.s+=void 0!==e?t.substr(0,e):t,this}expansion(t,e){for(let i=0;i<t;i++)this.append(e);return this}getBytes(){return encodeURIComponent(this.s).replace(/%../g,"x").length}getLength(){return this.s.length}isLess(t){return this.s<t.s}isGreat(t){return this.s>t.s}isEqual(t){return this.s==t}isEmpty(){return 0==this.s.length}};const n=(t,e,i)=>{((t,e,i)=>{c.CubismDebug.print(t,"[CSM]"+e,i)})(t,e+"\n",i)},o=t=>{console.assert(t)};let a,l,h,u,_;var c,g,p;a=(t,...e)=>{n(C.LogLevel_Verbose,"[V]"+t,e)},l=(t,...e)=>{n(C.LogLevel_Debug,"[D]"+t,e)},h=(t,...e)=>{n(C.LogLevel_Info,"[I]"+t,e)},u=(t,...e)=>{n(C.LogLevel_Warning,"[W]"+t,e)},_=(t,...e)=>{n(C.LogLevel_Error,"[E]"+t,e)},function(t){t.CubismDebug=class{static print(t,e,i){if(t<I.CubismFramework.getLoggingLevel())return;const r=I.CubismFramework.coreLogFunction;if(!r)return;r(e.replace(/\{(\d+)\}/g,(t,e)=>i[e]))}static dumpBytes(t,e,i){for(let r=0;r<i;r++)r%16==0&&r>0?this.print(t,"\n"):r%8==0&&r>0&&this.print(t,"  "),this.print(t,"{0} ",[255&e[r]]);this.print(t,"\n")}constructor(){}}}(c||(c={})),function(t){class e{constructor(t,e){this.first=null==t?null:t,this.second=null==e?null:e}}t.csmPair=e;class i{constructor(t){null!=t?t<1?(this._keyValues=[],this._dummyValue=null,this._size=0):(this._keyValues=new Array(t),this._size=t):(this._keyValues=[],this._dummyValue=null,this._size=0)}release(){this.clear()}appendKey(t){this.prepareCapacity(this._size+1,!1),this._keyValues[this._size]=new e(t),this._size+=1}getValue(t){let e=-1;for(let i=0;i<this._size;i++)if(this._keyValues[i].first==t){e=i;break}return e>=0?this._keyValues[e].second:(this.appendKey(t),this._keyValues[this._size-1].second)}setValue(t,e){let i=-1;for(let e=0;e<this._size;e++)if(this._keyValues[e].first==t){i=e;break}i>=0?this._keyValues[i].second=e:(this.appendKey(t),this._keyValues[this._size-1].second=e)}isExist(t){for(let e=0;e<this._size;e++)if(this._keyValues[e].first==t)return!0;return!1}clear(){this._keyValues=void 0,this._keyValues=null,this._keyValues=[],this._size=0}getSize(){return this._size}prepareCapacity(t,e){t>this._keyValues.length&&(0==this._keyValues.length?(!e&&t<i.DefaultSize&&(t=i.DefaultSize),this._keyValues.length=t):(!e&&t<2*this._keyValues.length&&(t=2*this._keyValues.length),this._keyValues.length=t))}begin(){return new r(this,0)}end(){return new r(this,this._size)}erase(t){const e=t._index;if(e<0||this._size<=e)return t;this._keyValues.splice(e,1),--this._size;return new r(this,e)}dumpAsInt(){for(let t=0;t<this._size;t++)l("{0} ,",this._keyValues[t]),l("\n")}}i.DefaultSize=10,t.csmMap=i;class r{constructor(t,e){this._map=null!=t?t:new i,this._index=null!=e?e:0}set(t){return this._index=t._index,this._map=t._map,this}preIncrement(){return++this._index,this}preDecrement(){return--this._index,this}increment(){return new r(this._map,this._index++)}decrement(){const t=new r(this._map,this._index);return this._map=t._map,this._index=t._index,this}ptr(){return this._map._keyValues[this._index]}notEqual(t){return this._index!=t._index||this._map!=t._map}}t.iterator=r}(g||(g={})),function(t){class e{constructor(t=0){t<1?(this._ptr=[],this._capacity=0,this._size=0):(this._ptr=new Array(t),this._capacity=t,this._size=0)}at(t){return this._ptr[t]}set(t,e){this._ptr[t]=e}get(t=0){const e=new Array;for(let i=t;i<this._size;i++)e.push(this._ptr[i]);return e}pushBack(t){this._size>=this._capacity&&this.prepareCapacity(0==this._capacity?e.s_defaultSize:2*this._capacity),this._ptr[this._size++]=t}clear(){this._ptr.length=0,this._size=0}getSize(){return this._size}assign(t,e){this._size<t&&this.prepareCapacity(t);for(let i=0;i<t;i++)this._ptr[i]=e;this._size=t}resize(t,e=null){this.updateSize(t,e,!0)}updateSize(t,e=null,i=!0){if(this._size<t)if(this.prepareCapacity(t),i)for(let i=this._size;i<t;i++)this._ptr[i]="function"==typeof e?JSON.parse(JSON.stringify(new e)):e;else for(let i=this._size;i<t;i++)this._ptr[i]=e;else{const e=this._size-t;this._ptr.splice(this._size-e,e)}this._size=t}insert(t,e,i){let r=t._index;const s=e._index,n=i._index,o=n-s;this.prepareCapacity(this._size+o);const a=this._size-r;if(a>0)for(let t=0;t<a;t++)this._ptr.splice(r+t,0,null);for(let t=s;t<n;t++,r++)this._ptr[r]=e._vector._ptr[t];this._size=this._size+o}remove(t){return!(t<0||this._size<=t)&&(this._ptr.splice(t,1),--this._size,!0)}erase(t){const e=t._index;if(e<0||this._size<=e)return t;this._ptr.splice(e,1),--this._size;return new i(this,e)}prepareCapacity(t){t>this._capacity&&(0==this._capacity?(this._ptr=new Array(t),this._capacity=t):(this._ptr.length=t,this._capacity=t))}begin(){return 0==this._size?this.end():new i(this,0)}end(){return new i(this,this._size)}getOffset(t){const i=new e;return i._ptr=this.get(t),i._size=this.get(t).length,i._capacity=this.get(t).length,i}}e.s_defaultSize=10,t.csmVector=e;class i{constructor(t,e){this._vector=null!=t?t:null,this._index=null!=e?e:0}set(t){return this._index=t._index,this._vector=t._vector,this}preIncrement(){return++this._index,this}preDecrement(){return--this._index,this}increment(){return new i(this._vector,this._index++)}decrement(){return new i(this._vector,this._index--)}ptr(){return this._vector._ptr[this._index]}substitution(t){return this._index=t._index,this._vector=t._vector,this}notEqual(t){return this._index!=t._index||this._vector!=t._vector}}t.iterator=i}(p||(p={}));var d,f=p.csmVector,m=g.csmMap,$=r.csmString;!function(t){class e{constructor(){}getRawString(t,e){return this.getString(t,e)}toInt(t=0){return t}toFloat(t=0){return t}toBoolean(t=!1){return t}getSize(){return 0}getArray(t=null){return t}getVector(t){return t}getMap(t){return t}getValueByIndex(t){return e.errorValue.setErrorNotForClientCall("Error: type mismatch")}getValueByString(t){return e.nullValue.setErrorNotForClientCall("Error: type mismatch")}getKeys(){return e.s_dummyKeys}isError(){return!1}isNull(){return!1}isBool(){return!1}isFloat(){return!1}isString(){return!1}isArray(){return!1}isMap(){return!1}equals(t){return!1}isStatic(){return!1}setErrorNotForClientCall(t){return o.errorValue}static staticInitializeNotForClientCall(){s.trueValue=new s(!0),s.falseValue=new s(!1),o.errorValue=new o("ERROR",!0),this.nullValue=new a,e.s_dummyKeys=new f}static staticReleaseNotForClientCall(){s.trueValue=null,s.falseValue=null,o.errorValue=null,e.nullValue=null,e.s_dummyKeys=null,s.trueValue=null,s.falseValue=null,o.errorValue=null,e.nullValue=null,e.s_dummyKeys=null}}t.Value=e;class i{constructor(t,e){this._error=null,this._lineCount=0,this._root=null,null!=t&&this.parseBytes(t,e)}static create(t,e){const r=new i;return r.parseBytes(t,e)?r:(i.delete(r),null)}static delete(t){null}getRoot(){return this._root}arrayBufferToString(t){const e=new Uint8Array(t);let i="";for(let t=0,r=e.length;t<r;++t)i+="%"+this.pad(e[t].toString(16));return i=decodeURIComponent(i),i}pad(t){return t.length<2?"0"+t:t}parseBytes(t,e){const i=new Array(1),r=this.arrayBufferToString(t);if(this._root=this.parseValue(r,e,0,i),this._error){let t="\0";return t="Json parse error : @line "+(this._lineCount+1)+"\n",this._root=new n(t),h("{0}",this._root.getRawString()),!1}return null!=this._root||(this._root=new o(new $(this._error),!1),!1)}getParseError(){return this._error}checkEndOfFile(){return this._root.getArray()[1].equals("EOF")}parseValue(t,e,i,o){if(this._error)return null;let l,h=null,u=i;for(;u<e;u++){switch(t[u]){case"-":case".":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{const e=new Array(1);return l=B(t.slice(u),e),o[0]=t.indexOf(e[0]),new r(l)}case'"':return new n(this.parseString(t,e,u+1,o));case"[":return h=this.parseArray(t,e,u+1,o),h;case"{":return h=this.parseObject(t,e,u+1,o),h;case"n":return u+3<e?(h=new a,o[0]=u+4):this._error="parse null",h;case"t":return u+3<e?(h=s.trueValue,o[0]=u+4):this._error="parse true",h;case"f":return u+4<e?(h=s.falseValue,o[0]=u+5):this._error="illegal ',' position",h;case",":return this._error="illegal ',' position",null;case"]":return o[0]=u,null;case"\n":this._lineCount++}}return this._error="illegal end of value",null}parseString(t,e,i,r){if(this._error)return null;let s,n,o=i;const a=new $("");let l=i;for(;o<e;o++)switch(s=t[o],s){case'"':return r[0]=o+1,a.append(t.slice(l),o-l),a.s;case"//":if(o++,o-1>l&&a.append(t.slice(l),o-l),l=o+1,o<e)switch(n=t[o],n){case"\\":a.expansion(1,"\\");break;case'"':a.expansion(1,'"');break;case"/":a.expansion(1,"/");break;case"b":a.expansion(1,"\b");break;case"f":a.expansion(1,"\f");break;case"n":a.expansion(1,"\n");break;case"r":a.expansion(1,"\r");break;case"t":a.expansion(1,"\t");break;case"u":this._error="parse string/unicord escape not supported"}else this._error="parse string/escape error"}return this._error="parse string/illegal end",null}parseObject(t,e,i,r){if(this._error)return null;const s=new u;let n="",o=i,a="";const l=Array(1);let h=!1;for(;o<e;o++){t:for(;o<e;o++)switch(a=t[o],a){case'"':if(n=this.parseString(t,e,o+1,l),this._error)return null;o=l[0],h=!0;break t;case"}":return r[0]=o+1,s;case":":this._error="illegal ':' position";break;case"\n":this._lineCount++}if(!h)return this._error="key not found",null;h=!1;t:for(;o<e;o++)switch(a=t[o],a){case":":h=!0,o++;break t;case"}":this._error="illegal '}' position";break;case"\n":this._lineCount++}if(!h)return this._error="':' not found",null;const i=this.parseValue(t,e,o,l);if(this._error)return null;o=l[0],s.put(n,i);t:for(;o<e;o++)switch(a=t[o],a){case",":break t;case"}":return r[0]=o+1,s;case"\n":this._lineCount++}}return this._error="illegal end of perseObject",null}parseArray(t,e,i,r){if(this._error)return null;let s,n=new l,o=i;const a=new Array(1);for(;o<e;o++){const i=this.parseValue(t,e,o,a);if(this._error)return null;o=a[0],i&&n.add(i);t:for(;o<e;o++)switch(s=t[o],s){case",":break t;case"]":return r[0]=o+1,n;case"\n":++this._lineCount}}return n=void 0,this._error="illegal end of parseObject",null}}t.CubismJson=i;class r extends e{constructor(t){super(),this._value=t}isFloat(){return!0}getString(t,e){return this._value=parseFloat("\0"),this._stringBuffer="\0",this._stringBuffer}toInt(t=0){return parseInt(this._value.toString())}toFloat(t=0){return this._value}equals(t){return"number"==typeof t&&(!Math.round(t)&&t==this._value)}}t.JsonFloat=r;class s extends e{constructor(t){super(),this._boolValue=t}isBool(){return!0}toBoolean(t=!1){return this._boolValue}getString(t,e){return this._stringBuffer=this._boolValue?"true":"false",this._stringBuffer}equals(t){return"boolean"==typeof t&&t==this._boolValue}isStatic(){return!0}}t.JsonBoolean=s;class n extends e{constructor(t){super(),"string"==typeof t&&(this._stringBuffer=t),t instanceof $&&(this._stringBuffer=t.s)}isString(){return!0}getString(t,e){return this._stringBuffer}equals(t){return"string"==typeof t?this._stringBuffer==t:t instanceof $&&this._stringBuffer==t.s}}t.JsonString=n;class o extends n{constructor(t,e){super(t),this._isStatic=e}isStatic(){return this._isStatic}setErrorNotForClientCall(t){return this._stringBuffer=t,this}isError(){return!0}}t.JsonError=o;class a extends e{isNull(){return!0}getString(t,e){return this._stringBuffer}isStatic(){return!0}constructor(){super(),this._stringBuffer="NullValue"}}t.JsonNullvalue=a;class l extends e{constructor(){super(),this._array=new f}release(){for(let t=this._array.begin();t.notEqual(this._array.end());t.preIncrement()){let e=t.ptr();e&&!e.isStatic()&&(e=void 0,e=null)}}isArray(){return!0}getValueByIndex(t){if(t<0||this._array.getSize()<=t)return e.errorValue.setErrorNotForClientCall("Error: index out of bounds");const i=this._array.at(t);return null==i?e.nullValue:i}getValueByString(t){return e.errorValue.setErrorNotForClientCall("Error: type mismatch")}getString(t,e){const i=e+"[\n";for(let t=this._array.begin();t.notEqual(this._array.end());t.increment()){const i=t.ptr();this._stringBuffer+=e+""+i.getString(e+" ")+"\n"}return this._stringBuffer=i+e+"]\n",this._stringBuffer}add(t){this._array.pushBack(t)}getVector(t=null){return this._array}getSize(){return this._array.getSize()}}t.JsonArray=l;class u extends e{constructor(){super(),this._map=new m}release(){const t=this._map.begin();for(;t.notEqual(this._map.end());){let e=t.ptr().second;e&&!e.isStatic()&&(e=void 0,e=null),t.preIncrement()}}isMap(){return!0}getValueByString(t){if(t instanceof $){const i=this._map.getValue(t.s);return null==i?e.nullValue:i}for(let i=this._map.begin();i.notEqual(this._map.end());i.preIncrement())if(i.ptr().first==t)return null==i.ptr().second?e.nullValue:i.ptr().second;return e.nullValue}getValueByIndex(t){return e.errorValue.setErrorNotForClientCall("Error: type mismatch")}getString(t,e){this._stringBuffer=e+"{\n";const i=this._map.begin();for(;i.notEqual(this._map.end());){const t=i.ptr().first,r=i.ptr().second;this._stringBuffer+=e+" "+t+" : "+r.getString(e+"   ")+" \n",i.preIncrement()}return this._stringBuffer+=e+"}\n",this._stringBuffer}getMap(t){return this._map}put(t,e){this._map.setValue(t,e)}getKeys(){if(!this._keys){this._keys=new f;const t=this._map.begin();for(;t.notEqual(this._map.end());){const e=t.ptr().first;this._keys.pushBack(e),t.preIncrement()}}return this._keys}getSize(){return this._keys.getSize()}}t.JsonMap=u}(d||(d={}));var y,S=r.csmString;!function(t){class e{constructor(t){this._id="string"!=typeof t?t:new S(t)}getString(){return this._id}isEqual(t){return"string"==typeof t?this._id.isEqual(t):t instanceof S?this._id.isEqual(t.s):t instanceof e&&this._id.isEqual(t._id.s)}isNotEqual(t){return"string"==typeof t?!this._id.isEqual(t):t instanceof S?!this._id.isEqual(t.s):t instanceof e&&!this._id.isEqual(t._id.s)}}t.CubismId=e}(y||(y={}));var x,v,P=y.CubismId,T=p.csmVector;!function(t){t.CubismIdManager=class{constructor(){this._ids=new T}release(){for(let t=0;t<this._ids.getSize();++t)this._ids.set(t,void 0);this._ids=null}registerIds(t){for(let e=0;e<t.length;e++)this.registerId(t[e])}registerId(t){let e=null;return"string"!=typeof t?this.registerId(t.s):(null!=(e=this.findId(t))||(e=new P(t),this._ids.pushBack(e)),e)}getId(t){return this.registerId(t)}isExist(t){return"string"==typeof t?null!=this.findId(t):this.isExist(t.s)}findId(t){for(let e=0;e<this._ids.getSize();++e)if(this._ids.at(e).getString().isEqual(t))return this._ids.at(e);return null}}}(x||(x={})),function(t){class e{constructor(){this._tr=new Float32Array(16),this.loadIdentity()}static multiply(t,e,i){const r=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);for(let i=0;i<4;++i)for(let s=0;s<4;++s)for(let n=0;n<4;++n)r[s+4*i]+=t[n+4*i]*e[s+4*n];for(let t=0;t<16;++t)i[t]=r[t]}loadIdentity(){const t=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);this.setMatrix(t)}setMatrix(t){for(let e=0;e<16;++e)this._tr[e]=t[e]}getArray(){return this._tr}getScaleX(){return this._tr[0]}getScaleY(){return this._tr[5]}getTranslateX(){return this._tr[12]}getTranslateY(){return this._tr[13]}transformX(t){return this._tr[0]*t+this._tr[12]}transformY(t){return this._tr[5]*t+this._tr[13]}invertTransformX(t){return(t-this._tr[12])/this._tr[0]}invertTransformY(t){return(t-this._tr[13])/this._tr[5]}translateRelative(t,i){const r=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,t,i,0,1]);e.multiply(r,this._tr,this._tr)}translate(t,e){this._tr[12]=t,this._tr[13]=e}translateX(t){this._tr[12]=t}translateY(t){this._tr[13]=t}scaleRelative(t,i){const r=new Float32Array([t,0,0,0,0,i,0,0,0,0,1,0,0,0,0,1]);e.multiply(r,this._tr,this._tr)}scale(t,e){this._tr[0]=t,this._tr[5]=e}multiplyByMatrix(t){e.multiply(t.getArray(),this._tr,this._tr)}clone(){const t=new e;for(let e=0;e<this._tr.length;e++)t._tr[e]=this._tr[e];return t}}t.CubismMatrix44=e}(v||(v={}));var M,w=v.CubismMatrix44;!function(t){let e;t.CubismRenderer=class{constructor(){this._isCulling=!1,this._isPremultipliedAlpha=!1,this._anisortopy=0,this._model=null,this._modelColor=new i,this._mvpMatrix4x4=new w,this._mvpMatrix4x4.loadIdentity()}static create(){return null}static delete(t){null}initialize(t){this._model=t}drawModel(){null!=this.getModel()&&this.doDrawModel()}setMvpMatrix(t){this._mvpMatrix4x4.setMatrix(t.getArray())}getMvpMatrix(){return this._mvpMatrix4x4}setModelColor(t,e,i,r){t<0?t=0:t>1&&(t=1),e<0?e=0:e>1&&(e=1),i<0?i=0:i>1&&(i=1),r<0?r=0:r>1&&(r=1),this._modelColor.R=t,this._modelColor.G=e,this._modelColor.B=i,this._modelColor.A=r}getModelColor(){return JSON.parse(JSON.stringify(this._modelColor))}setIsPremultipliedAlpha(t){this._isPremultipliedAlpha=t}isPremultipliedAlpha(){return this._isPremultipliedAlpha}setIsCulling(t){this._isCulling=t}isCulling(){return this._isCulling}setAnisotropy(t){this._anisortopy=t}getAnisotropy(){return this._anisortopy}getModel(){return this._model}},function(t){t[t.CubismBlendMode_Normal=0]="CubismBlendMode_Normal",t[t.CubismBlendMode_Additive=1]="CubismBlendMode_Additive",t[t.CubismBlendMode_Multiplicative=2]="CubismBlendMode_Multiplicative"}(e=t.CubismBlendMode||(t.CubismBlendMode={}));class i{constructor(){this.R=1,this.G=1,this.B=1,this.A=1}}t.CubismTextureColor=i}(M||(M={}));var I,C,L=d.Value,b=x.CubismIdManager,E=M.CubismRenderer;function B(t,e){let i=0;for(let e=1;;e++){const r=t.slice(e-1,e);if("e"==r||"-"==r||"E"==r)continue;const s=t.substring(0,e),n=Number(s);if(isNaN(n))break;i=e}let r=parseFloat(t);return isNaN(r)&&(r=NaN),e[0]=t.slice(i),r}!function(t){let e,i=!1,r=!1,s=null,n=null;!function(t){t.vertexOffset=0,t.vertexStep=2}(e=t.Constant||(t.Constant={})),t.csmDelete=function(t){t&&(t=void 0)};t.CubismFramework=class{static startUp(t=null){if(i)return h("CubismFramework.startUp() is already done."),i;if(s=t,null!=s&&Live2DCubismCore.Logging.csmSetLogFunction(s.logFunction),i=!0,i){const t=Live2DCubismCore.Version.csmGetVersion(),e=(16711680&t)>>16,i=65535&t,r=t;h("Live2D Cubism Core version: {0}.{1}.{2} ({3})",("00"+((4278190080&t)>>24)).slice(-2),("00"+e).slice(-2),("0000"+i).slice(-4),r)}return h("CubismFramework.startUp() is complete."),i}static cleanUp(){i=!1,r=!1,s=null,n=null}static initialize(){o(i),i?r?u("CubismFramework.initialize() skipped, already initialized."):(L.staticInitializeNotForClientCall(),n=new b,r=!0,h("CubismFramework.initialize() is complete.")):u("CubismFramework is not started.")}static dispose(){o(i),i?r?(L.staticReleaseNotForClientCall(),n.release(),n=null,E.staticRelease(),r=!1,h("CubismFramework.dispose() is complete.")):u("CubismFramework.dispose() skipped, not initialized."):u("CubismFramework is not started.")}static isStarted(){return i}static isInitialized(){return r}static coreLogFunction(t){Live2DCubismCore.Logging.csmGetLogFunction()&&Live2DCubismCore.Logging.csmGetLogFunction()(t)}static getLoggingLevel(){return null!=s?s.loggingLevel:C.LogLevel_Off}static getIdManager(){return n}constructor(){}}}(I||(I={}));class A{}!function(t){t[t.LogLevel_Verbose=0]="LogLevel_Verbose",t[t.LogLevel_Debug=1]="LogLevel_Debug",t[t.LogLevel_Info=2]="LogLevel_Info",t[t.LogLevel_Warning=3]="LogLevel_Warning",t[t.LogLevel_Error=4]="LogLevel_Error",t[t.LogLevel_Off=5]="LogLevel_Off"}(C||(C={}));const F=C.LogLevel_Verbose;let D=void 0,R=void 0,V=void 0,O=void 0,N=void 0,k="";let U={};class z{loadBytes(t,e){if(void 0===U[t]){var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="arraybuffer",i.onload=function(){switch(i.status){case 200:U[t]=i.response,e(i.response);break;default:console.error("Failed to load ("+i.status+") : "+t)}},i.send(null)}else e(U[t])}loadString(t,e){this.loadBytes(t,(function(t){let i=(new d.CubismJson).arrayBufferToString(t);e(i)}))}loadLive2DModel(t,e){var i=null;this.loadBytes(t,(function(t){i=window.Live2DModelWebGL.loadModel(t),e(i)}))}loadTexture(t,e,i,r){var s=new Image;s.crossOrigin="Anonymous",s.src=i;s.onload=function(){var i=D,n=i.createTexture();if(!n)return console.error("Failed to generate gl texture name."),-1;0==t.isPremultipliedAlpha()&&i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,1),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,n),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,s),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR_MIPMAP_NEAREST),i.generateMipmap(i.TEXTURE_2D),t.setTexture(e,n),n=null,"function"==typeof r&&r()},s.onerror=function(){console.error("Failed to load image : "+i)}}jsonParseFromBytes(t){var e,i=new Uint8Array(t,0,3);return e=239==i[0]&&187==i[1]&&191==i[2]?String.fromCharCode.apply(null,new Uint8Array(t,3)):String.fromCharCode.apply(null,new Uint8Array(t)),JSON.parse(e)}log(t){}}class Y{constructor(){this.NAME="name",this.ID="id",this.MODEL="model",this.TEXTURES="textures",this.HIT_AREAS="hit_areas",this.PHYSICS="physics",this.POSE="pose",this.EXPRESSIONS="expressions",this.MOTION_GROUPS="motions",this.SOUND="sound",this.FADE_IN="fade_in",this.FADE_OUT="fade_out",this.LAYOUT="layout",this.HIT_AREAS_CUSTOM="hit_areas_custom",this.INIT_PARAM="init_param",this.INIT_PARTS_VISIBLE="init_parts_visible",this.VALUE="val",this.FILE="file",this.json={}}loadModelSetting(t,e){var i=this;s.Live2DFramework.getPlatformManager().loadBytes(t,(function(t){var r=String.fromCharCode.apply(null,new Uint8Array(t));i.json=JSON.parse(r),e()}))}getTextureFile(t){return null==this.json[this.TEXTURES]||null==this.json[this.TEXTURES][t]?null:this.json[this.TEXTURES][t]}getModelFile(){return this.json[this.MODEL]}getTextureNum(){return null==this.json[this.TEXTURES]?0:this.json[this.TEXTURES].length}getHitAreaNum(){return null==this.json[this.HIT_AREAS]?0:this.json[this.HIT_AREAS].length}getHitAreaID(t){return null==this.json[this.HIT_AREAS]||null==this.json[this.HIT_AREAS][t]?null:this.json[this.HIT_AREAS][t][this.ID]}getHitAreaName(t){return null==this.json[this.HIT_AREAS]||null==this.json[this.HIT_AREAS][t]?null:this.json[this.HIT_AREAS][t][this.NAME]}getPhysicsFile(){return this.json[this.PHYSICS]}getPoseFile(){return this.json[this.POSE]}getExpressionNum(){return null==this.json[this.EXPRESSIONS]?0:this.json[this.EXPRESSIONS].length}getExpressionFile(t){return null==this.json[this.EXPRESSIONS]?null:this.json[this.EXPRESSIONS][t][this.FILE]}getExpressionName(t){return null==this.json[this.EXPRESSIONS]?null:this.json[this.EXPRESSIONS][t][this.NAME]}getLayout(){return this.json[this.LAYOUT]}getHitAreasCustom(){return this.json[this.HIT_AREAS_CUSTOM]}getInitParamNum(){return null==this.json[this.INIT_PARAM]?0:this.json[this.INIT_PARAM].length}getMotionNum(t){return null==this.json[this.MOTION_GROUPS]||null==this.json[this.MOTION_GROUPS][t]?0:this.json[this.MOTION_GROUPS][t].length}getMotionFile(t,e){return null==this.json[this.MOTION_GROUPS]||null==this.json[this.MOTION_GROUPS][t]||null==this.json[this.MOTION_GROUPS][t][e]?null:this.json[this.MOTION_GROUPS][t][e][this.FILE]}getMotionSound(t,e){return null==this.json[this.MOTION_GROUPS]||null==this.json[this.MOTION_GROUPS][t]||null==this.json[this.MOTION_GROUPS][t][e]||null==this.json[this.MOTION_GROUPS][t][e][this.SOUND]?null:this.json[this.MOTION_GROUPS][t][e][this.SOUND]}getMotionFadeIn(t,e){return null==this.json[this.MOTION_GROUPS]||null==this.json[this.MOTION_GROUPS][t]||null==this.json[this.MOTION_GROUPS][t][e]||null==this.json[this.MOTION_GROUPS][t][e][this.FADE_IN]?1e3:this.json[this.MOTION_GROUPS][t][e][this.FADE_IN]}getMotionFadeOut(t,e){return null==this.json[this.MOTION_GROUPS]||null==this.json[this.MOTION_GROUPS][t]||null==this.json[this.MOTION_GROUPS][t][e]||null==this.json[this.MOTION_GROUPS][t][e][this.FADE_OUT]?1e3:this.json[this.MOTION_GROUPS][t][e][this.FADE_OUT]}getInitParamID(t){return null==this.json[this.INIT_PARAM]||null==this.json[this.INIT_PARAM][t]?null:this.json[this.INIT_PARAM][t][this.ID]}getInitParamValue(t){return null==this.json[this.INIT_PARAM]||null==this.json[this.INIT_PARAM][t]?NaN:this.json[this.INIT_PARAM][t][this.VALUE]}getInitPartsVisibleNum(){return null==this.json[this.INIT_PARTS_VISIBLE]?0:this.json[this.INIT_PARTS_VISIBLE].length}getInitPartsVisibleID(t){return null==this.json[this.INIT_PARTS_VISIBLE]||null==this.json[this.INIT_PARTS_VISIBLE][t]?null:this.json[this.INIT_PARTS_VISIBLE][t][this.ID]}getInitPartsVisibleValue(t){return null==this.json[this.INIT_PARTS_VISIBLE]||null==this.json[this.INIT_PARTS_VISIBLE][t]?NaN:this.json[this.INIT_PARTS_VISIBLE][t][this.VALUE]}}class G extends s.L2DBaseModel{constructor(){super(),s.L2DBaseModel.prototype.constructor.call(this),this.modelHomeDir="",this.modelSetting=null,this.tmpMatrix=[]}load(t,e,i){this.setUpdating(!0),this.setInitialized(!1),this.modelHomeDir=e.substring(0,e.lastIndexOf("/")+1),this.modelSetting=new Y;var r=this;this.modelSetting.loadModelSetting(e,(function(){var t=r.modelHomeDir+r.modelSetting.getModelFile();r.loadModelData(t,(function(t){for(var e=0;e<r.modelSetting.getTextureNum();e++){let t="";t=/^https?:\/\/|^\/\//i.test(r.modelSetting.getTextureFile(e))?r.modelSetting.getTextureFile(e):r.modelHomeDir+r.modelSetting.getTextureFile(e),r.loadTexture(e,t,(function(){if(r.isTexLoaded){if(r.modelSetting.getExpressionNum()>0){r.expressions={};for(var t=0;t<r.modelSetting.getExpressionNum();t++){var e=r.modelSetting.getExpressionName(t),s=r.modelHomeDir+r.modelSetting.getExpressionFile(t);r.loadExpression(e,s,null)}}else r.expressionManager=null,r.expressions={};if(r.eyeBlink,null!=r.modelSetting.getPhysicsFile()?r.loadPhysics(r.modelHomeDir+r.modelSetting.getPhysicsFile()):r.physics=null,null!=r.modelSetting.getPoseFile()?r.loadPose(r.modelHomeDir+r.modelSetting.getPoseFile(),(function(){r.pose.updateParam(r.live2DModel)})):r.pose=null,null!=r.modelSetting.getLayout()){var n=r.modelSetting.getLayout();null!=n.width&&r.modelMatrix.setWidth(n.width),null!=n.height&&r.modelMatrix.setHeight(n.height),null!=n.x&&r.modelMatrix.setX(n.x),null!=n.y&&r.modelMatrix.setY(n.y),null!=n.center_x&&r.modelMatrix.centerX(n.center_x),null!=n.center_y&&r.modelMatrix.centerY(n.center_y),null!=n.top&&r.modelMatrix.top(n.top),null!=n.bottom&&r.modelMatrix.bottom(n.bottom),null!=n.left&&r.modelMatrix.left(n.left),null!=n.right&&r.modelMatrix.right(n.right)}if(null!=r.modelSetting.getHitAreasCustom()){var o=r.modelSetting.getHitAreasCustom();null!=o.head_x&&(u=o.head_x,R=u),null!=o.head_y&&(h=o.head_y,V=h),null!=o.body_x&&(l=o.body_x,O=l),null!=o.body_y&&(a=o.body_y,N=a)}for(t=0;t<r.modelSetting.getInitParamNum();t++)r.live2DModel.setParamFloat(r.modelSetting.getInitParamID(t),r.modelSetting.getInitParamValue(t));for(t=0;t<r.modelSetting.getInitPartsVisibleNum();t++)r.live2DModel.setPartsOpacity(r.modelSetting.getInitPartsVisibleID(t),r.modelSetting.getInitPartsVisibleValue(t));r.live2DModel.saveParam(),r.preloadMotionGroup("Idle".toLowerCase()),r.preloadMotionGroup("sleepy"),r.mainMotionManager.stopAllMotions(),r.setUpdating(!1),r.setInitialized(!0),"function"==typeof i&&i()}var a,l,h,u}))}}))}))}release(t){let e=s.Live2DFramework.getPlatformManager();t.deleteTexture(e.texture)}preloadMotionGroup(t){for(var e=this,i=0;i<this.modelSetting.getMotionNum(t);i++){var r=this.modelSetting.getMotionFile(t,i);this.loadMotion(r,this.modelHomeDir+r,(function(r){r.setFadeIn(e.modelSetting.getMotionFadeIn(t,i)),r.setFadeOut(e.modelSetting.getMotionFadeOut(t,i))}))}}update(){if(null!=this.live2DModel){var t=2*((window.UtSystem.getUserTimeMSec()-this.startTimeMSec)/1e3)*Math.PI;if(this.mainMotionManager.isFinished())"1"===sessionStorage.getItem("Sleepy")?this.startRandomMotion("sleepy",2):this.startRandomMotion("Idle".toLowerCase(),1);this.live2DModel.loadParam(),this.mainMotionManager.updateParam(this.live2DModel)||null!=this.eyeBlink&&this.eyeBlink.updateParam(this.live2DModel),this.live2DModel.saveParam(),null==this.expressionManager||null==this.expressions||this.expressionManager.isFinished()||this.expressionManager.updateParam(this.live2DModel),this.live2DModel.addToParamFloat("PARAM_ANGLE_X",30*this.dragX,1),this.live2DModel.addToParamFloat("PARAM_ANGLE_Y",30*this.dragY,1),this.live2DModel.addToParamFloat("PARAM_ANGLE_Z",this.dragX*this.dragY*-30,1),this.live2DModel.addToParamFloat("PARAM_BODY_ANGLE_X",10*this.dragX,1),this.live2DModel.addToParamFloat("PARAM_EYE_BALL_X",this.dragX,1),this.live2DModel.addToParamFloat("PARAM_EYE_BALL_Y",this.dragY,1),this.live2DModel.addToParamFloat("PARAM_ANGLE_X",Number(15*Math.sin(t/6.5345)),.5),this.live2DModel.addToParamFloat("PARAM_ANGLE_Y",Number(8*Math.sin(t/3.5345)),.5),this.live2DModel.addToParamFloat("PARAM_ANGLE_Z",Number(10*Math.sin(t/5.5345)),.5),this.live2DModel.addToParamFloat("PARAM_BODY_ANGLE_X",Number(4*Math.sin(t/15.5345)),.5),this.live2DModel.setParamFloat("PARAM_BREATH",Number(.5+.5*Math.sin(t/3.2345)),1),null!=this.physics&&this.physics.updateParam(this.live2DModel),null==this.lipSync&&this.live2DModel.setParamFloat("PARAM_MOUTH_OPEN_Y",this.lipSyncValue),null!=this.pose&&this.pose.updateParam(this.live2DModel),this.live2DModel.update()}}setRandomExpression(){var t=[];for(var e in this.expressions)t.push(e);var i=parseInt((Math.random()*t.length).toString());this.setExpression(t[i])}startRandomMotion(t,e){var i=this.modelSetting.getMotionNum(t),r=parseInt((Math.random()*i).toString());this.startMotion(t,r,e)}startMotion(t,e,i){var r=this.modelSetting.getMotionFile(t,e);if(null!=r&&""!=r){if(3==i)this.mainMotionManager.setReservePriority(i);else if(!this.mainMotionManager.reserveMotion(i))return void 0;var s,n=this;null==this.motions[t]?this.loadMotion(null,this.modelHomeDir+r,(function(r){s=r,n.setFadeInFadeOut(t,e,i,s)})):(s=this.motions[t],n.setFadeInFadeOut(t,e,i,s))}}setFadeInFadeOut(t,e,i,r){this.modelSetting.getMotionFile(t,e);if(r.setFadeIn(this.modelSetting.getMotionFadeIn(t,e)),r.setFadeOut(this.modelSetting.getMotionFadeOut(t,e)),null==this.modelSetting.getMotionSound(t,e))this.mainMotionManager.startMotionPrio(r,i);else{var s=this.modelSetting.getMotionSound(t,e),n=document.createElement("audio");n.src=this.modelHomeDir+s,n.play(),this.mainMotionManager.startMotionPrio(r,i)}}setExpression(t){var e=this.expressions[t];this.expressionManager.startMotion(e,!1)}draw(t){t.multMatrix(this.modelMatrix.getArray()),this.tmpMatrix=t.getMatrix(),this.live2DModel.setMatrix(this.tmpMatrix),this.live2DModel.draw()}hitTest(t,e,i){for(var r=this.modelSetting.getHitAreaNum(),s=0;s<r;s++)if(t==this.modelSetting.getHitAreaName(s)){var n=this.modelSetting.getHitAreaID(s);return this.hitTestSimple(n,e,i)}return!1}hitTestCustom(t,e,i){return"head"==t?this.hitTestSimpleCustom(R,V,e,i):"body"==t&&this.hitTestSimpleCustom(O,N,e,i)}}class X{constructor(){this.depth=0,this.matrixStack=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.currentMatrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.tmp=new Array(16)}reset(){this.depth=0}loadIdentity(){for(var t=0;t<16;t++)this.currentMatrix[t]=t%5==0?1:0}push(){this.depth;let t=16*(this.depth+1);this.matrixStack.length<t+16&&(this.matrixStack.length=t+16);for(let e=0;e<16;e++)this.matrixStack[t+e]=this.currentMatrix[e];this.depth++}pop(){this.depth--,this.depth<0&&(console.log("Invalid matrix stack. 无效的矩阵堆栈"),this.depth=0);let t=16*this.depth;for(let e=0;e<16;e++)this.currentMatrix[e]=this.matrixStack[t+e]}getMatrix(){return this.currentMatrix}multMatrix(t){let e,i,r;for(e=0;e<16;e++)this.tmp[e]=0;for(e=0;e<4;e++)for(i=0;i<4;i++)for(r=0;r<4;r++)this.tmp[e+4*i]+=this.currentMatrix[e+4*r]*t[r+4*i];for(e=0;e<16;e++)this.currentMatrix[e]=this.tmp[e]}}var j,H,q=v.CubismMatrix44;!function(t){t.CubismViewMatrix=class extends q{constructor(){super(),this._screenLeft=0,this._screenRight=0,this._screenTop=0,this._screenBottom=0,this._maxLeft=0,this._maxRight=0,this._maxTop=0,this._maxBottom=0,this._maxScale=0,this._minScale=0}adjustTranslate(t,e){this._tr[0]*this._maxLeft+(this._tr[12]+t)>this._screenLeft&&(t=this._screenLeft-this._tr[0]*this._maxLeft-this._tr[12]),this._tr[0]*this._maxRight+(this._tr[12]+t)<this._screenRight&&(t=this._screenRight-this._tr[0]*this._maxRight-this._tr[12]),this._tr[5]*this._maxTop+(this._tr[13]+e)<this._screenTop&&(e=this._screenTop-this._tr[5]*this._maxTop-this._tr[13]),this._tr[5]*this._maxBottom+(this._tr[13]+e)>this._screenBottom&&(e=this._screenBottom-this._tr[5]*this._maxBottom-this._tr[13]);const i=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,t,e,0,1]);q.multiply(i,this._tr,this._tr)}adjustScale(t,e,i){const r=this.getMaxScale(),s=this.getMinScale(),n=i*this._tr[0];n<s?this._tr[0]>0&&(i=s/this._tr[0]):n>r&&this._tr[0]>0&&(i=r/this._tr[0]);const o=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,t,e,0,1]),a=new Float32Array([i,0,0,0,0,i,0,0,0,0,1,0,0,0,0,1]),l=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,-t,-e,0,1]);q.multiply(l,this._tr,this._tr),q.multiply(a,this._tr,this._tr),q.multiply(o,this._tr,this._tr)}setScreenRect(t,e,i,r){this._screenLeft=t,this._screenRight=e,this._screenBottom=i,this._screenTop=r}setMaxScreenRect(t,e,i,r){this._maxLeft=t,this._maxRight=e,this._maxTop=r,this._maxBottom=i}setMaxScale(t){this._maxScale=t}setMinScale(t){this._minScale=t}getMaxScale(){return this._maxScale}getMinScale(){return this._minScale}isMaxScale(){return this.getScaleX()>=this._maxScale}isMinScale(){return this.getScaleX()<=this._minScale}getScreenLeft(){return this._screenLeft}getScreenRight(){return this._screenRight}getScreenBottom(){return this._screenBottom}getScreenTop(){return this._screenTop}getMaxLeft(){return this._maxLeft}getMaxRight(){return this._maxRight}getMaxBottom(){return this._maxBottom}getMaxTop(){return this._maxTop}}}(j||(j={}));class W{constructor(){this._startX=0,this._startY=0,this._lastX=0,this._lastY=0,this._lastX1=0,this._lastY1=0,this._lastX2=0,this._lastY2=0,this._lastTouchDistance=0,this._deltaX=0,this._deltaY=0,this._scale=1,this._touchSingle=!1,this._flipAvailable=!1}getCenterX(){return this._lastX}getCenterY(){return this._lastY}getDeltaX(){return this._deltaX}getDeltaY(){return this._deltaY}getStartX(){return this._startX}getStartY(){return this._startY}getScale(){return this._scale}getX(){return this._lastX}getY(){return this._lastY}getX1(){return this._lastX1}getY1(){return this._lastY1}getX2(){return this._lastX2}getY2(){return this._lastY2}isSingleTouch(){return this._touchSingle}isFlickAvailable(){return this._flipAvailable}disableFlick(){this._flipAvailable=!1}touchesBegan(t,e){this._lastX=t,this._lastY=e,this._startX=t,this._startY=e,this._lastTouchDistance=-1,this._flipAvailable=!0,this._touchSingle=!0}touchesMoved(t,e){this._lastX=t,this._lastY=e,this._lastTouchDistance=-1,this._touchSingle=!0}getFlickDistance(){return this.calculateDistance(this._startX,this._startY,this._lastX,this._lastY)}calculateDistance(t,e,i,r){return Math.sqrt((t-i)*(t-i)+(e-r)*(e-r))}calculateMovingAmount(t,e){if(t>0!=e>0)return 0;const i=t>0?1:-1,r=Math.abs(t),s=Math.abs(e);return i*(r<s?r:s)}}!function(t){class e{constructor(t,e){this.x=t,this.y=e,this.x=null==t?0:t,this.y=null==e?0:e}add(t){const i=new e(0,0);return i.x=this.x+t.x,i.y=this.y+t.y,i}substract(t){const i=new e(0,0);return i.x=this.x-t.x,i.y=this.y-t.y,i}multiply(t){const i=new e(0,0);return i.x=this.x*t.x,i.y=this.y*t.y,i}multiplyByScaler(t){return this.multiply(new e(t,t))}division(t){const i=new e(0,0);return i.x=this.x/t.x,i.y=this.y/t.y,i}divisionByScalar(t){return this.division(new e(t,t))}getLength(){return Math.sqrt(this.x*this.x+this.y*this.y)}getDistanceWith(t){return Math.sqrt((this.x-t.x)*(this.x-t.x)+(this.y-t.y)*(this.y-t.y))}dot(t){return this.x*t.x+this.y*t.y}normalize(){const t=Math.pow(this.x*this.x+this.y*this.y,.5);this.x=this.x/t,this.y=this.y/t}isEqual(t){return this.x==t.x&&this.y==t.y}isNotEqual(t){return!this.isEqual(t)}}t.CubismVector2=e}(H||(H={}));var J,Q=H.CubismVector2;!function(t){t.CubismMath=class{static range(t,e,i){return t<e?t=e:t>i&&(t=i),t}static sin(t){return Math.sin(t)}static cos(t){return Math.cos(t)}static abs(t){return Math.abs(t)}static sqrt(t){return Math.sqrt(t)}static getEasingSine(t){return t<0?0:t>1?1:.5-.5*this.cos(t*Math.PI)}static max(t,e){return t>e?t:e}static min(t,e){return t>e?e:t}static degreesToRadian(t){return t/180*Math.PI}static radianToDegrees(t){return 180*t/Math.PI}static directionToRadian(t,e){let i=Math.atan2(e.y,e.x)-Math.atan2(t.y,t.x);for(;i<-Math.PI;)i+=2*Math.PI;for(;i>Math.PI;)i-=2*Math.PI;return i}static directionToDegrees(t,e){const i=this.directionToRadian(t,e);let r=this.radianToDegrees(i);return e.x-t.x>0&&(r=-r),r}static radianToDirection(t){const e=new Q;return e.x=this.sin(t),e.y=this.cos(t),e}constructor(){}}}(J||(J={}));var Z,K=p.csmVector,tt=J.CubismMath;!function(t){t.ACubismMotion=class{constructor(){this.setFinishedMotionHandler=t=>this._onFinishedMotion=t,this.getFinishedMotionHandler=()=>this._onFinishedMotion,this._fadeInSeconds=-1,this._fadeOutSeconds=-1,this._weight=1,this._offsetSeconds=0,this._firedEventValues=new K}static delete(t){t.release(),t=void 0,t=null}release(){this._weight=0}updateParameters(t,e,i){if(!e.isAvailable()||e.isFinished())return;if(!e.isStarted()){e.setIsStarted(!0),e.setStartTime(i-this._offsetSeconds),e.setFadeInStartTime(i);const t=this.getDuration();e.getEndTime()<0&&e.setEndTime(t<=0?-1:e.getStartTime()+t)}let r=this._weight;r=r*(0==this._fadeInSeconds?1:tt.getEasingSine((i-e.getFadeInStartTime())/this._fadeInSeconds))*(0==this._fadeOutSeconds||e.getEndTime()<0?1:tt.getEasingSine((e.getEndTime()-i)/this._fadeOutSeconds)),e.setState(i,r),o(0<=r&&r<=1),this.doUpdateParameters(t,i,r,e),e.getEndTime()>0&&e.getEndTime()<i&&e.setIsFinished(!0)}setFadeInTime(t){this._fadeInSeconds=t}setFadeOutTime(t){this._fadeOutSeconds=t}getFadeOutTime(){return this._fadeOutSeconds}getFadeInTime(){return this._fadeInSeconds}setWeight(t){this._weight=t}getWeight(){return this._weight}getDuration(){return-1}getLoopDuration(){return-1}setOffsetTime(t){this._offsetSeconds=t}getFiredEvent(t,e){return this._firedEventValues}}}(Z||(Z={}));var et,it=Z.ACubismMotion;!function(t){t.CubismMotionQueueEntry=class{constructor(){this._autoDelete=!1,this._motion=null,this._available=!0,this._finished=!1,this._started=!1,this._startTimeSeconds=-1,this._fadeInStartTimeSeconds=0,this._endTimeSeconds=-1,this._stateTimeSeconds=0,this._stateWeight=0,this._lastEventCheckSeconds=0,this._motionQueueEntryHandle=this,this._fadeOutSeconds=0,this._isTriggeredFadeOut=!1}release(){this._autoDelete&&this._motion&&it.delete(this._motion)}setFadeOut(t){this._fadeOutSeconds=t,this._isTriggeredFadeOut=!0}startFadeOut(t,e){const i=e+t;this._isTriggeredFadeOut=!0,(this._endTimeSeconds<0||i<this._endTimeSeconds)&&(this._endTimeSeconds=i)}isFinished(){return this._finished}isStarted(){return this._started}getStartTime(){return this._startTimeSeconds}getFadeInStartTime(){return this._fadeInStartTimeSeconds}getEndTime(){return this._endTimeSeconds}setStartTime(t){this._startTimeSeconds=t}setFadeInStartTime(t){this._fadeInStartTimeSeconds=t}setEndTime(t){this._endTimeSeconds=t}setIsFinished(t){this._finished=t}setIsStarted(t){this._started=t}isAvailable(){return this._available}setIsAvailable(t){this._available=t}setState(t,e){this._stateTimeSeconds=t,this._stateWeight=e}getStateTime(){return this._stateTimeSeconds}getStateWeight(){return this._stateWeight}getLastCheckEventSeconds(){return this._lastEventCheckSeconds}setLastCheckEventSeconds(t){this._lastEventCheckSeconds=t}isTriggeredFadeOut(){return this._isTriggeredFadeOut&&this._endTimeSeconds<0}getFadeOutSeconds(){return this._fadeOutSeconds}}}(et||(et={}));var rt,st=p.csmVector,nt=et.CubismMotionQueueEntry;!function(t){t.CubismMotionQueueManager=class{constructor(){this._userTimeSeconds=0,this._eventCallBack=null,this._eventCustomData=null,this._motions=new st}release(){for(let t=0;t<this._motions.getSize();++t)this._motions.at(t)&&(this._motions.at(t).release(),this._motions.set(t,void 0),this._motions.set(t,null));this._motions=null}startMotion(e,i,r){if(null==e)return t.InvalidMotionQueueEntryHandleValue;let s=null;for(let t=0;t<this._motions.getSize();++t)s=this._motions.at(t),null!=s&&s.setFadeOut(s._motion.getFadeOutTime());return s=new nt,s._autoDelete=i,s._motion=e,this._motions.pushBack(s),s._motionQueueEntryHandle}isFinished(){for(let t=this._motions.begin();t.notEqual(this._motions.end());){let e=t.ptr();if(null==e){t=this._motions.erase(t);continue}if(null!=e._motion){if(!e.isFinished())return!1;t.preIncrement()}else e.release(),e=void 0,e=null,t=this._motions.erase(t)}return!0}isFinishedByHandle(t){for(let e=this._motions.begin();e.notEqual(this._motions.end());e.increment()){const i=e.ptr();if(null!=i&&(i._motionQueueEntryHandle==t&&!i.isFinished()))return!1}return!0}stopAllMotions(){for(let t=this._motions.begin();t.notEqual(this._motions.end());){let e=t.ptr();null!=e?(e.release(),e=void 0,e=null,t=this._motions.erase(t)):t=this._motions.erase(t)}}getCubismMotionQueueEntry(t){for(let e=this._motions.begin();e.notEqual(this._motions.end());e.preIncrement()){const i=e.ptr();if(null!=i&&i._motionQueueEntryHandle==t)return i}return null}setEventCallback(t,e=null){this._eventCallBack=t,this._eventCustomData=e}doUpdateMotion(t,e){let i=!1;for(let r=this._motions.begin();r.notEqual(this._motions.end());){let s=r.ptr();if(null==s){r=this._motions.erase(r);continue}const n=s._motion;if(null==n){s.release(),s=void 0,s=null,r=this._motions.erase(r);continue}n.updateParameters(t,s,e),i=!0;const o=n.getFiredEvent(s.getLastCheckEventSeconds()-s.getStartTime(),e-s.getStartTime());for(let t=0;t<o.getSize();++t)this._eventCallBack(this,o.at(t),this._eventCustomData);s.setLastCheckEventSeconds(e),s.isFinished()?(s.release(),s=void 0,s=null,r=this._motions.erase(r)):(s.isTriggeredFadeOut()&&s.startFadeOut(s.getFadeOutSeconds(),e),r.preIncrement())}return i}},t.InvalidMotionQueueEntryHandleValue=-1}(rt||(rt={}));var ot,at=rt.CubismMotionQueueManager;!function(t){t.CubismMotionManager=class extends at{constructor(){super(),this._currentPriority=0,this._reservePriority=0}getCurrentPriority(){return this._currentPriority}getReservePriority(){return this._reservePriority}setReservePriority(t){this._reservePriority=t}startMotionPriority(t,e,i){return i==this._reservePriority&&(this._reservePriority=0),this._currentPriority=i,super.startMotion(t,e,this._userTimeSeconds)}updateMotion(t,e){this._userTimeSeconds+=e;const i=super.doUpdateMotion(t,this._userTimeSeconds);return this.isFinished()&&(this._currentPriority=0),i}reserveMotion(t){return!(t<=this._reservePriority||t<=this._currentPriority)&&(this._reservePriority=t,!0)}}}(ot||(ot={}));var lt,ht=J.CubismMath;!function(t){t.CubismTargetPoint=class{constructor(){this._faceTargetX=0,this._faceTargetY=0,this._faceX=0,this._faceY=0,this._faceVX=0,this._faceVY=0,this._lastTimeSeconds=0,this._userTimeSeconds=0}update(t){this._userTimeSeconds+=t;if(0==this._lastTimeSeconds)return void(this._lastTimeSeconds=this._userTimeSeconds);const e=30*(this._userTimeSeconds-this._lastTimeSeconds);this._lastTimeSeconds=this._userTimeSeconds;const i=e*(4/30)/4.5,r=this._faceTargetX-this._faceX,s=this._faceTargetY-this._faceY;if(ht.abs(r)<=.01&&ht.abs(s)<=.01)return;const n=ht.sqrt(r*r+s*s),o=4/30*s/n;let a=4/30*r/n-this._faceVX,l=o-this._faceVY;const h=ht.sqrt(a*a+l*l);(h<-i||h>i)&&(a*=i/h,l*=i/h),this._faceVX+=a,this._faceVY+=l;{const t=.5*(ht.sqrt(i*i+16*i*n-8*i*n)-i),e=ht.sqrt(this._faceVX*this._faceVX+this._faceVY*this._faceVY);e>t&&(this._faceVX*=t/e,this._faceVY*=t/e)}this._faceX+=this._faceVX,this._faceY+=this._faceVY}getX(){return this._faceX}getY(){return this._faceY}set(t,e){this._faceTargetX=t,this._faceTargetY=e}}}(lt||(lt={}));var ut,_t=v.CubismMatrix44;!function(t){t.CubismModelMatrix=class extends _t{constructor(t,e,i=1){super(),this._width=void 0!==t?t:0,this._height=void 0!==e?e:0,this.setHeight(i)}setWidth(t){const e=t/this._width,i=e;this.scale(e,i)}setHeight(t){const e=t/this._height,i=e;this.scale(e,i)}setPosition(t,e){this.translate(t,e)}setCenterPosition(t,e){this.centerX(t),this.centerY(e)}top(t){this.setY(t)}bottom(t){const e=this._height*this.getScaleY();this.translateY(t-e)}left(t){this.setX(t)}right(t){const e=this._width*this.getScaleX();this.translateX(t-e)}centerX(t){const e=this._width*this.getScaleX();this.translateX(t-e/2)}setX(t){this.translateX(t)}centerY(t){const e=this._height*this.getScaleY();this.translateY(t-e/2)}setY(t){this.translateY(t)}setupFromLayout(t){for(const e=t.begin();e.notEqual(t.end());e.preIncrement()){const t=e.ptr().first,i=e.ptr().second;"width"==t?this.setWidth(i):"height"==t&&this.setHeight(i)}for(const e=t.begin();e.notEqual(t.end());e.preIncrement()){const t=e.ptr().first,i=e.ptr().second;"x"==t?this.setX(i):"y"==t?this.setY(i):"center_x"==t?this.centerX(i):"center_y"==t?this.centerY(i):"top"==t?this.top(i):"bottom"==t?this.bottom(i):"left"==t?this.left(i):"right"==t&&this.right(i)}}}}(ut||(ut={}));var ct,gt=I.CubismFramework,pt=M.CubismBlendMode,dt=p.csmVector,ft=g.csmMap;!function(t){t.CubismModel=class{constructor(t){this._model=t,this._parameterValues=null,this._parameterMaximumValues=null,this._parameterMinimumValues=null,this._partOpacities=null,this._savedParameters=new dt,this._parameterIds=new dt,this._drawableIds=new dt,this._partIds=new dt,this._notExistPartId=new ft,this._notExistParameterId=new ft,this._notExistParameterValues=new ft,this._notExistPartOpacities=new ft}update(){this._model.update(),this._model.drawables.resetDynamicFlags()}getCanvasWidth(){return null==this._model?0:this._model.canvasinfo.CanvasWidth/this._model.canvasinfo.PixelsPerUnit}getCanvasHeight(){return null==this._model?0:this._model.canvasinfo.CanvasHeight/this._model.canvasinfo.PixelsPerUnit}saveParameters(){const t=this._model.parameters.count,e=this._savedParameters.getSize();for(let i=0;i<t;++i)i<e?this._savedParameters.set(i,this._parameterValues[i]):this._savedParameters.pushBack(this._parameterValues[i])}getModel(){return this._model}getPartIndex(t){let e;const i=this._model.parts.count;for(e=0;e<i;++e)if(t==this._partIds.at(e))return e;return this._notExistPartId.isExist(t)?this._notExistPartId.getValue(t):(e=i+this._notExistPartId.getSize(),this._notExistPartId.setValue(t,e),this._notExistPartOpacities.appendKey(e),e)}getPartCount(){return this._model.parts.count}setPartOpacityByIndex(t,e){this._notExistPartOpacities.isExist(t)?this._notExistPartOpacities.setValue(t,e):(o(0<=t&&t<this.getPartCount()),this._partOpacities[t]=e)}setPartOpacityById(t,e){const i=this.getPartIndex(t);i<0||this.setPartOpacityByIndex(i,e)}getPartOpacityByIndex(t){return this._notExistPartOpacities.isExist(t)?this._notExistPartOpacities.getValue(t):(o(0<=t&&t<this.getPartCount()),this._partOpacities[t])}getPartOpacityById(t){const e=this.getPartIndex(t);return e<0?0:this.getPartOpacityByIndex(e)}getParameterIndex(t){let e;const i=this._model.parameters.count;for(e=0;e<i;++e)if(t==this._parameterIds.at(e))return e;return this._notExistParameterId.isExist(t)?this._notExistParameterId.getValue(t):(e=this._model.parameters.count+this._notExistParameterId.getSize(),this._notExistParameterId.setValue(t,e),this._notExistParameterValues.appendKey(e),e)}getParameterCount(){return this._model.parameters.count}getParameterMaximumValue(t){return this._model.parameters.maximumValues[t]}getParameterMinimumValue(t){return this._model.parameters.minimumValues[t]}getParameterDefaultValue(t){return this._model.parameters.defaultValues[t]}getParameterValueByIndex(t){return this._notExistParameterValues.isExist(t)?this._notExistParameterValues.getValue(t):(o(0<=t&&t<this.getParameterCount()),this._parameterValues[t])}getParameterValueById(t){const e=this.getParameterIndex(t);return this.getParameterValueByIndex(e)}setParameterValueByIndex(t,e,i=1){this._notExistParameterValues.isExist(t)?this._notExistParameterValues.setValue(t,1==i?e:this._notExistParameterValues.getValue(t)*(1-i)+e*i):(o(0<=t&&t<this.getParameterCount()),this._model.parameters.maximumValues[t]<e&&(e=this._model.parameters.maximumValues[t]),this._model.parameters.minimumValues[t]>e&&(e=this._model.parameters.minimumValues[t]),this._parameterValues[t]=1==i?e:this._parameterValues[t]=this._parameterValues[t]*(1-i)+e*i)}setParameterValueById(t,e,i=1){const r=this.getParameterIndex(t);this.setParameterValueByIndex(r,e,i)}addParameterValueByIndex(t,e,i=1){this.setParameterValueByIndex(t,this.getParameterValueByIndex(t)+e*i)}addParameterValueById(t,e,i=1){const r=this.getParameterIndex(t);this.addParameterValueByIndex(r,e,i)}multiplyParameterValueById(t,e,i=1){const r=this.getParameterIndex(t);this.multiplyParameterValueByIndex(r,e,i)}multiplyParameterValueByIndex(t,e,i=1){this.setParameterValueByIndex(t,this.getParameterValueByIndex(t)*(1+(e-1)*i))}getDrawableIndex(t){const e=this._model.drawables.count;for(let i=0;i<e;++i)if(this._drawableIds.at(i)==t)return i;return-1}getDrawableCount(){return this._model.drawables.count}getDrawableId(t){const e=this._model.drawables.ids;return gt.getIdManager().getId(e[t])}getDrawableRenderOrders(){return this._model.drawables.renderOrders}getDrawableTextureIndices(t){return this._model.drawables.textureIndices[t]}getDrawableDynamicFlagVertexPositionsDidChange(t){const e=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasVertexPositionsDidChangeBit(e[t])}getDrawableVertexIndexCount(t){return this._model.drawables.indexCounts[t]}getDrawableVertexCount(t){return this._model.drawables.vertexCounts[t]}getDrawableVertices(t){return this.getDrawableVertexPositions(t)}getDrawableVertexIndices(t){return this._model.drawables.indices[t]}getDrawableVertexPositions(t){return this._model.drawables.vertexPositions[t]}getDrawableVertexUvs(t){return this._model.drawables.vertexUvs[t]}getDrawableOpacity(t){return this._model.drawables.opacities[t]}getDrawableCulling(t){const e=this._model.drawables.constantFlags;return!Live2DCubismCore.Utils.hasIsDoubleSidedBit(e[t])}getDrawableBlendMode(t){const e=this._model.drawables.constantFlags;return Live2DCubismCore.Utils.hasBlendAdditiveBit(e[t])?pt.CubismBlendMode_Additive:Live2DCubismCore.Utils.hasBlendMultiplicativeBit(e[t])?pt.CubismBlendMode_Multiplicative:pt.CubismBlendMode_Normal}getDrawableInvertedMaskBit(t){const e=this._model.drawables.constantFlags;return Live2DCubismCore.Utils.hasIsInvertedMaskBit(e[t])}getDrawableMasks(){return this._model.drawables.masks}getDrawableMaskCounts(){return this._model.drawables.maskCounts}isUsingMasking(){for(let t=0;t<this._model.drawables.count;++t)if(!(this._model.drawables.maskCounts[t]<=0))return!0;return!1}getDrawableDynamicFlagIsVisible(t){const e=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasIsVisibleBit(e[t])}getDrawableDynamicFlagVisibilityDidChange(t){const e=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasVisibilityDidChangeBit(e[t])}getDrawableDynamicFlagOpacityDidChange(t){const e=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasOpacityDidChangeBit(e[t])}getDrawableDynamicFlagRenderOrderDidChange(t){const e=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasRenderOrderDidChangeBit(e[t])}loadParameters(){let t=this._model.parameters.count;const e=this._savedParameters.getSize();t>e&&(t=e);for(let e=0;e<t;++e)this._parameterValues[e]=this._savedParameters.at(e)}initialize(){o(this._model),this._parameterValues=this._model.parameters.values,this._partOpacities=this._model.parts.opacities,this._parameterMaximumValues=this._model.parameters.maximumValues,this._parameterMinimumValues=this._model.parameters.minimumValues;{const t=this._model.parameters.ids,e=this._model.parameters.count;this._parameterIds.prepareCapacity(e);for(let i=0;i<e;++i)this._parameterIds.pushBack(gt.getIdManager().getId(t[i]))}{const t=this._model.parts.ids,e=this._model.parts.count;this._partIds.prepareCapacity(e);for(let i=0;i<e;++i)this._partIds.pushBack(gt.getIdManager().getId(t[i]))}{const t=this._model.drawables.ids,e=this._model.drawables.count;this._drawableIds.prepareCapacity(e);for(let i=0;i<e;++i)this._drawableIds.pushBack(gt.getIdManager().getId(t[i]))}}release(){this._model.release(),this._model=null}}}(ct||(ct={}));var mt,$t=ct.CubismModel;!function(t){class e{constructor(t){this._moc=t,this._modelCount=0}static create(t){let i=null;const r=Live2DCubismCore.Moc.fromArrayBuffer(t);return r&&(i=new e(r)),i}static delete(t){t._moc._release(),t._moc=null,t=null}createModel(){let t=null;const e=Live2DCubismCore.Model.fromMoc(this._moc);return e&&(t=new $t(e),t.initialize(),++this._modelCount),t}deleteModel(t){null!=t&&(t.release(),t=null,--this._modelCount)}release(){o(0==this._modelCount),this._moc._release(),this._moc=null}}t.CubismMoc=e}(mt||(mt={}));var yt,St=r.csmString,xt=I.CubismFramework,vt=d.CubismJson;!function(t){const e="Meta";t.CubismMotionJson=class{constructor(t,e){this._json=vt.create(t,e)}release(){vt.delete(this._json)}getMotionDuration(){return this._json.getRoot().getValueByString(e).getValueByString("Duration").toFloat()}isMotionLoop(){return this._json.getRoot().getValueByString(e).getValueByString("Loop").toBoolean()}getMotionCurveCount(){return this._json.getRoot().getValueByString(e).getValueByString("CurveCount").toInt()}getMotionFps(){return this._json.getRoot().getValueByString(e).getValueByString("Fps").toFloat()}getMotionTotalSegmentCount(){return this._json.getRoot().getValueByString(e).getValueByString("TotalSegmentCount").toInt()}getMotionTotalPointCount(){return this._json.getRoot().getValueByString(e).getValueByString("TotalPointCount").toInt()}isExistMotionFadeInTime(){return!this._json.getRoot().getValueByString(e).getValueByString("FadeInTime").isNull()}isExistMotionFadeOutTime(){return!this._json.getRoot().getValueByString(e).getValueByString("FadeOutTime").isNull()}getMotionFadeInTime(){return this._json.getRoot().getValueByString(e).getValueByString("FadeInTime").toFloat()}getMotionFadeOutTime(){return this._json.getRoot().getValueByString(e).getValueByString("FadeOutTime").toFloat()}getMotionCurveTarget(t){return this._json.getRoot().getValueByString("Curves").getValueByIndex(t).getValueByString("Target").getRawString()}getMotionCurveId(t){return xt.getIdManager().getId(this._json.getRoot().getValueByString("Curves").getValueByIndex(t).getValueByString("Id").getRawString())}isExistMotionCurveFadeInTime(t){return!this._json.getRoot().getValueByString("Curves").getValueByIndex(t).getValueByString("FadeInTime").isNull()}isExistMotionCurveFadeOutTime(t){return!this._json.getRoot().getValueByString("Curves").getValueByIndex(t).getValueByString("FadeOutTime").isNull()}getMotionCurveFadeInTime(t){return this._json.getRoot().getValueByString("Curves").getValueByIndex(t).getValueByString("FadeInTime").toFloat()}getMotionCurveFadeOutTime(t){return this._json.getRoot().getValueByString("Curves").getValueByIndex(t).getValueByString("FadeOutTime").toFloat()}getMotionCurveSegmentCount(t){return this._json.getRoot().getValueByString("Curves").getValueByIndex(t).getValueByString("Segments").getVector().getSize()}getMotionCurveSegment(t,e){return this._json.getRoot().getValueByString("Curves").getValueByIndex(t).getValueByString("Segments").getValueByIndex(e).toFloat()}getEventCount(){return this._json.getRoot().getValueByString(e).getValueByString("UserDataCount").toInt()}getTotalEventValueSize(){return this._json.getRoot().getValueByString(e).getValueByString("TotalUserDataSize").toInt()}getEventTime(t){return this._json.getRoot().getValueByString("UserData").getValueByIndex(t).getValueByString("Time").toInt()}getEventValue(t){return new St(this._json.getRoot().getValueByString("UserData").getValueByIndex(t).getValueByString("Value").getRawString())}}}(yt||(yt={}));var Pt,Tt=p.csmVector;!function(t){let e,i;!function(t){t[t.CubismMotionCurveTarget_Model=0]="CubismMotionCurveTarget_Model",t[t.CubismMotionCurveTarget_Parameter=1]="CubismMotionCurveTarget_Parameter",t[t.CubismMotionCurveTarget_PartOpacity=2]="CubismMotionCurveTarget_PartOpacity"}(e=t.CubismMotionCurveTarget||(t.CubismMotionCurveTarget={})),function(t){t[t.CubismMotionSegmentType_Linear=0]="CubismMotionSegmentType_Linear",t[t.CubismMotionSegmentType_Bezier=1]="CubismMotionSegmentType_Bezier",t[t.CubismMotionSegmentType_Stepped=2]="CubismMotionSegmentType_Stepped",t[t.CubismMotionSegmentType_InverseStepped=3]="CubismMotionSegmentType_InverseStepped"}(i=t.CubismMotionSegmentType||(t.CubismMotionSegmentType={}));t.CubismMotionPoint=class{constructor(){this.time=0,this.value=0}};t.CubismMotionSegment=class{constructor(){this.evaluate=null,this.basePointIndex=0,this.segmentType=0}};t.CubismMotionCurve=class{constructor(){this.type=e.CubismMotionCurveTarget_Model,this.segmentCount=0,this.baseSegmentIndex=0,this.fadeInTime=0,this.fadeOutTime=0}};t.CubismMotionEvent=class{constructor(){this.fireTime=0}};t.CubismMotionData=class{constructor(){this.duration=0,this.loop=!1,this.curveCount=0,this.eventCount=0,this.fps=0,this.curves=new Tt,this.segments=new Tt,this.points=new Tt,this.events=new Tt}}}(Pt||(Pt={}));var Mt,wt=r.csmString,It=Pt.CubismMotionData,Ct=Pt.CubismMotionSegment,Lt=Pt.CubismMotionPoint,bt=Pt.CubismMotionEvent,Et=Pt.CubismMotionSegmentType,Bt=Pt.CubismMotionCurve,At=Pt.CubismMotionCurveTarget,Ft=J.CubismMath,Dt=I.CubismFramework,Rt=Z.ACubismMotion,Vt=yt.CubismMotionJson;!function(t){function e(t,e,i){const r=new Lt;return r.time=t.time+(e.time-t.time)*i,r.value=t.value+(e.value-t.value)*i,r}function i(t,e){let i=(e-t[0].time)/(t[1].time-t[0].time);return i<0&&(i=0),t[0].value+(t[1].value-t[0].value)*i}function r(t,i){let r=(i-t[0].time)/(t[3].time-t[0].time);r<0&&(r=0);const s=e(t[0],t[1],r),n=e(t[1],t[2],r),o=e(t[2],t[3],r),a=e(s,n,r),l=e(n,o,r);return e(a,l,r).value}function s(t,e){return t[0].value}function n(t,e){return t[1].value}function a(t,e,i){const r=t.curves.at(e);let s=-1;const n=r.baseSegmentIndex+r.segmentCount;let o=0;for(let e=r.baseSegmentIndex;e<n&&(o=t.segments.at(e).basePointIndex+(t.segments.at(e).segmentType==Et.CubismMotionSegmentType_Bezier?3:1),null!=t.points.at(o));++e)if(t.points.at(o).time>i){s=e;break}if(-1==s)return null==t.points.at(o)?t.points.at(t.points._size-1).value:t.points.at(o).value;const a=t.segments.at(s);return a.evaluate(t.points.get(a.basePointIndex),i)}class h extends Rt{constructor(){super(),this._sourceFrameRate=30,this._loopDurationSeconds=-1,this._isLoop=!1,this._isLoopFadeIn=!0,this._lastWeight=0,this._motionData=null,this._modelCurveIdEyeBlink=null,this._modelCurveIdLipSync=null,this._eyeBlinkParameterIds=null,this._lipSyncParameterIds=null}static create(t,e,i){const r=new h;return r.parse(t,e),r._sourceFrameRate=r._motionData.fps,r._loopDurationSeconds=r._motionData.duration,r._onFinishedMotion=i,r}doUpdateParameters(t,e,i,r){null==this._modelCurveIdEyeBlink&&(this._modelCurveIdEyeBlink=Dt.getIdManager().getId("EyeBlink")),null==this._modelCurveIdLipSync&&(this._modelCurveIdLipSync=Dt.getIdManager().getId("LipSync"));let s=e-r.getStartTime();s<0&&(s=0);let n=Number.MAX_VALUE,o=Number.MAX_VALUE;let h=0,u=0;this._eyeBlinkParameterIds.getSize()>64&&l("too many eye blink targets : {0}",this._eyeBlinkParameterIds.getSize()),this._lipSyncParameterIds.getSize()>64&&l("too many lip sync targets : {0}",this._lipSyncParameterIds.getSize());const _=this._fadeInSeconds<=0?1:Ft.getEasingSine((e-r.getFadeInStartTime())/this._fadeInSeconds),c=this._fadeOutSeconds<=0||r.getEndTime()<0?1:Ft.getEasingSine((r.getEndTime()-e)/this._fadeOutSeconds);let g,p,d,f=s;if(this._isLoop)for(;f>this._motionData.duration;)f-=this._motionData.duration;const m=this._motionData.curves;for(p=0;p<this._motionData.curveCount&&m.at(p).type==At.CubismMotionCurveTarget_Model;++p)g=a(this._motionData,p,f),m.at(p).id==this._modelCurveIdEyeBlink?o=g:m.at(p).id==this._modelCurveIdLipSync&&(n=g);for(;p<this._motionData.curveCount&&m.at(p).type==At.CubismMotionCurveTarget_Parameter;++p){if(d=t.getParameterIndex(m.at(p).id),-1==d)continue;const s=t.getParameterValueByIndex(d);if(g=a(this._motionData,p,f),o!=Number.MAX_VALUE)for(let t=0;t<this._eyeBlinkParameterIds.getSize()&&t<64;++t)if(this._eyeBlinkParameterIds.at(t)==m.at(p).id){g*=o,u|=1<<t;break}if(n!=Number.MAX_VALUE)for(let t=0;t<this._lipSyncParameterIds.getSize()&&t<64;++t)if(this._lipSyncParameterIds.at(t)==m.at(p).id){g+=n,h|=1<<t;break}let l;if(m.at(p).fadeInTime<0&&m.at(p).fadeOutTime<0)l=s+(g-s)*i;else{let t,i;t=m.at(p).fadeInTime<0?_:0==m.at(p).fadeInTime?1:Ft.getEasingSine((e-r.getFadeInStartTime())/m.at(p).fadeInTime),i=m.at(p).fadeOutTime<0?c:0==m.at(p).fadeOutTime||r.getEndTime()<0?1:Ft.getEasingSine((r.getEndTime()-e)/m.at(p).fadeOutTime);l=s+(g-s)*(this._weight*t*i)}t.setParameterValueByIndex(d,l,1)}if(o!=Number.MAX_VALUE)for(let e=0;e<this._eyeBlinkParameterIds.getSize()&&e<64;++e){const r=t.getParameterValueById(this._eyeBlinkParameterIds.at(e));if(u>>e&1)continue;const s=r+(o-r)*i;t.setParameterValueById(this._eyeBlinkParameterIds.at(e),s)}if(n!=Number.MAX_VALUE)for(let e=0;e<this._lipSyncParameterIds.getSize()&&e<64;++e){const r=t.getParameterValueById(this._lipSyncParameterIds.at(e));if(h>>e&1)continue;const s=r+(n-r)*i;t.setParameterValueById(this._lipSyncParameterIds.at(e),s)}for(;p<this._motionData.curveCount&&m.at(p).type==At.CubismMotionCurveTarget_PartOpacity;++p)d=t.getParameterIndex(m.at(p).id),-1!=d&&(g=a(this._motionData,p,f),t.setParameterValueByIndex(d,g));s>=this._motionData.duration&&(this._isLoop?(r.setStartTime(e),this._isLoopFadeIn&&r.setFadeInStartTime(e)):(this._onFinishedMotion&&this._onFinishedMotion(this),r.setIsFinished(!0))),this._lastWeight=i}setIsLoop(t){this._isLoop=t}isLoop(){return this._isLoop}setIsLoopFadeIn(t){this._isLoopFadeIn=t}isLoopFadeIn(){return this._isLoopFadeIn}getDuration(){return this._isLoop?-1:this._loopDurationSeconds}getLoopDuration(){return this._loopDurationSeconds}setParameterFadeInTime(t,e){const i=this._motionData.curves;for(let r=0;r<this._motionData.curveCount;++r)if(t==i.at(r).id)return void(i.at(r).fadeInTime=e)}setParameterFadeOutTime(t,e){const i=this._motionData.curves;for(let r=0;r<this._motionData.curveCount;++r)if(t==i.at(r).id)return void(i.at(r).fadeOutTime=e)}getParameterFadeInTime(t){const e=this._motionData.curves;for(let i=0;i<this._motionData.curveCount;++i)if(t==e.at(i).id)return e.at(i).fadeInTime;return-1}getParameterFadeOutTime(t){const e=this._motionData.curves;for(let i=0;i<this._motionData.curveCount;++i)if(t==e.at(i).id)return e.at(i).fadeOutTime;return-1}setEffectIds(t,e){this._eyeBlinkParameterIds=t,this._lipSyncParameterIds=e}release(){this._motionData=void 0,this._motionData=null}parse(t,e){this._motionData=new It;let a=new Vt(t,e);this._motionData.duration=a.getMotionDuration(),this._motionData.loop=a.isMotionLoop(),this._motionData.curveCount=a.getMotionCurveCount(),this._motionData.fps=a.getMotionFps(),this._motionData.eventCount=a.getEventCount(),a.isExistMotionFadeInTime()?this._fadeInSeconds=a.getMotionFadeInTime()<0?1:a.getMotionFadeInTime():this._fadeInSeconds=1,a.isExistMotionFadeOutTime()?this._fadeOutSeconds=a.getMotionFadeOutTime()<0?1:a.getMotionFadeOutTime():this._fadeOutSeconds=1,this._motionData.curves.updateSize(this._motionData.curveCount,Bt,!0),this._motionData.segments.updateSize(a.getMotionTotalSegmentCount(),Ct,!0),this._motionData.points.updateSize(a.getMotionTotalPointCount(),Lt,!0),this._motionData.events.updateSize(this._motionData.eventCount,bt,!0);let l=0,h=0;for(let t=0;t<this._motionData.curveCount;++t){"Model"==a.getMotionCurveTarget(t)?this._motionData.curves.at(t).type=At.CubismMotionCurveTarget_Model:"Parameter"==a.getMotionCurveTarget(t)?this._motionData.curves.at(t).type=At.CubismMotionCurveTarget_Parameter:"PartOpacity"==a.getMotionCurveTarget(t)&&(this._motionData.curves.at(t).type=At.CubismMotionCurveTarget_PartOpacity),this._motionData.curves.at(t).id=a.getMotionCurveId(t),this._motionData.curves.at(t).baseSegmentIndex=h,this._motionData.curves.at(t).fadeInTime=a.isExistMotionCurveFadeInTime(t)?a.getMotionCurveFadeInTime(t):-1,this._motionData.curves.at(t).fadeOutTime=a.isExistMotionCurveFadeOutTime(t)?a.getMotionCurveFadeOutTime(t):-1;for(let e=0;e<a.getMotionCurveSegmentCount(t);){if(0==e){if(null==this._motionData.segments.at(h))break;if(this._motionData.segments.at(h).basePointIndex=l,null==this._motionData.points.at(l))break;this._motionData.points.at(l).time=a.getMotionCurveSegment(t,e),this._motionData.points.at(l).value=a.getMotionCurveSegment(t,e+1),l+=1,e+=2}else{if(null==this._motionData.segments.at(h))break;this._motionData.segments.at(h).basePointIndex=l-1}switch(a.getMotionCurveSegment(t,e)){case Et.CubismMotionSegmentType_Linear:if(this._motionData.segments.at(h).segmentType=Et.CubismMotionSegmentType_Linear,this._motionData.segments.at(h).evaluate=i,null==this._motionData.points.at(l))break;this._motionData.points.at(l).time=a.getMotionCurveSegment(t,e+1),this._motionData.points.at(l).value=a.getMotionCurveSegment(t,e+2),l+=1,e+=3;break;case Et.CubismMotionSegmentType_Bezier:if(this._motionData.segments.at(h).segmentType=Et.CubismMotionSegmentType_Bezier,this._motionData.segments.at(h).evaluate=r,null==this._motionData.points.at(l))break;this._motionData.points.at(l).time=a.getMotionCurveSegment(t,e+1),this._motionData.points.at(l).value=a.getMotionCurveSegment(t,e+2),this._motionData.points.at(l+1).time=a.getMotionCurveSegment(t,e+3),this._motionData.points.at(l+1).value=a.getMotionCurveSegment(t,e+4),this._motionData.points.at(l+2).time=a.getMotionCurveSegment(t,e+5),this._motionData.points.at(l+2).value=a.getMotionCurveSegment(t,e+6),l+=3,e+=7;break;case Et.CubismMotionSegmentType_Stepped:if(this._motionData.segments.at(h).segmentType=Et.CubismMotionSegmentType_Stepped,this._motionData.segments.at(h).evaluate=s,null==this._motionData.points.at(l))break;this._motionData.points.at(l).time=a.getMotionCurveSegment(t,e+1),this._motionData.points.at(l).value=a.getMotionCurveSegment(t,e+2),l+=1,e+=3;break;case Et.CubismMotionSegmentType_InverseStepped:this._motionData.segments.at(h).segmentType=Et.CubismMotionSegmentType_InverseStepped,this._motionData.segments.at(h).evaluate=n,this._motionData.points.at(l).time=a.getMotionCurveSegment(t,e+1),this._motionData.points.at(l).value=a.getMotionCurveSegment(t,e+2),l+=1,e+=3;break;default:o(0)}++this._motionData.curves.at(t).segmentCount,++h}}for(let t=0;t<a.getEventCount();++t)this._motionData.events.at(t).fireTime=a.getEventTime(t),this._motionData.events.at(t).value=a.getEventValue(t);a.release(),a=void 0,a=null}getFiredEvent(t,e){this._firedEventValues.updateSize(0);for(let i=0;i<this._motionData.eventCount;++i)this._motionData.events.at(i).fireTime>t&&this._motionData.events.at(i).fireTime<=e&&this._firedEventValues.pushBack(new wt(this._motionData.events.at(i).value.s));return this._firedEventValues}}t.CubismMotion=h}(Mt||(Mt={}));var Ot,Nt=p.csmVector,kt=I.CubismFramework,Ut=d.CubismJson,zt=Z.ACubismMotion;!function(t){class e extends zt{constructor(){super(),this._parameters=new Nt}static create(t,s){const n=new e,o=Ut.create(t,s),a=o.getRoot();n.setFadeInTime(a.getValueByString("FadeInTime").toFloat(1)),n.setFadeOutTime(a.getValueByString("FadeOutTime").toFloat(1));const l=a.getValueByString("Parameters").getSize();n._parameters.prepareCapacity(l);for(let t=0;t<l;++t){const e=a.getValueByString("Parameters").getValueByIndex(t),s=kt.getIdManager().getId(e.getValueByString("Id").getRawString()),o=e.getValueByString("Value").toFloat();let l;l=e.getValueByString("Blend").isNull()||"Add"==e.getValueByString("Blend").getString()?i.ExpressionBlendType_Add:"Multiply"==e.getValueByString("Blend").getString()?i.ExpressionBlendType_Multiply:"Overwrite"==e.getValueByString("Blend").getString()?i.ExpressionBlendType_Overwrite:i.ExpressionBlendType_Add;const h=new r;h.parameterId=s,h.blendType=l,h.value=o,n._parameters.pushBack(h)}return Ut.delete(o),n}doUpdateParameters(t,e,r,s){for(let e=0;e<this._parameters.getSize();++e){const s=this._parameters.at(e);switch(s.blendType){case i.ExpressionBlendType_Add:t.addParameterValueById(s.parameterId,s.value,r);break;case i.ExpressionBlendType_Multiply:t.multiplyParameterValueById(s.parameterId,s.value,r);break;case i.ExpressionBlendType_Overwrite:t.setParameterValueById(s.parameterId,s.value,r)}}}}let i;t.CubismExpressionMotion=e,function(t){t[t.ExpressionBlendType_Add=0]="ExpressionBlendType_Add",t[t.ExpressionBlendType_Multiply=1]="ExpressionBlendType_Multiply",t[t.ExpressionBlendType_Overwrite=2]="ExpressionBlendType_Overwrite"}(i=t.ExpressionBlendType||(t.ExpressionBlendType={}));class r{}t.ExpressionParameter=r}(Ot||(Ot={}));var Yt,Gt=p.csmVector,Xt=I.CubismFramework,jt=d.CubismJson;!function(t){class e{constructor(){this._fadeTimeSeconds=.5,this._lastModel=null,this._partGroups=new Gt,this._partGroupCounts=new Gt}static create(t,r){const s=new e,n=jt.create(t,r),o=n.getRoot();o.getValueByString("FadeInTime").isNull()||(s._fadeTimeSeconds=o.getValueByString("FadeInTime").toFloat(.5),s._fadeTimeSeconds<=0&&(s._fadeTimeSeconds=.5));const a=o.getValueByString("Groups"),l=a.getSize();for(let t=0;t<l;++t){const e=a.getValueByIndex(t),r=e.getSize();let n=0;for(let t=0;t<r;++t){const r=e.getValueByIndex(t),o=new i,a=Xt.getIdManager().getId(r.getValueByString("Id").getRawString());if(o.partId=a,!r.getValueByString("Link").isNull()){const t=r.getValueByString("Link"),e=t.getSize();for(let r=0;r<e;++r){const e=new i,s=Xt.getIdManager().getId(t.getValueByIndex(r).getString());e.partId=s,o.link.pushBack(e)}}s._partGroups.pushBack(o.clone()),++n}s._partGroupCounts.pushBack(n)}return jt.delete(n),s}static delete(t){null!=t&&(t=null)}updateParameters(t,e){t!=this._lastModel&&this.reset(t),this._lastModel=t,e<0&&(e=0);let i=0;for(let r=0;r<this._partGroupCounts.getSize();r++){const s=this._partGroupCounts.at(r);this.doFade(t,e,i,s),i+=s}this.copyPartOpacities(t)}reset(t){let e=0;for(let i=0;i<this._partGroupCounts.getSize();++i){const r=this._partGroupCounts.at(i);for(let i=e;i<e+r;++i){this._partGroups.at(i).initialize(t);const r=this._partGroups.at(i).partIndex,s=this._partGroups.at(i).parameterIndex;if(!(r<0)){t.setPartOpacityByIndex(r,i==e?1:0),t.setParameterValueByIndex(s,i==e?1:0);for(let e=0;e<this._partGroups.at(i).link.getSize();++e)this._partGroups.at(i).link.at(e).initialize(t)}}e+=r}}copyPartOpacities(t){for(let e=0;e<this._partGroups.getSize();++e){const i=this._partGroups.at(e);if(0==i.link.getSize())continue;const r=this._partGroups.at(e).partIndex,s=t.getPartOpacityByIndex(r);for(let e=0;e<i.link.getSize();++e){const r=i.link.at(e).partIndex;r<0||t.setPartOpacityByIndex(r,s)}}}doFade(t,e,i,r){let s=-1,n=1;for(let o=i;o<i+r;++o){const i=this._partGroups.at(o).partIndex,r=this._partGroups.at(o).parameterIndex;if(t.getParameterValueByIndex(r)>.001){if(s>=0)break;s=o,n=t.getPartOpacityByIndex(i),n+=e/this._fadeTimeSeconds,n>1&&(n=1)}}s<0&&(s=0,n=1);for(let e=i;e<i+r;++e){const i=this._partGroups.at(e).partIndex;if(s==e)t.setPartOpacityByIndex(i,n);else{let e,r=t.getPartOpacityByIndex(i);e=n<.5?-.5*n/.5+1:.5*(1-n)/.5;(1-e)*(1-n)>.15&&(e=1-.15/(1-n)),r>e&&(r=e),t.setPartOpacityByIndex(i,r)}}}}t.CubismPose=e;class i{constructor(t){if(this.parameterIndex=0,this.partIndex=0,this.link=new Gt,null!=t){this.partId=t.partId;for(const e=t.link.begin();e.notEqual(t.link.end());e.preIncrement())this.link.pushBack(e.ptr().clone())}}assignment(t){this.partId=t.partId;for(const e=t.link.begin();e.notEqual(t.link.end());e.preIncrement())this.link.pushBack(e.ptr().clone());return this}initialize(t){this.parameterIndex=t.getParameterIndex(this.partId),this.partIndex=t.getPartIndex(this.partId),t.setParameterValueByIndex(this.parameterIndex,1)}clone(){const t=new i;t.partId=this.partId,t.parameterIndex=this.parameterIndex,t.partIndex=this.partIndex,t.link=new Gt;for(let e=this.link.begin();e.notEqual(this.link.end());e.increment())t.link.pushBack(e.ptr().clone());return t}}t.PartData=i}(Yt||(Yt={}));var Ht,qt=I.CubismFramework,Wt=d.CubismJson;!function(t){t.CubismModelUserDataJson=class{constructor(t,e){this._json=Wt.create(t,e)}release(){Wt.delete(this._json)}getUserDataCount(){return this._json.getRoot().getValueByString("Meta").getValueByString("UserDataCount").toInt()}getTotalUserDataSize(){return this._json.getRoot().getValueByString("Meta").getValueByString("TotalUserDataSize").toInt()}getUserDataTargetType(t){return this._json.getRoot().getValueByString("UserData").getValueByIndex(t).getValueByString("Target").getRawString()}getUserDataId(t){return qt.getIdManager().getId(this._json.getRoot().getValueByString("UserData").getValueByIndex(t).getValueByString("Id").getRawString())}getUserDataValue(t){return this._json.getRoot().getValueByString("UserData").getValueByIndex(t).getValueByString("Value").getRawString()}}}(Ht||(Ht={}));var Jt,Qt=I.CubismFramework,Zt=p.csmVector,Kt=r.csmString,te=Ht.CubismModelUserDataJson;!function(t){class e{}t.CubismModelUserDataNode=e;class i{constructor(){this._userDataNodes=new Zt,this._artMeshUserDataNode=new Zt}static create(t,e){const r=new i;return r.parseUserData(t,e),r}static delete(t){null!=t&&(t.release(),t=null)}getArtMeshUserDatas(){return this._artMeshUserDataNode}parseUserData(t,i){let r=new te(t,i);const s=Qt.getIdManager().getId("ArtMesh"),n=r.getUserDataCount();for(let t=0;t<n;t++){const i=new e;i.targetId=r.getUserDataId(t),i.targetType=Qt.getIdManager().getId(r.getUserDataTargetType(t)),i.value=new Kt(r.getUserDataValue(t)),this._userDataNodes.pushBack(i),i.targetType==s&&this._artMeshUserDataNode.pushBack(i)}r.release(),r=void 0}release(){for(let t=0;t<this._userDataNodes.getSize();++t)this._userDataNodes.set(t,null);this._userDataNodes=null}}t.CubismModelUserData=i}(Jt||(Jt={}));var ee,ie=p.csmVector,re=H.CubismVector2;!function(t){let e,i;!function(t){t[t.CubismPhysicsTargetType_Parameter=0]="CubismPhysicsTargetType_Parameter"}(e=t.CubismPhysicsTargetType||(t.CubismPhysicsTargetType={})),function(t){t[t.CubismPhysicsSource_X=0]="CubismPhysicsSource_X",t[t.CubismPhysicsSource_Y=1]="CubismPhysicsSource_Y",t[t.CubismPhysicsSource_Angle=2]="CubismPhysicsSource_Angle"}(i=t.CubismPhysicsSource||(t.CubismPhysicsSource={}));t.PhysicsJsonEffectiveForces=class{constructor(){this.gravity=new re(0,0),this.wind=new re(0,0)}};class r{}t.CubismPhysicsParameter=r;class s{}t.CubismPhysicsNormalization=s;t.CubismPhysicsParticle=class{constructor(){this.initialPosition=new re(0,0),this.position=new re(0,0),this.lastPosition=new re(0,0),this.lastGravity=new re(0,0),this.force=new re(0,0),this.velocity=new re(0,0)}};t.CubismPhysicsSubRig=class{constructor(){this.normalizationPosition=new s,this.normalizationAngle=new s}};t.CubismPhysicsInput=class{constructor(){this.source=new r}};t.CubismPhysicsOutput=class{constructor(){this.destination=new r,this.translationScale=new re(0,0)}};t.CubismPhysicsRig=class{constructor(){this.settings=new ie,this.inputs=new ie,this.outputs=new ie,this.particles=new ie,this.gravity=new re(0,0),this.wind=new re(0,0)}}}(ee||(ee={}));var se,ne=I.CubismFramework,oe=H.CubismVector2,ae=d.CubismJson;!function(t){const e="Meta",i="PhysicsSettings";t.CubismPhysicsJson=class{constructor(t,e){this._json=ae.create(t,e)}release(){ae.delete(this._json)}getGravity(){const t=new oe(0,0);return t.x=this._json.getRoot().getValueByString(e).getValueByString("EffectiveForces").getValueByString("Gravity").getValueByString("X").toFloat(),t.y=this._json.getRoot().getValueByString(e).getValueByString("EffectiveForces").getValueByString("Gravity").getValueByString("Y").toFloat(),t}getWind(){const t=new oe(0,0);return t.x=this._json.getRoot().getValueByString(e).getValueByString("EffectiveForces").getValueByString("Wind").getValueByString("X").toFloat(),t.y=this._json.getRoot().getValueByString(e).getValueByString("EffectiveForces").getValueByString("Wind").getValueByString("Y").toFloat(),t}getSubRigCount(){return this._json.getRoot().getValueByString(e).getValueByString("PhysicsSettingCount").toInt()}getTotalInputCount(){return this._json.getRoot().getValueByString(e).getValueByString("TotalInputCount").toInt()}getTotalOutputCount(){return this._json.getRoot().getValueByString(e).getValueByString("TotalOutputCount").toInt()}getVertexCount(){return this._json.getRoot().getValueByString(e).getValueByString("VertexCount").toInt()}getNormalizationPositionMinimumValue(t){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Normalization").getValueByString("Position").getValueByString("Minimum").toFloat()}getNormalizationPositionMaximumValue(t){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Normalization").getValueByString("Position").getValueByString("Maximum").toFloat()}getNormalizationPositionDefaultValue(t){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Normalization").getValueByString("Position").getValueByString("Default").toFloat()}getNormalizationAngleMinimumValue(t){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Normalization").getValueByString("Angle").getValueByString("Minimum").toFloat()}getNormalizationAngleMaximumValue(t){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Normalization").getValueByString("Angle").getValueByString("Maximum").toFloat()}getNormalizationAngleDefaultValue(t){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Normalization").getValueByString("Angle").getValueByString("Default").toFloat()}getInputCount(t){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Input").getVector().getSize()}getInputWeight(t,e){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Input").getValueByIndex(e).getValueByString("Weight").toFloat()}getInputReflect(t,e){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Input").getValueByIndex(e).getValueByString("Reflect").toBoolean()}getInputType(t,e){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Input").getValueByIndex(e).getValueByString("Type").getRawString()}getInputSourceId(t,e){return ne.getIdManager().getId(this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Input").getValueByIndex(e).getValueByString("Source").getValueByString("Id").getRawString())}getOutputCount(t){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Output").getVector().getSize()}getOutputVertexIndex(t,e){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Output").getValueByIndex(e).getValueByString("VertexIndex").toInt()}getOutputAngleScale(t,e){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Output").getValueByIndex(e).getValueByString("Scale").toFloat()}getOutputWeight(t,e){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Output").getValueByIndex(e).getValueByString("Weight").toFloat()}getOutputDestinationId(t,e){return ne.getIdManager().getId(this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Output").getValueByIndex(e).getValueByString("Destination").getValueByString("Id").getRawString())}getOutputType(t,e){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Output").getValueByIndex(e).getValueByString("Type").getRawString()}getOutputReflect(t,e){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Output").getValueByIndex(e).getValueByString("Reflect").toBoolean()}getParticleCount(t){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Vertices").getVector().getSize()}getParticleMobility(t,e){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Vertices").getValueByIndex(e).getValueByString("Mobility").toFloat()}getParticleDelay(t,e){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Vertices").getValueByIndex(e).getValueByString("Delay").toFloat()}getParticleAcceleration(t,e){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Vertices").getValueByIndex(e).getValueByString("Acceleration").toFloat()}getParticleRadius(t,e){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Vertices").getValueByIndex(e).getValueByString("Radius").toInt()}getParticlePosition(t,e){const r=new oe(0,0);return r.x=this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Vertices").getValueByIndex(e).getValueByString("Position").getValueByString("X").toFloat(),r.y=this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Vertices").getValueByIndex(e).getValueByString("Position").getValueByString("Y").toFloat(),r}}}(se||(se={}));var le,he,ue=se.CubismPhysicsJson,_e=J.CubismMath,ce=ee.CubismPhysicsRig,ge=ee.CubismPhysicsSubRig,pe=ee.CubismPhysicsInput,de=ee.CubismPhysicsOutput,fe=ee.CubismPhysicsParticle,me=ee.CubismPhysicsSource,$e=ee.CubismPhysicsTargetType,ye=H.CubismVector2;!function(t){class e{constructor(){this._physicsRig=null,this._options=new i,this._options.gravity.y=-1,this._options.gravity.x=0,this._options.wind.x=0,this._options.wind.y=0}static create(t,i){const r=new e;return r.parse(t,i),r._physicsRig.gravity.y=0,r}static delete(t){null!=t&&(t.release(),t=null)}evaluate(t,e){let i,r,s,n;const o=new ye;let a,l,h,u,_,c,d,f;_=t.getModel().parameters.values,c=t.getModel().parameters.maximumValues,d=t.getModel().parameters.minimumValues,f=t.getModel().parameters.defaultValues;for(let m=0;m<this._physicsRig.subRigCount;++m){i={angle:0},o.x=0,o.y=0,a=this._physicsRig.settings.at(m),l=this._physicsRig.inputs.get(a.baseInputIndex),h=this._physicsRig.outputs.get(a.baseOutputIndex),u=this._physicsRig.particles.get(a.baseParticleIndex);for(let e=0;e<a.inputCount;++e)r=l[e].weight/100,-1==l[e].sourceParameterIndex&&(l[e].sourceParameterIndex=t.getParameterIndex(l[e].source.id)),l[e].getNormalizedParameterValue(o,i,_[l[e].sourceParameterIndex],d[l[e].sourceParameterIndex],c[l[e].sourceParameterIndex],f[l[e].sourceParameterIndex],a.normalizationPosition,a.normalizationAngle,l[0].reflect,r);s=_e.degreesToRadian(-i.angle),o.x=o.x*_e.cos(s)-o.y*_e.sin(s),o.y=o.x*_e.sin(s)+o.y*_e.cos(s),g(u,a.particleCount,o,i.angle,this._options.wind,.001*a.normalizationPosition.maximum,e,5);for(let e=0;e<a.outputCount;++e){const i=h[e].vertexIndex;if(i<1||i>=a.particleCount)break;-1==h[e].destinationParameterIndex&&(h[e].destinationParameterIndex=t.getParameterIndex(h[e].destination.id));const r=new ye;r.x=u[i].position.x-u[i-1].position.x,r.y=u[i].position.y-u[i-1].position.y,n=h[e].getValue(r,u,i,h[e].reflect,this._options.gravity);const s=h[e].destinationParameterIndex,o=!Float32Array.prototype.slice&&"subarray"in Float32Array.prototype?JSON.parse(JSON.stringify(_.subarray(s))):_.slice(s);p(o,d[s],c[s],n,h[e]);for(let t=s,e=0;t<_.length;t++,e++)_[t]=o[e]}}}setOptions(t){this._options=t}getOption(){return this._options}release(){this._physicsRig=void 0,this._physicsRig=null}parse(t,e){this._physicsRig=new ce;let i=new ue(t,e);this._physicsRig.gravity=i.getGravity(),this._physicsRig.wind=i.getWind(),this._physicsRig.subRigCount=i.getSubRigCount(),this._physicsRig.settings.updateSize(this._physicsRig.subRigCount,ge,!0),this._physicsRig.inputs.updateSize(i.getTotalInputCount(),pe,!0),this._physicsRig.outputs.updateSize(i.getTotalOutputCount(),de,!0),this._physicsRig.particles.updateSize(i.getVertexCount(),fe,!0);let h=0,g=0,p=0;for(let t=0;t<this._physicsRig.settings.getSize();++t){this._physicsRig.settings.at(t).normalizationPosition.minimum=i.getNormalizationPositionMinimumValue(t),this._physicsRig.settings.at(t).normalizationPosition.maximum=i.getNormalizationPositionMaximumValue(t),this._physicsRig.settings.at(t).normalizationPosition.defalut=i.getNormalizationPositionDefaultValue(t),this._physicsRig.settings.at(t).normalizationAngle.minimum=i.getNormalizationAngleMinimumValue(t),this._physicsRig.settings.at(t).normalizationAngle.maximum=i.getNormalizationAngleMaximumValue(t),this._physicsRig.settings.at(t).normalizationAngle.defalut=i.getNormalizationAngleDefaultValue(t),this._physicsRig.settings.at(t).inputCount=i.getInputCount(t),this._physicsRig.settings.at(t).baseInputIndex=h;for(let e=0;e<this._physicsRig.settings.at(t).inputCount;++e)this._physicsRig.inputs.at(h+e).sourceParameterIndex=-1,this._physicsRig.inputs.at(h+e).weight=i.getInputWeight(t,e),this._physicsRig.inputs.at(h+e).reflect=i.getInputReflect(t,e),"X"==i.getInputType(t,e)?(this._physicsRig.inputs.at(h+e).type=me.CubismPhysicsSource_X,this._physicsRig.inputs.at(h+e).getNormalizedParameterValue=r):"Y"==i.getInputType(t,e)?(this._physicsRig.inputs.at(h+e).type=me.CubismPhysicsSource_Y,this._physicsRig.inputs.at(h+e).getNormalizedParameterValue=s):"Angle"==i.getInputType(t,e)&&(this._physicsRig.inputs.at(h+e).type=me.CubismPhysicsSource_Angle,this._physicsRig.inputs.at(h+e).getNormalizedParameterValue=n),this._physicsRig.inputs.at(h+e).source.targetType=$e.CubismPhysicsTargetType_Parameter,this._physicsRig.inputs.at(h+e).source.id=i.getInputSourceId(t,e);h+=this._physicsRig.settings.at(t).inputCount,this._physicsRig.settings.at(t).outputCount=i.getOutputCount(t),this._physicsRig.settings.at(t).baseOutputIndex=g;for(let e=0;e<this._physicsRig.settings.at(t).outputCount;++e)this._physicsRig.outputs.at(g+e).destinationParameterIndex=-1,this._physicsRig.outputs.at(g+e).vertexIndex=i.getOutputVertexIndex(t,e),this._physicsRig.outputs.at(g+e).angleScale=i.getOutputAngleScale(t,e),this._physicsRig.outputs.at(g+e).weight=i.getOutputWeight(t,e),this._physicsRig.outputs.at(g+e).destination.targetType=$e.CubismPhysicsTargetType_Parameter,this._physicsRig.outputs.at(g+e).destination.id=i.getOutputDestinationId(t,e),"X"==i.getOutputType(t,e)?(this._physicsRig.outputs.at(g+e).type=me.CubismPhysicsSource_X,this._physicsRig.outputs.at(g+e).getValue=o,this._physicsRig.outputs.at(g+e).getScale=u):"Y"==i.getOutputType(t,e)?(this._physicsRig.outputs.at(g+e).type=me.CubismPhysicsSource_Y,this._physicsRig.outputs.at(g+e).getValue=a,this._physicsRig.outputs.at(g+e).getScale=_):"Angle"==i.getOutputType(t,e)&&(this._physicsRig.outputs.at(g+e).type=me.CubismPhysicsSource_Angle,this._physicsRig.outputs.at(g+e).getValue=l,this._physicsRig.outputs.at(g+e).getScale=c),this._physicsRig.outputs.at(g+e).reflect=i.getOutputReflect(t,e);g+=this._physicsRig.settings.at(t).outputCount,this._physicsRig.settings.at(t).particleCount=i.getParticleCount(t),this._physicsRig.settings.at(t).baseParticleIndex=p;for(let e=0;e<this._physicsRig.settings.at(t).particleCount;++e)this._physicsRig.particles.at(p+e).mobility=i.getParticleMobility(t,e),this._physicsRig.particles.at(p+e).delay=i.getParticleDelay(t,e),this._physicsRig.particles.at(p+e).acceleration=i.getParticleAcceleration(t,e),this._physicsRig.particles.at(p+e).radius=i.getParticleRadius(t,e),this._physicsRig.particles.at(p+e).position=i.getParticlePosition(t,e);p+=this._physicsRig.settings.at(t).particleCount}this.initialize(),i.release(),i=void 0,i=null}initialize(){let t,e,i;for(let r=0;r<this._physicsRig.subRigCount;++r){e=this._physicsRig.settings.at(r),t=this._physicsRig.particles.get(e.baseParticleIndex),t[0].initialPosition=new ye(0,0),t[0].lastPosition=new ye(t[0].initialPosition.x,t[0].initialPosition.y),t[0].lastGravity=new ye(0,-1),t[0].lastGravity.y*=-1,t[0].velocity=new ye(0,0),t[0].force=new ye(0,0);for(let r=1;r<e.particleCount;++r)i=new ye(0,0),i.y=t[r].radius,t[r].initialPosition=new ye(t[r-1].initialPosition.x+i.x,t[r-1].initialPosition.y+i.y),t[r].position=new ye(t[r].initialPosition.x,t[r].initialPosition.y),t[r].lastPosition=new ye(t[r].initialPosition.x,t[r].initialPosition.y),t[r].lastGravity=new ye(0,-1),t[r].lastGravity.y*=-1,t[r].velocity=new ye(0,0),t[r].force=new ye(0,0)}}}t.CubismPhysics=e;class i{constructor(){this.gravity=new ye(0,0),this.wind=new ye(0,0)}}function r(t,e,i,r,s,n,o,a,l,h){t.x+=d(i,r,s,n,o.minimum,o.maximum,o.defalut,l)*h}function s(t,e,i,r,s,n,o,a,l,h){t.y+=d(i,r,s,n,o.minimum,o.maximum,o.defalut,l)*h}function n(t,e,i,r,s,n,o,a,l,h){e.angle+=d(i,r,s,n,a.minimum,a.maximum,a.defalut,l)*h}function o(t,e,i,r,s){let n=t.x;return r&&(n*=-1),n}function a(t,e,i,r,s){let n=t.y;return r&&(n*=-1),n}function l(t,e,i,r,s){let n;return s=i>=2?e[i-1].position.substract(e[i-2].position):s.multiplyByScaler(-1),n=_e.directionToRadian(s,t),r&&(n*=-1),n}function h(t,e){return _e.min(t,e)+function(t,e){const i=_e.max(t,e),r=_e.min(t,e);return _e.abs(i-r)}(t,e)/2}function u(t,e){return JSON.parse(JSON.stringify(t.x))}function _(t,e){return JSON.parse(JSON.stringify(t.y))}function c(t,e){return JSON.parse(JSON.stringify(e))}function g(t,e,i,r,s,n,o,a){let l,h,u,_,c=new ye(0,0),g=new ye(0,0),p=new ye(0,0),d=new ye(0,0);t[0].position=new ye(i.x,i.y),l=_e.degreesToRadian(r),_=_e.radianToDirection(l),_.normalize();for(let i=1;i<e;++i)t[i].force=_.multiplyByScaler(t[i].acceleration).add(s),t[i].lastPosition=new ye(t[i].position.x,t[i].position.y),h=t[i].delay*o*30,c=t[i].position.substract(t[i-1].position),u=_e.directionToRadian(t[i].lastGravity,_)/a,c.x=_e.cos(u)*c.x-c.y*_e.sin(u),c.y=_e.sin(u)*c.x+c.y*_e.cos(u),t[i].position=t[i-1].position.add(c),g=t[i].velocity.multiplyByScaler(h),p=t[i].force.multiplyByScaler(h).multiplyByScaler(h),t[i].position=t[i].position.add(g).add(p),d=t[i].position.substract(t[i-1].position),d.normalize(),t[i].position=t[i-1].position.add(d.multiplyByScaler(t[i].radius)),_e.abs(t[i].position.x)<n&&(t[i].position.x=0),0!=h&&(t[i].velocity=t[i].position.substract(t[i].lastPosition),t[i].velocity=t[i].velocity.divisionByScalar(h),t[i].velocity=t[i].velocity.multiplyByScaler(t[i].mobility)),t[i].force=new ye(0,0),t[i].lastGravity=new ye(_.x,_.y)}function p(t,e,i,r,s){let n,o,a;n=s.getScale(s.translationScale,s.angleScale),o=r*n,o<e?(o<s.valueBelowMinimum&&(s.valueBelowMinimum=o),o=e):o>i&&(o>s.valueExceededMaximum&&(s.valueExceededMaximum=o),o=i),a=s.weight/100,a>=1||(o=t[0]*(1-a)+o*a),t[0]=o}function d(t,e,i,r,s,n,o,a){let l=0;const u=_e.max(i,e);u<t&&(t=u);const _=_e.min(i,e);_>t&&(t=_);const c=_e.min(s,n),g=_e.max(s,n),p=o,d=h(_,u),f=t-d;switch(function(t){let e=0;return t>0?e=1:t<0&&(e=-1),e}(f)){case 1:{const t=g-p,e=u-d;0!=e&&(l=f*(t/e),l+=p);break}case-1:{const t=c-p,e=_-d;0!=e&&(l=f*(t/e),l+=p);break}case 0:l=p}return a?l:-1*l}t.Options=i}(le||(le={})),function(t){class e{constructor(){this._currentTime=0}static create(){return new e}static delete(t){null!=t&&(t=null)}setParameters(t){this._breathParameters=t}getParameters(){return this._breathParameters}updateParameters(t,e){this._currentTime+=e;const i=2*this._currentTime*3.14159;for(let e=0;e<this._breathParameters.getSize();++e){const r=this._breathParameters.at(e);t.addParameterValueById(r.parameterId,r.offset+r.peak*Math.sin(i/r.cycle),r.weight)}}}t.CubismBreath=e;t.BreathParameterData=class{constructor(t,e,i,r,s){this.parameterId=null==t?null:t,this.offset=null==e?0:e,this.peak=null==i?0:i,this.cycle=null==r?0:r,this.weight=null==s?0:s}}}(he||(he={}));var Se,xe,ve=p.csmVector;!function(t){class e{constructor(t){if(this._blinkingState=i.EyeState_First,this._nextBlinkingTime=0,this._stateStartTimeSeconds=0,this._blinkingIntervalSeconds=4,this._closingSeconds=.1,this._closedSeconds=.05,this._openingSeconds=.15,this._userTimeSeconds=0,this._parameterIds=new ve,null!=t)for(let e=0;e<t.getEyeBlinkParameterCount();++e)this._parameterIds.pushBack(t.getEyeBlinkParameterId(e))}static create(t=null){return new e(t)}static delete(t){null!=t&&(t=null)}setBlinkingInterval(t){this._blinkingIntervalSeconds=t}setBlinkingSetting(t,e,i){this._closingSeconds=t,this._closedSeconds=e,this._openingSeconds=i}setParameterIds(t){this._parameterIds=t}getParameterIds(){return this._parameterIds}updateParameters(t,r){let s;this._userTimeSeconds+=r;let n=0;switch(this._blinkingState){case i.EyeState_Closing:n=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._closingSeconds,n>=1&&(n=1,this._blinkingState=i.EyeState_Closed,this._stateStartTimeSeconds=this._userTimeSeconds),s=1-n;break;case i.EyeState_Closed:n=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._closedSeconds,n>=1&&(this._blinkingState=i.EyeState_Opening,this._stateStartTimeSeconds=this._userTimeSeconds),s=0;break;case i.EyeState_Opening:n=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._openingSeconds,n>=1&&(n=1,this._blinkingState=i.EyeState_Interval,this._nextBlinkingTime=this.determinNextBlinkingTiming()),s=n;break;case i.EyeState_Interval:this._nextBlinkingTime<this._userTimeSeconds&&(this._blinkingState=i.EyeState_Closing,this._stateStartTimeSeconds=this._userTimeSeconds),s=1;break;case i.EyeState_First:default:this._blinkingState=i.EyeState_Interval,this._nextBlinkingTime=this.determinNextBlinkingTiming(),s=1}e.CloseIfZero||(s=-s);for(let e=0;e<this._parameterIds.getSize();++e)t.setParameterValueById(this._parameterIds.at(e),s)}determinNextBlinkingTiming(){const t=Math.random();return this._userTimeSeconds+t*(2*this._blinkingIntervalSeconds-1)}}let i;e.CloseIfZero=!0,t.CubismEyeBlink=e,function(t){t[t.EyeState_First=0]="EyeState_First",t[t.EyeState_Interval=1]="EyeState_Interval",t[t.EyeState_Closing=2]="EyeState_Closing",t[t.EyeState_Closed=3]="EyeState_Closed",t[t.EyeState_Opening=4]="EyeState_Opening"}(i=t.EyeState||(t.EyeState={}))}(Se||(Se={})),function(t){t.csmRect=class{constructor(t,e,i,r){this.x=t,this.y=e,this.width=i,this.height=r}getCenterX(){return this.x+.5*this.width}getCenterY(){return this.y+.5*this.height}getRight(){return this.x+this.width}getBottom(){return this.y+this.height}setRect(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height}expand(t,e){this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e}}}(xe||(xe={}));var Pe,Te=I.Constant,Me=v.CubismMatrix44,we=xe.csmRect,Ie=g.csmMap,Ce=p.csmVector,Le=M.CubismRenderer,be=M.CubismBlendMode,Ee=M.CubismTextureColor;!function(t){let e,i,r,s;class n{constructor(){this._maskRenderTexture=null,this._colorBuffer=null,this._currentFrameNo=0,this._clippingMaskBufferSize=256,this._clippingContextListForMask=new Ce,this._clippingContextListForDraw=new Ce,this._channelColors=new Ce,this._tmpBoundsOnModel=new we,this._tmpMatrix=new Me,this._tmpMatrixForMask=new Me,this._tmpMatrixForDraw=new Me,this._maskTexture=null;let t=new Ee;t.R=1,t.G=0,t.B=0,t.A=0,this._channelColors.pushBack(t),t=new Ee,t.R=0,t.G=1,t.B=0,t.A=0,this._channelColors.pushBack(t),t=new Ee,t.R=0,t.G=0,t.B=1,t.A=0,this._channelColors.pushBack(t),t=new Ee,t.R=0,t.G=0,t.B=0,t.A=1,this._channelColors.pushBack(t)}getChannelFlagAsColor(t){return this._channelColors.at(t)}getMaskRenderTexture(){let t=0;if(this._maskTexture&&0!=this._maskTexture.texture&&(this._maskTexture.frameNo=this._currentFrameNo,t=this._maskTexture.texture),0==t){const e=this._clippingMaskBufferSize;this._colorBuffer=this.gl.createTexture(),this.gl.bindTexture(this.gl.TEXTURE_2D,this._colorBuffer),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,e,e,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.bindTexture(this.gl.TEXTURE_2D,null),t=this.gl.createFramebuffer(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,t),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,this._colorBuffer,0),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,r),this._maskTexture=new o(this._currentFrameNo,t)}return t}setGL(t){this.gl=t}calcClippedDrawTotalBounds(t,e){let i=Number.MAX_VALUE,r=Number.MAX_VALUE,s=Number.MIN_VALUE,n=Number.MIN_VALUE;const o=e._clippedDrawableIndexList.length;for(let a=0;a<o;a++){const o=e._clippedDrawableIndexList[a],l=t.getDrawableVertexCount(o),h=t.getDrawableVertices(o);let u=Number.MAX_VALUE,_=Number.MAX_VALUE,c=Number.MIN_VALUE,g=Number.MIN_VALUE;const p=l*Te.vertexStep;for(let t=Te.vertexOffset;t<p;t+=Te.vertexStep){const e=h[t],i=h[t+1];e<u&&(u=e),e>c&&(c=e),i<_&&(_=i),i>g&&(g=i)}if(u!=Number.MAX_VALUE)if(u<i&&(i=u),_<r&&(r=_),c>s&&(s=c),g>n&&(n=g),i==Number.MAX_VALUE)e._allClippedDrawRect.x=0,e._allClippedDrawRect.y=0,e._allClippedDrawRect.width=0,e._allClippedDrawRect.height=0,e._isUsing=!1;else{e._isUsing=!0;const t=s-i,o=n-r;e._allClippedDrawRect.x=i,e._allClippedDrawRect.y=r,e._allClippedDrawRect.width=t,e._allClippedDrawRect.height=o}}}release(){for(let t=0;t<this._clippingContextListForMask.getSize();t++)this._clippingContextListForMask.at(t)&&(this._clippingContextListForMask.at(t).release(),this._clippingContextListForMask.set(t,void 0)),this._clippingContextListForMask.set(t,null);this._clippingContextListForMask=null;for(let t=0;t<this._clippingContextListForDraw.getSize();t++)this._clippingContextListForDraw.set(t,null);this._clippingContextListForDraw=null,this._maskTexture&&(this.gl.deleteFramebuffer(this._maskTexture.texture),this._maskTexture=null);for(let t=0;t<this._channelColors.getSize();t++)this._channelColors.set(t,null);this._channelColors=null,this.gl.deleteTexture(this._colorBuffer),this._colorBuffer=null}initialize(t,e,i,r){for(let t=0;t<e;t++){if(r[t]<=0){this._clippingContextListForDraw.pushBack(null);continue}let e=this.findSameClip(i[t],r[t]);null==e&&(e=new a(this,i[t],r[t]),this._clippingContextListForMask.pushBack(e)),e.addClippedDrawable(t),this._clippingContextListForDraw.pushBack(e)}}setupClippingContext(t,e){this._currentFrameNo++;let s=0;for(let e=0;e<this._clippingContextListForMask.getSize();e++){const i=this._clippingContextListForMask.at(e);this.calcClippedDrawTotalBounds(t,i),i._isUsing&&s++}if(s>0){this.gl.viewport(0,0,this._clippingMaskBufferSize,this._clippingMaskBufferSize),this._maskRenderTexture=this.getMaskRenderTexture();e.getMvpMatrix();e.preDraw(),this.setupLayoutBounds(s),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this._maskRenderTexture),this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT);for(let i=0;i<this._clippingContextListForMask.getSize();i++){const r=this._clippingContextListForMask.at(i),s=r._allClippedDrawRect,n=r._layoutBounds,o=.05;this._tmpBoundsOnModel.setRect(s),this._tmpBoundsOnModel.expand(s.width*o,s.height*o);const a=n.width/this._tmpBoundsOnModel.width,l=n.height/this._tmpBoundsOnModel.height;this._tmpMatrix.loadIdentity(),this._tmpMatrix.translateRelative(-1,-1),this._tmpMatrix.scaleRelative(2,2),this._tmpMatrix.translateRelative(n.x,n.y),this._tmpMatrix.scaleRelative(a,l),this._tmpMatrix.translateRelative(-this._tmpBoundsOnModel.x,-this._tmpBoundsOnModel.y),this._tmpMatrixForMask.setMatrix(this._tmpMatrix.getArray()),this._tmpMatrix.loadIdentity(),this._tmpMatrix.translateRelative(n.x,n.y),this._tmpMatrix.scaleRelative(a,l),this._tmpMatrix.translateRelative(-this._tmpBoundsOnModel.x,-this._tmpBoundsOnModel.y),this._tmpMatrixForDraw.setMatrix(this._tmpMatrix.getArray()),r._matrixForMask.setMatrix(this._tmpMatrixForMask.getArray()),r._matrixForDraw.setMatrix(this._tmpMatrixForDraw.getArray());const h=r._clippingIdCount;for(let i=0;i<h;i++){const s=r._clippingIdList[i];t.getDrawableDynamicFlagVertexPositionsDidChange(s)&&(e.setIsCulling(0!=t.getDrawableCulling(s)),e.setClippingContextBufferForMask(r),e.drawMesh(t.getDrawableTextureIndices(s),t.getDrawableVertexIndexCount(s),t.getDrawableVertexCount(s),t.getDrawableVertexIndices(s),t.getDrawableVertices(s),t.getDrawableVertexUvs(s),t.getDrawableOpacity(s),be.CubismBlendMode_Normal,!1))}}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,r),e.setClippingContextBufferForMask(null),this.gl.viewport(i[0],i[1],i[2],i[3])}}findSameClip(t,e){for(let i=0;i<this._clippingContextListForMask.getSize();i++){const r=this._clippingContextListForMask.at(i),s=r._clippingIdCount;if(s!=e)continue;let n=0;for(let e=0;e<s;e++){const i=r._clippingIdList[e];for(let e=0;e<s;e++)if(t[e]==i){n++;break}}if(n==s)return r}return null}setupLayoutBounds(t){let e=t/4,i=t%4;e=~~e,i=~~i;let r=0;for(let t=0;t<4;t++){const s=e+(t<i?1:0);if(0==s);else if(1==s){const e=this._clippingContextListForMask.at(r++);e._layoutChannelNo=t,e._layoutBounds.x=0,e._layoutBounds.y=0,e._layoutBounds.width=1,e._layoutBounds.height=1}else if(2==s)for(let e=0;e<s;e++){let i=e%2;i=~~i;const s=this._clippingContextListForMask.at(r++);s._layoutChannelNo=t,s._layoutBounds.x=.5*i,s._layoutBounds.y=0,s._layoutBounds.width=.5,s._layoutBounds.height=1}else if(s<=4)for(let e=0;e<s;e++){let i=e%2,s=e/2;i=~~i,s=~~s;const n=this._clippingContextListForMask.at(r++);n._layoutChannelNo=t,n._layoutBounds.x=.5*i,n._layoutBounds.y=.5*s,n._layoutBounds.width=.5,n._layoutBounds.height=.5}else if(s<=9)for(let e=0;e<s;e++){let i=e%3,s=e/3;i=~~i,s=~~s;const n=this._clippingContextListForMask.at(r++);n._layoutChannelNo=t,n._layoutBounds.x=i/3,n._layoutBounds.y=s/3,n._layoutBounds.width=1/3,n._layoutBounds.height=1/3}else _("not supported mask count : {0}",s)}}getColorBuffer(){return this._colorBuffer}getClippingContextListForDraw(){return this._clippingContextListForDraw}setClippingMaskBufferSize(t){this._clippingMaskBufferSize=t}getClippingMaskBufferSize(){return this._clippingMaskBufferSize}}t.CubismClippingManager_WebGL=n;class o{constructor(t,e){this.frameNo=t,this.texture=e}}t.CubismRenderTextureResource=o;class a{constructor(t,e,i){this._owner=t,this._clippingIdList=e,this._clippingIdCount=i,this._allClippedDrawRect=new we,this._layoutBounds=new we,this._clippedDrawableIndexList=[],this._matrixForMask=new Me,this._matrixForDraw=new Me}release(){null!=this._layoutBounds&&(this._layoutBounds=null),null!=this._allClippedDrawRect&&(this._allClippedDrawRect=null),null!=this._clippedDrawableIndexList&&(this._clippedDrawableIndexList=null)}addClippedDrawable(t){this._clippedDrawableIndexList.push(t)}getClippingManager(){return this._owner}setGl(t){this._owner.setGL(t)}}t.CubismClippingContext=a;class l{constructor(){this._shaderSets=new Ce}static getInstance(){return null==e?(e=new l,e):e}static deleteInstance(){e&&(e.release(),e=null)}release(){this.releaseShaderProgram()}setupShaderProgram(t,e,i,r,n,o,a,l,u,c,g,p,d){let f,m,$,y;if(g||_("NoPremultipliedAlpha is not allowed"),0==this._shaderSets.getSize()&&this.generateShaders(),null!=t.getClippingContextBufferForMask()){const i=this._shaderSets.at(s.ShaderNames_SetupMask);this.gl.useProgram(i.shaderProgram),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.uniform1i(i.samplerTexture0Location,0),null==a.vertex&&(a.vertex=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,a.vertex),this.gl.bufferData(this.gl.ARRAY_BUFFER,r,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(i.attributePositionLocation),this.gl.vertexAttribPointer(i.attributePositionLocation,2,this.gl.FLOAT,!1,0,0),null==a.uv&&(a.uv=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,a.uv),this.gl.bufferData(this.gl.ARRAY_BUFFER,o,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(i.attributeTexCoordLocation),this.gl.vertexAttribPointer(i.attributeTexCoordLocation,2,this.gl.FLOAT,!1,0,0);const n=t.getClippingContextBufferForMask()._layoutChannelNo,l=t.getClippingContextBufferForMask().getClippingManager().getChannelFlagAsColor(n);this.gl.uniform4f(i.uniformChannelFlagLocation,l.R,l.G,l.B,l.A),this.gl.uniformMatrix4fv(i.uniformClipMatrixLocation,!1,t.getClippingContextBufferForMask()._matrixForMask.getArray());const h=t.getClippingContextBufferForMask()._layoutBounds;this.gl.uniform4f(i.uniformBaseColorLocation,2*h.x-1,2*h.y-1,2*h.getRight()-1,2*h.getBottom()-1),f=this.gl.ZERO,m=this.gl.ONE_MINUS_SRC_COLOR,$=this.gl.ZERO,y=this.gl.ONE_MINUS_SRC_ALPHA}else{const i=null!=t.getClippingContextBufferForDraw(),n=i?d?2:1:0;let l=new h;switch(u){case be.CubismBlendMode_Normal:default:l=this._shaderSets.at(s.ShaderNames_NormalPremultipliedAlpha+n),f=this.gl.ONE,m=this.gl.ONE_MINUS_SRC_ALPHA,$=this.gl.ONE,y=this.gl.ONE_MINUS_SRC_ALPHA;break;case be.CubismBlendMode_Additive:l=this._shaderSets.at(s.ShaderNames_AddPremultipliedAlpha+n),f=this.gl.ONE,m=this.gl.ONE,$=this.gl.ZERO,y=this.gl.ONE;break;case be.CubismBlendMode_Multiplicative:l=this._shaderSets.at(s.ShaderNames_MultPremultipliedAlpha+n),f=this.gl.DST_COLOR,m=this.gl.ONE_MINUS_SRC_ALPHA,$=this.gl.ZERO,y=this.gl.ONE}if(this.gl.useProgram(l.shaderProgram),null==a.vertex&&(a.vertex=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,a.vertex),this.gl.bufferData(this.gl.ARRAY_BUFFER,r,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(l.attributePositionLocation),this.gl.vertexAttribPointer(l.attributePositionLocation,2,this.gl.FLOAT,!1,0,0),null==a.uv&&(a.uv=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,a.uv),this.gl.bufferData(this.gl.ARRAY_BUFFER,o,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(l.attributeTexCoordLocation),this.gl.vertexAttribPointer(l.attributeTexCoordLocation,2,this.gl.FLOAT,!1,0,0),i){this.gl.activeTexture(this.gl.TEXTURE1);const e=t.getClippingContextBufferForDraw().getClippingManager().getColorBuffer();this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.uniform1i(l.samplerTexture1Location,1),this.gl.uniformMatrix4fv(l.uniformClipMatrixLocation,!1,t.getClippingContextBufferForDraw()._matrixForDraw.getArray());const i=t.getClippingContextBufferForDraw()._layoutChannelNo,r=t.getClippingContextBufferForDraw().getClippingManager().getChannelFlagAsColor(i);this.gl.uniform4f(l.uniformChannelFlagLocation,r.R,r.G,r.B,r.A)}this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.uniform1i(l.samplerTexture0Location,0),this.gl.uniformMatrix4fv(l.uniformMatrixLocation,!1,p.getArray()),this.gl.uniform4f(l.uniformBaseColorLocation,c.R,c.G,c.B,c.A)}null==a.index&&(a.index=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,a.index),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,n,this.gl.DYNAMIC_DRAW),this.gl.blendFuncSeparate(f,m,$,y)}releaseShaderProgram(){for(let t=0;t<this._shaderSets.getSize();t++)this.gl.deleteProgram(this._shaderSets.at(t).shaderProgram),this._shaderSets.at(t).shaderProgram=0,this._shaderSets.set(t,void 0),this._shaderSets.set(t,null)}generateShaders(){for(let t=0;t<10;t++)this._shaderSets.pushBack(new h);this._shaderSets.at(0).shaderProgram=this.loadShaderProgram(t.vertexShaderSrcSetupMask,t.fragmentShaderSrcsetupMask),this._shaderSets.at(1).shaderProgram=this.loadShaderProgram(t.vertexShaderSrc,t.fragmentShaderSrcPremultipliedAlpha),this._shaderSets.at(2).shaderProgram=this.loadShaderProgram(t.vertexShaderSrcMasked,t.fragmentShaderSrcMaskPremultipliedAlpha),this._shaderSets.at(3).shaderProgram=this.loadShaderProgram(t.vertexShaderSrcMasked,t.fragmentShaderSrcMaskInvertedPremultipliedAlpha),this._shaderSets.at(4).shaderProgram=this._shaderSets.at(1).shaderProgram,this._shaderSets.at(5).shaderProgram=this._shaderSets.at(2).shaderProgram,this._shaderSets.at(6).shaderProgram=this._shaderSets.at(3).shaderProgram,this._shaderSets.at(7).shaderProgram=this._shaderSets.at(1).shaderProgram,this._shaderSets.at(8).shaderProgram=this._shaderSets.at(2).shaderProgram,this._shaderSets.at(9).shaderProgram=this._shaderSets.at(3).shaderProgram,this._shaderSets.at(0).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(0).shaderProgram,"a_position"),this._shaderSets.at(0).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(0).shaderProgram,"a_texCoord"),this._shaderSets.at(0).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"s_texture0"),this._shaderSets.at(0).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_clipMatrix"),this._shaderSets.at(0).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_channelFlag"),this._shaderSets.at(0).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_baseColor"),this._shaderSets.at(1).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(1).shaderProgram,"a_position"),this._shaderSets.at(1).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(1).shaderProgram,"a_texCoord"),this._shaderSets.at(1).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"s_texture0"),this._shaderSets.at(1).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"u_matrix"),this._shaderSets.at(1).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"u_baseColor"),this._shaderSets.at(2).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(2).shaderProgram,"a_position"),this._shaderSets.at(2).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(2).shaderProgram,"a_texCoord"),this._shaderSets.at(2).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"s_texture0"),this._shaderSets.at(2).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"s_texture1"),this._shaderSets.at(2).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_matrix"),this._shaderSets.at(2).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_clipMatrix"),this._shaderSets.at(2).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_channelFlag"),this._shaderSets.at(2).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_baseColor"),this._shaderSets.at(3).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(3).shaderProgram,"a_position"),this._shaderSets.at(3).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(3).shaderProgram,"a_texCoord"),this._shaderSets.at(3).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"s_texture0"),this._shaderSets.at(3).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"s_texture1"),this._shaderSets.at(3).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_matrix"),this._shaderSets.at(3).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_clipMatrix"),this._shaderSets.at(3).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_channelFlag"),this._shaderSets.at(3).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_baseColor"),this._shaderSets.at(4).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(4).shaderProgram,"a_position"),this._shaderSets.at(4).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(4).shaderProgram,"a_texCoord"),this._shaderSets.at(4).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"s_texture0"),this._shaderSets.at(4).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"u_matrix"),this._shaderSets.at(4).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"u_baseColor"),this._shaderSets.at(5).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(5).shaderProgram,"a_position"),this._shaderSets.at(5).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(5).shaderProgram,"a_texCoord"),this._shaderSets.at(5).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"s_texture0"),this._shaderSets.at(5).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"s_texture1"),this._shaderSets.at(5).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_matrix"),this._shaderSets.at(5).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_clipMatrix"),this._shaderSets.at(5).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_channelFlag"),this._shaderSets.at(5).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_baseColor"),this._shaderSets.at(6).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(6).shaderProgram,"a_position"),this._shaderSets.at(6).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(6).shaderProgram,"a_texCoord"),this._shaderSets.at(6).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"s_texture0"),this._shaderSets.at(6).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"s_texture1"),this._shaderSets.at(6).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_matrix"),this._shaderSets.at(6).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_clipMatrix"),this._shaderSets.at(6).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_channelFlag"),this._shaderSets.at(6).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_baseColor"),this._shaderSets.at(7).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(7).shaderProgram,"a_position"),this._shaderSets.at(7).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(7).shaderProgram,"a_texCoord"),this._shaderSets.at(7).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"s_texture0"),this._shaderSets.at(7).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"u_matrix"),this._shaderSets.at(7).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"u_baseColor"),this._shaderSets.at(8).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(8).shaderProgram,"a_position"),this._shaderSets.at(8).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(8).shaderProgram,"a_texCoord"),this._shaderSets.at(8).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"s_texture0"),this._shaderSets.at(8).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"s_texture1"),this._shaderSets.at(8).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_matrix"),this._shaderSets.at(8).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_clipMatrix"),this._shaderSets.at(8).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_channelFlag"),this._shaderSets.at(8).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_baseColor"),this._shaderSets.at(9).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(9).shaderProgram,"a_position"),this._shaderSets.at(9).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(9).shaderProgram,"a_texCoord"),this._shaderSets.at(9).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"s_texture0"),this._shaderSets.at(9).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"s_texture1"),this._shaderSets.at(9).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_matrix"),this._shaderSets.at(9).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_clipMatrix"),this._shaderSets.at(9).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_channelFlag"),this._shaderSets.at(9).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_baseColor")}loadShaderProgram(t,e){let i=this.gl.createProgram(),r=this.compileShaderSource(this.gl.VERTEX_SHADER,t);if(!r)return _("Vertex shader compile error!"),0;let s=this.compileShaderSource(this.gl.FRAGMENT_SHADER,e);if(!s)return _("Vertex shader compile error!"),0;this.gl.attachShader(i,r),this.gl.attachShader(i,s),this.gl.linkProgram(i);return this.gl.getProgramParameter(i,this.gl.LINK_STATUS)?(this.gl.deleteShader(r),this.gl.deleteShader(s),i):(_("Failed to link program: {0}",i),this.gl.deleteShader(r),r=0,this.gl.deleteShader(s),s=0,i&&(this.gl.deleteProgram(i),i=0),0)}compileShaderSource(t,e){const i=e,r=this.gl.createShader(t);if(this.gl.shaderSource(r,i),this.gl.compileShader(r),!r){const t=this.gl.getShaderInfoLog(r);_("Shader compile log: {0} ",t)}return this.gl.getShaderParameter(r,this.gl.COMPILE_STATUS)?r:(this.gl.deleteShader(r),null)}setGl(t){this.gl=t}}t.CubismShader_WebGL=l;class h{}t.CubismShaderSet=h,function(t){t[t.ShaderNames_SetupMask=0]="ShaderNames_SetupMask",t[t.ShaderNames_NormalPremultipliedAlpha=1]="ShaderNames_NormalPremultipliedAlpha",t[t.ShaderNames_NormalMaskedPremultipliedAlpha=2]="ShaderNames_NormalMaskedPremultipliedAlpha",t[t.ShaderNames_NomralMaskedInvertedPremultipliedAlpha=3]="ShaderNames_NomralMaskedInvertedPremultipliedAlpha",t[t.ShaderNames_AddPremultipliedAlpha=4]="ShaderNames_AddPremultipliedAlpha",t[t.ShaderNames_AddMaskedPremultipliedAlpha=5]="ShaderNames_AddMaskedPremultipliedAlpha",t[t.ShaderNames_AddMaskedPremultipliedAlphaInverted=6]="ShaderNames_AddMaskedPremultipliedAlphaInverted",t[t.ShaderNames_MultPremultipliedAlpha=7]="ShaderNames_MultPremultipliedAlpha",t[t.ShaderNames_MultMaskedPremultipliedAlpha=8]="ShaderNames_MultMaskedPremultipliedAlpha",t[t.ShaderNames_MultMaskedPremultipliedAlphaInverted=9]="ShaderNames_MultMaskedPremultipliedAlphaInverted"}(s=t.ShaderNames||(t.ShaderNames={})),t.vertexShaderSrcSetupMask="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;varying vec4       v_myPos;uniform mat4       u_clipMatrix;void main(){   gl_Position = u_clipMatrix * a_position;   v_myPos = u_clipMatrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",t.fragmentShaderSrcsetupMask="precision mediump float;varying vec2       v_texCoord;varying vec4       v_myPos;uniform vec4       u_baseColor;uniform vec4       u_channelFlag;uniform sampler2D  s_texture0;void main(){   float isInside =        step(u_baseColor.x, v_myPos.x/v_myPos.w)       * step(u_baseColor.y, v_myPos.y/v_myPos.w)       * step(v_myPos.x/v_myPos.w, u_baseColor.z)       * step(v_myPos.y/v_myPos.w, u_baseColor.w);   gl_FragColor = u_channelFlag * texture2D(s_texture0, v_texCoord).a * isInside;}",t.vertexShaderSrc="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;uniform mat4       u_matrix;void main(){   gl_Position = u_matrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",t.vertexShaderSrcMasked="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;varying vec4       v_clipPos;uniform mat4       u_matrix;uniform mat4       u_clipMatrix;void main(){   gl_Position = u_matrix * a_position;   v_clipPos = u_clipMatrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",t.fragmentShaderSrcPremultipliedAlpha="precision mediump float;varying vec2       v_texCoord;uniform vec4       u_baseColor;uniform sampler2D  s_texture0;void main(){   gl_FragColor = texture2D(s_texture0 , v_texCoord) * u_baseColor;}",t.fragmentShaderSrcMaskPremultipliedAlpha="precision mediump float;varying vec2       v_texCoord;varying vec4       v_clipPos;uniform vec4       u_baseColor;uniform vec4       u_channelFlag;uniform sampler2D  s_texture0;uniform sampler2D  s_texture1;void main(){   vec4 col_formask = texture2D(s_texture0 , v_texCoord) * u_baseColor;   vec4 clipMask = (1.0 - texture2D(s_texture1, v_clipPos.xy / v_clipPos.w)) * u_channelFlag;   float maskVal = clipMask.r + clipMask.g + clipMask.b + clipMask.a;   col_formask = col_formask * maskVal;   gl_FragColor = col_formask;}",t.fragmentShaderSrcMaskInvertedPremultipliedAlpha="precision mediump float;varying vec2 v_texCoord;varying vec4 v_clipPos;uniform sampler2D s_texture0;uniform sampler2D s_texture1;uniform vec4 u_channelFlag;uniform vec4 u_baseColor;void main(){vec4 col_formask = texture2D(s_texture0, v_texCoord) * u_baseColor;vec4 clipMask = (1.0 - texture2D(s_texture1, v_clipPos.xy / v_clipPos.w)) * u_channelFlag;float maskVal = clipMask.r + clipMask.g + clipMask.b + clipMask.a;col_formask = col_formask * (1.0 - maskVal);gl_FragColor = col_formask;}";class u extends Le{constructor(){super(),this._clippingContextBufferForMask=null,this._clippingContextBufferForDraw=null,this._clippingManager=new n,this.firstDraw=!0,this._textures=new Ie,this._sortedDrawableIndexList=new Ce,this._bufferData={vertex:WebGLBuffer=null,uv:WebGLBuffer=null,index:WebGLBuffer=null},this._textures.prepareCapacity(32,!0)}initialize(t){t.isUsingMasking()&&(this._clippingManager=new n,this._clippingManager.initialize(t,t.getDrawableCount(),t.getDrawableMasks(),t.getDrawableMaskCounts())),this._sortedDrawableIndexList.resize(t.getDrawableCount(),0),super.initialize(t)}bindTexture(t,e){this._textures.setValue(t,e)}getBindedTextures(){return this._textures}setClippingMaskBufferSize(t){this._clippingManager.release(),this._clippingManager=void 0,this._clippingManager=null,this._clippingManager=new n,this._clippingManager.setClippingMaskBufferSize(t),this._clippingManager.initialize(this.getModel(),this.getModel().getDrawableCount(),this.getModel().getDrawableMasks(),this.getModel().getDrawableMaskCounts())}getClippingMaskBufferSize(){return this._clippingManager.getClippingMaskBufferSize()}release(){this._clippingManager.release(),this._clippingManager=void 0,this._clippingManager=null,this.gl.deleteBuffer(this._bufferData.vertex),this._bufferData.vertex=null,this.gl.deleteBuffer(this._bufferData.uv),this._bufferData.uv=null,this.gl.deleteBuffer(this._bufferData.index),this._bufferData.index=null,this._bufferData=null,this._textures=null}doDrawModel(){null!=this._clippingManager&&(this.preDraw(),this._clippingManager.setupClippingContext(this.getModel(),this)),this.preDraw();const t=this.getModel().getDrawableCount(),e=this.getModel().getDrawableRenderOrders();for(let i=0;i<t;++i){const t=e[i];this._sortedDrawableIndexList.set(t,i)}for(let e=0;e<t;++e){const t=this._sortedDrawableIndexList.at(e);this.getModel().getDrawableDynamicFlagIsVisible(t)&&(this.setClippingContextBufferForDraw(null!=this._clippingManager?this._clippingManager.getClippingContextListForDraw().at(t):null),this.setIsCulling(this.getModel().getDrawableCulling(t)),this.drawMesh(this.getModel().getDrawableTextureIndices(t),this.getModel().getDrawableVertexIndexCount(t),this.getModel().getDrawableVertexCount(t),this.getModel().getDrawableVertexIndices(t),this.getModel().getDrawableVertices(t),this.getModel().getDrawableVertexUvs(t),this.getModel().getDrawableOpacity(t),this.getModel().getDrawableBlendMode(t),this.getModel().getDrawableInvertedMaskBit(t)))}}drawMesh(t,e,i,r,s,n,o,a,h){this.isCulling()?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this.gl.frontFace(this.gl.CCW);const u=this.getModelColor();let _;null==this.getClippingContextBufferForMask()&&(u.A*=o,this.isPremultipliedAlpha()&&(u.R*=u.A,u.G*=u.A,u.B*=u.A)),_=null!=this._textures.getValue(t)?this._textures.getValue(t):null,l.getInstance().setupShaderProgram(this,_,i,s,r,n,this._bufferData,o,a,u,this.isPremultipliedAlpha(),this.getMvpMatrix(),h),this.gl.drawElements(this.gl.TRIANGLES,e,this.gl.UNSIGNED_SHORT,0),this.gl.useProgram(null),this.setClippingContextBufferForDraw(null),this.setClippingContextBufferForMask(null)}static doStaticRelease(){l.deleteInstance()}setRenderState(t,e){r=t,i=e}preDraw(){this.firstDraw&&(this.firstDraw=!1,this._anisortopy=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")),this.gl.disable(this.gl.SCISSOR_TEST),this.gl.disable(this.gl.STENCIL_TEST),this.gl.disable(this.gl.DEPTH_TEST),this.gl.frontFace(this.gl.CW),this.gl.enable(this.gl.BLEND),this.gl.colorMask(!0,!0,!0,!0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null)}setClippingContextBufferForMask(t){this._clippingContextBufferForMask=t}getClippingContextBufferForMask(){return this._clippingContextBufferForMask}setClippingContextBufferForDraw(t){this._clippingContextBufferForDraw=t}getClippingContextBufferForDraw(){return this._clippingContextBufferForDraw}startUp(t){this.gl=t,this._clippingManager.setGL(t),l.getInstance().setGl(t)}}t.CubismRenderer_WebGL=u,Le.staticRelease=()=>{u.doStaticRelease()}}(Pe||(Pe={}));var Be,Ae,Fe=Pe.CubismRenderer_WebGL,De=Se.CubismEyeBlink,Re=he.CubismBreath,Ve=I.Constant,Oe=le.CubismPhysics,Ne=Jt.CubismModelUserData,ke=Yt.CubismPose,Ue=Ot.CubismExpressionMotion,ze=Mt.CubismMotion,Ye=mt.CubismMoc,Ge=ut.CubismModelMatrix,Xe=lt.CubismTargetPoint,je=ot.CubismMotionManager;!function(t){class e{constructor(){this.loadMotion=(t,e,i,r)=>ze.create(t,e,r),this._moc=null,this._model=null,this._motionManager=null,this._expressionManager=null,this._eyeBlink=null,this._breath=null,this._modelMatrix=null,this._pose=null,this._dragManager=null,this._physics=null,this._modelUserData=null,this._initialized=!1,this._updating=!1,this._opacity=1,this._lipsync=!0,this._lastLipSyncValue=0,this._dragX=0,this._dragY=0,this._accelerationX=0,this._accelerationY=0,this._accelerationZ=0,this._debugMode=!1,this._renderer=null,this._motionManager=new je,this._motionManager.setEventCallback(e.cubismDefaultMotionEventCallback,this),this._expressionManager=new je,this._dragManager=new Xe}isInitialized(){return this._initialized}setInitialized(t){this._initialized=t}isUpdating(){return this._updating}setUpdating(t){this._updating=t}setDragging(t,e){this._dragManager.set(t,e)}setAcceleration(t,e,i){this._accelerationX=t,this._accelerationY=e,this._accelerationZ=i}getModelMatrix(){return this._modelMatrix}setOpacity(t){this._opacity=t}getOpacity(){return this._opacity}setZoom(t){this._zoom=t}loadModel(t){this._moc=Ye.create(t),this._model=this._moc.createModel(),this._model.saveParameters(),null!=this._moc&&null!=this._model?this._modelMatrix=new Ge(this._model.getCanvasWidth(),this._model.getCanvasHeight(),this._zoom):_("Failed to CreateModel().")}loadExpression(t,e,i){return Ue.create(t,e)}loadPose(t,e){this._pose=ke.create(t,e)}loadUserData(t,e){this._modelUserData=Ne.create(t,e)}loadPhysics(t,e){this._physics=Oe.create(t,e)}isHit(t,e,i){const r=this._model.getDrawableIndex(t);if(r<0)return!1;const s=this._model.getDrawableVertexCount(r),n=this._model.getDrawableVertices(r);let o=n[0],a=n[0],l=n[1],h=n[1];for(let t=1;t<s;++t){const e=n[Ve.vertexOffset+t*Ve.vertexStep],i=n[Ve.vertexOffset+t*Ve.vertexStep+1];e<o&&(o=e),e>a&&(a=e),i<l&&(l=i),i>h&&(h=i)}const u=this._modelMatrix.invertTransformX(e),_=this._modelMatrix.invertTransformY(i);return o<=u&&u<=a&&l<=_&&_<=h}getModel(){return this._model}getRenderer(){return this._renderer}createRenderer(){this._renderer&&this.deleteRenderer(),this._renderer=new Fe,this._renderer.initialize(this._model)}deleteRenderer(){null!=this._renderer&&(this._renderer.release(),this._renderer=null)}motionEventFired(t){h("{0}",t.s)}static cubismDefaultMotionEventCallback(t,e,i){null!=i&&i.motionEventFired(e)}release(){null!=this._motionManager&&(this._motionManager.release(),this._motionManager=null),null!=this._expressionManager&&(this._expressionManager.release(),this._expressionManager=null),null!=this._moc&&(this._moc.deleteModel(this._model),this._moc.release(),this._moc=null),this._modelMatrix=null,ke.delete(this._pose),De.delete(this._eyeBlink),Re.delete(this._breath),this._dragManager=null,Oe.delete(this._physics),Ne.delete(this._modelUserData),this.deleteRenderer()}}t.CubismUserModel=e}(Be||(Be={})),function(t){t.ICubismModelSetting=class{}}(Ae||(Ae={}));var He,qe,We=p.csmVector,Je=I.CubismFramework,Qe=d.CubismJson,Ze=Ae.ICubismModelSetting;!function(t){const e="Name";let i;!function(t){t[t.FrequestNode_Groups=0]="FrequestNode_Groups",t[t.FrequestNode_Moc=1]="FrequestNode_Moc",t[t.FrequestNode_Motions=2]="FrequestNode_Motions",t[t.FrequestNode_Expressions=3]="FrequestNode_Expressions",t[t.FrequestNode_Textures=4]="FrequestNode_Textures",t[t.FrequestNode_Physics=5]="FrequestNode_Physics",t[t.FrequestNode_Pose=6]="FrequestNode_Pose",t[t.FrequestNode_HitAreas=7]="FrequestNode_HitAreas"}(i||(i={}));t.CubismModelSettingJson=class extends Ze{constructor(t,e){super(),this._json=Qe.create(t,e),this._json&&(this._jsonValue=new We,this._jsonValue.pushBack(this._json.getRoot().getValueByString("Groups")),this._jsonValue.pushBack(this._json.getRoot().getValueByString("FileReferences").getValueByString("Moc")),this._jsonValue.pushBack(this._json.getRoot().getValueByString("FileReferences").getValueByString("Motions")),this._jsonValue.pushBack(this._json.getRoot().getValueByString("FileReferences").getValueByString("Expressions")),this._jsonValue.pushBack(this._json.getRoot().getValueByString("FileReferences").getValueByString("Textures")),this._jsonValue.pushBack(this._json.getRoot().getValueByString("FileReferences").getValueByString("Physics")),this._jsonValue.pushBack(this._json.getRoot().getValueByString("FileReferences").getValueByString("Pose")),this._jsonValue.pushBack(this._json.getRoot().getValueByString("HitAreas")))}release(){Qe.delete(this._json),this._jsonValue=null}GetJson(){return this._json}getModelFileName(){return this.isExistModelFile()?this._jsonValue.at(i.FrequestNode_Moc).getRawString():""}getTextureCount(){return this.isExistTextureFiles()?this._jsonValue.at(i.FrequestNode_Textures).getSize():0}getTextureDirectory(){return this._jsonValue.at(i.FrequestNode_Textures).getRawString()}getTextureFileName(t){return this._jsonValue.at(i.FrequestNode_Textures).getValueByIndex(t).getRawString()}getHitAreasCount(){return this.isExistHitAreas()?this._jsonValue.at(i.FrequestNode_HitAreas).getSize():0}getHitAreaId(t){return Je.getIdManager().getId(this._jsonValue.at(i.FrequestNode_HitAreas).getValueByIndex(t).getValueByString("Id").getRawString())}getHitAreaName(t){return this._jsonValue.at(i.FrequestNode_HitAreas).getValueByIndex(t).getValueByString(e).getRawString()}getPhysicsFileName(){return this.isExistPhysicsFile()?this._jsonValue.at(i.FrequestNode_Physics).getRawString():""}getPoseFileName(){return this.isExistPoseFile()?this._jsonValue.at(i.FrequestNode_Pose).getRawString():""}getExpressionCount(){return this.isExistExpressionFile()?this._jsonValue.at(i.FrequestNode_Expressions).getSize():0}getExpressionName(t){return this._jsonValue.at(i.FrequestNode_Expressions).getValueByIndex(t).getValueByString(e).getRawString()}getExpressionFileName(t){return this._jsonValue.at(i.FrequestNode_Expressions).getValueByIndex(t).getValueByString("File").getRawString()}getMotionGroupCount(){return this.isExistMotionGroups()?this._jsonValue.at(i.FrequestNode_Motions).getKeys().getSize():0}getMotionGroupName(t){return this.isExistMotionGroups()?this._jsonValue.at(i.FrequestNode_Motions).getKeys().at(t):null}getMotionCount(t){return this.isExistMotionGroupName(t)?this._jsonValue.at(i.FrequestNode_Motions).getValueByString(t).getSize():0}getMotionFileName(t,e){return this.isExistMotionGroupName(t)?this._jsonValue.at(i.FrequestNode_Motions).getValueByString(t).getValueByIndex(e).getValueByString("File").getRawString():""}getMotionSoundFileName(t,e){return this.isExistMotionSoundFile(t,e)?this._jsonValue.at(i.FrequestNode_Motions).getValueByString(t).getValueByIndex(e).getValueByString("Sound").getRawString():""}getMotionFadeInTimeValue(t,e){return this.isExistMotionFadeIn(t,e)?this._jsonValue.at(i.FrequestNode_Motions).getValueByString(t).getValueByIndex(e).getValueByString("FadeInTime").toFloat():-1}getMotionFadeOutTimeValue(t,e){return this.isExistMotionFadeOut(t,e)?this._jsonValue.at(i.FrequestNode_Motions).getValueByString(t).getValueByIndex(e).getValueByString("FadeOutTime").toFloat():-1}getUserDataFile(){return this.isExistUserDataFile()?this._json.getRoot().getValueByString("FileReferences").getValueByString("UserData").getRawString():""}getLayoutMap(t){const e=this._json.getRoot().getValueByString("Layout").getMap();if(null==e)return!1;let i=!1;for(const r=e.begin();r.notEqual(e.end());r.preIncrement())t.setValue(r.ptr().first,r.ptr().second.toFloat()),i=!0;return i}getEyeBlinkParameterCount(){if(!this.isExistEyeBlinkParameters())return 0;let t=0;for(let r=0;r<this._jsonValue.at(i.FrequestNode_Groups).getSize();r++){const s=this._jsonValue.at(i.FrequestNode_Groups).getValueByIndex(r);if(!s.isNull()&&!s.isError()&&"EyeBlink"==s.getValueByString(e).getRawString()){t=s.getValueByString("Ids").getVector().getSize();break}}return t}getEyeBlinkParameterId(t){if(!this.isExistEyeBlinkParameters())return null;for(let r=0;r<this._jsonValue.at(i.FrequestNode_Groups).getSize();r++){const s=this._jsonValue.at(i.FrequestNode_Groups).getValueByIndex(r);if(!s.isNull()&&!s.isError()&&"EyeBlink"==s.getValueByString(e).getRawString())return Je.getIdManager().getId(s.getValueByString("Ids").getValueByIndex(t).getRawString())}return null}getLipSyncParameterCount(){if(!this.isExistLipSyncParameters())return 0;let t=0;for(let r=0;r<this._jsonValue.at(i.FrequestNode_Groups).getSize();r++){const s=this._jsonValue.at(i.FrequestNode_Groups).getValueByIndex(r);if(!s.isNull()&&!s.isError()&&"LipSync"==s.getValueByString(e).getRawString()){t=s.getValueByString("Ids").getVector().getSize();break}}return t}getLipSyncParameterId(t){if(!this.isExistLipSyncParameters())return null;for(let r=0;r<this._jsonValue.at(i.FrequestNode_Groups).getSize();r++){const s=this._jsonValue.at(i.FrequestNode_Groups).getValueByIndex(r);if(!s.isNull()&&!s.isError()&&"LipSync"==s.getValueByString(e).getRawString())return Je.getIdManager().getId(s.getValueByString("Ids").getValueByIndex(t).getRawString())}return null}isExistModelFile(){const t=this._jsonValue.at(i.FrequestNode_Moc);return!t.isNull()&&!t.isError()}isExistTextureFiles(){const t=this._jsonValue.at(i.FrequestNode_Textures);return!t.isNull()&&!t.isError()}isExistHitAreas(){const t=this._jsonValue.at(i.FrequestNode_HitAreas);return!t.isNull()&&!t.isError()}isExistPhysicsFile(){const t=this._jsonValue.at(i.FrequestNode_Physics);return!t.isNull()&&!t.isError()}isExistPoseFile(){const t=this._jsonValue.at(i.FrequestNode_Pose);return!t.isNull()&&!t.isError()}isExistExpressionFile(){const t=this._jsonValue.at(i.FrequestNode_Expressions);return!t.isNull()&&!t.isError()}isExistMotionGroups(){const t=this._jsonValue.at(i.FrequestNode_Motions);return!t.isNull()&&!t.isError()}isExistMotionGroupName(t){const e=this._jsonValue.at(i.FrequestNode_Motions).getValueByString(t);return!e.isNull()&&!e.isError()}isExistMotionSoundFile(t,e){const r=this._jsonValue.at(i.FrequestNode_Motions).getValueByString(t).getValueByIndex(e).getValueByString("Sound");return!r.isNull()&&!r.isError()}isExistMotionFadeIn(t,e){const r=this._jsonValue.at(i.FrequestNode_Motions).getValueByString(t).getValueByIndex(e).getValueByString("FadeInTime");return!r.isNull()&&!r.isError()}isExistMotionFadeOut(t,e){const r=this._jsonValue.at(i.FrequestNode_Motions).getValueByString(t).getValueByIndex(e).getValueByString("FadeOutTime");return!r.isNull()&&!r.isError()}isExistUserDataFile(){const t=this._json.getRoot().getValueByString("FileReferences").getValueByString("UserData");return!t.isNull()&&!t.isError()}isExistEyeBlinkParameters(){if(this._jsonValue.at(i.FrequestNode_Groups).isNull()||this._jsonValue.at(i.FrequestNode_Groups).isError())return!1;for(let t=0;t<this._jsonValue.at(i.FrequestNode_Groups).getSize();++t)if("EyeBlink"==this._jsonValue.at(i.FrequestNode_Groups).getValueByIndex(t).getValueByString(e).getRawString())return!0;return!1}isExistLipSyncParameters(){if(this._jsonValue.at(i.FrequestNode_Groups).isNull()||this._jsonValue.at(i.FrequestNode_Groups).isError())return!1;for(let t=0;t<this._jsonValue.at(i.FrequestNode_Groups).getSize();++t)if("LipSync"==this._jsonValue.at(i.FrequestNode_Groups).getValueByIndex(t).getValueByString(e).getRawString())return!0;return!1}}}(He||(He={})),function(t){t.HitAreaPrefix="HitArea",t.HitAreaHead="Head",t.HitAreaBody="Body",t.PartsIdCore="Parts01Core",t.PartsArmPrefix="Parts01Arm_",t.PartsArmLPrefix="Parts01ArmL_",t.PartsArmRPrefix="Parts01ArmR_",t.ParamAngleX="ParamAngleX",t.ParamAngleY="ParamAngleY",t.ParamAngleZ="ParamAngleZ",t.ParamEyeLOpen="ParamEyeLOpen",t.ParamEyeLSmile="ParamEyeLSmile",t.ParamEyeROpen="ParamEyeROpen",t.ParamEyeRSmile="ParamEyeRSmile",t.ParamEyeBallX="ParamEyeBallX",t.ParamEyeBallY="ParamEyeBallY",t.ParamEyeBallForm="ParamEyeBallForm",t.ParamBrowLY="ParamBrowLY",t.ParamBrowRY="ParamBrowRY",t.ParamBrowLX="ParamBrowLX",t.ParamBrowRX="ParamBrowRX",t.ParamBrowLAngle="ParamBrowLAngle",t.ParamBrowRAngle="ParamBrowRAngle",t.ParamBrowLForm="ParamBrowLForm",t.ParamBrowRForm="ParamBrowRForm",t.ParamMouthForm="ParamMouthForm",t.ParamMouthOpenY="ParamMouthOpenY",t.ParamCheek="ParamCheek",t.ParamBodyAngleX="ParamBodyAngleX",t.ParamBodyAngleY="ParamBodyAngleY",t.ParamBodyAngleZ="ParamBodyAngleZ",t.ParamBreath="ParamBreath",t.ParamArmLA="ParamArmLA",t.ParamArmRA="ParamArmRA",t.ParamArmLB="ParamArmLB",t.ParamArmRB="ParamArmRB",t.ParamHandL="ParamHandL",t.ParamHandR="ParamHandR",t.ParamHairFront="ParamHairFront",t.ParamHairSide="ParamHairSide",t.ParamHairBack="ParamHairBack",t.ParamHairFluffy="ParamHairFluffy",t.ParamShoulderY="ParamShoulderY",t.ParamBustX="ParamBustX",t.ParamBustY="ParamBustY",t.ParamBaseX="ParamBaseX",t.ParamBaseY="ParamBaseY",t.ParamNONE="NONE:"}(qe||(qe={}));class Ke{static loadFileAsBytes(t,e){fetch(t).then(t=>t.arrayBuffer()).then(t=>e(t,t.byteLength))}static getDeltaTime(){return this.s_deltaTime}static updateTime(){this.s_currentFrame=Date.now(),this.s_deltaTime=(this.s_currentFrame-this.s_lastFrame)/1e3,this.s_lastFrame=this.s_currentFrame}static printMessage(t){console.log(t)}static modelUrlVersion(t){let e=null;fetch(t,{mode:"cors",method:"GET"}).then((function(t){200===t.status&&(e=t.arrayBuffer)}));JSON.stringify(e);return 2}}Ke.lastUpdate=Date.now(),Ke.s_currentFrame=0,Ke.s_lastFrame=0,Ke.s_deltaTime=0;i(75);var ti,ei=rt.InvalidMotionQueueEntryHandleValue,ii=g.csmMap,ri=p.csmVector,si=he.CubismBreath,ni=he.BreathParameterData,oi=Se.CubismEyeBlink,ai=Z.ACubismMotion,li=I.CubismFramework,hi=Be.CubismUserModel,ui=He.CubismModelSettingJson,_i=qe;!function(t){t[t.LoadAssets=0]="LoadAssets",t[t.LoadModel=1]="LoadModel",t[t.WaitLoadModel=2]="WaitLoadModel",t[t.LoadExpression=3]="LoadExpression",t[t.WaitLoadExpression=4]="WaitLoadExpression",t[t.LoadPhysics=5]="LoadPhysics",t[t.WaitLoadPhysics=6]="WaitLoadPhysics",t[t.LoadPose=7]="LoadPose",t[t.WaitLoadPose=8]="WaitLoadPose",t[t.SetupEyeBlink=9]="SetupEyeBlink",t[t.SetupBreath=10]="SetupBreath",t[t.LoadUserData=11]="LoadUserData",t[t.WaitLoadUserData=12]="WaitLoadUserData",t[t.SetupEyeBlinkIds=13]="SetupEyeBlinkIds",t[t.SetupLipSyncIds=14]="SetupLipSyncIds",t[t.SetupLayout=15]="SetupLayout",t[t.LoadMotion=16]="LoadMotion",t[t.WaitLoadMotion=17]="WaitLoadMotion",t[t.CompleteInitialize=18]="CompleteInitialize",t[t.CompleteSetupModel=19]="CompleteSetupModel",t[t.LoadTexture=20]="LoadTexture",t[t.WaitLoadTexture=21]="WaitLoadTexture",t[t.CompleteSetup=22]="CompleteSetup"}(ti||(ti={}));class ci extends hi{constructor(){super(),this._motionFileName=new Map,this._modelSetting=null,this._modelHomeDir=null,this._userTimeSeconds=0,this._eyeBlinkIds=new ri,this._lipSyncIds=new ri,this._motions=new ii,this._expressions=new ii,this._hitArea=new ri,this._userArea=new ri,this._idParamAngleX=li.getIdManager().getId(_i.ParamAngleX),this._idParamAngleY=li.getIdManager().getId(_i.ParamAngleY),this._idParamAngleZ=li.getIdManager().getId(_i.ParamAngleZ),this._idParamEyeBallX=li.getIdManager().getId(_i.ParamEyeBallX),this._idParamEyeBallY=li.getIdManager().getId(_i.ParamEyeBallY),this._idParamBodyAngleX=li.getIdManager().getId(_i.ParamBodyAngleX),this._state=ti.LoadAssets,this._expressionCount=0,this._textureCount=0,this._motionCount=0,this._allMotionCount=0}loadAssets(t,e){this._modelHomeDir=t,fetch(`${this._modelHomeDir}/${e}`).then(t=>t.arrayBuffer()).then(t=>{const e=new ui(t,t.byteLength);this._state=ti.LoadModel,this.setupModel(e)})}loadUrlAssets(t,e){this._modelHomeDir=t,fetch(""+e).then(t=>t.arrayBuffer()).then(t=>{const e=new ui(t,t.byteLength);this._state=ti.LoadModel,this.setupModel(e)})}setupModel(t){if(this._updating=!0,this._initialized=!1,this._modelSetting=t,""!=this._modelSetting.getModelFileName()){const t=this._modelSetting.getModelFileName();fetch(`${this._modelHomeDir}/${t}`).then(t=>t.arrayBuffer()).then(t=>{this.loadModel(t),this._state=ti.LoadExpression,e()}),this._state=ti.WaitLoadModel}else Ke.printMessage("Model data does not exist.");const e=()=>{if(this._modelSetting.getExpressionCount()>0){const t=this._modelSetting.getExpressionCount();for(let e=0;e<t;e++){const r=this._modelSetting.getExpressionName(e),s=this._modelSetting.getExpressionFileName(e);fetch(`${this._modelHomeDir}/${s}`).then(t=>t.arrayBuffer()).then(e=>{const s=this.loadExpression(e,e.byteLength,r);null!=this._expressions.getValue(r)&&(ai.delete(this._expressions.getValue(r)),this._expressions.setValue(r,null)),this._expressions.setValue(r,s),this._expressionCount++,this._expressionCount>=t&&(this._state=ti.LoadPhysics,i())})}this._state=ti.WaitLoadExpression}else this._state=ti.LoadPhysics,i()},i=()=>{if(""!=this._modelSetting.getPhysicsFileName()){const t=this._modelSetting.getPhysicsFileName();fetch(`${this._modelHomeDir}/${t}`).then(t=>t.arrayBuffer()).then(t=>{this.loadPhysics(t,t.byteLength),this._state=ti.LoadPose,r()}),this._state=ti.WaitLoadPhysics}else this._state=ti.LoadPose,r()},r=()=>{if(""!=this._modelSetting.getPoseFileName()){const t=this._modelSetting.getPoseFileName();fetch(`${this._modelHomeDir}/${t}`).then(t=>t.arrayBuffer()).then(t=>{this.loadPose(t,t.byteLength),this._state=ti.SetupEyeBlink,s()}),this._state=ti.WaitLoadPose}else this._state=ti.SetupEyeBlink,s()},s=()=>{this._modelSetting.getEyeBlinkParameterCount()>0&&(this._eyeBlink=oi.create(this._modelSetting),this._state=ti.SetupBreath),n()},n=()=>{this._breath=si.create();const t=new ri;t.pushBack(new ni(this._idParamAngleX,0,15,6.5345,.5)),t.pushBack(new ni(this._idParamAngleY,0,8,3.5345,.5)),t.pushBack(new ni(this._idParamAngleZ,0,10,5.5345,.5)),t.pushBack(new ni(this._idParamBodyAngleX,0,4,15.5345,.5)),t.pushBack(new ni(li.getIdManager().getId(_i.ParamBreath),0,.5,3.2345,.5)),this._breath.setParameters(t),this._state=ti.LoadUserData,o()},o=()=>{if(""!=this._modelSetting.getUserDataFile()){const t=this._modelSetting.getUserDataFile();fetch(`${this._modelHomeDir}/${t}`).then(t=>t.arrayBuffer()).then(t=>{this.loadUserData(t,t.byteLength),this._state=ti.SetupEyeBlinkIds,a()}),this._state=ti.WaitLoadUserData}else this._state=ti.SetupEyeBlinkIds,a()},a=()=>{const t=this._modelSetting.getEyeBlinkParameterCount();for(let e=0;e<t;++e)this._eyeBlinkIds.pushBack(this._modelSetting.getEyeBlinkParameterId(e));this._state=ti.SetupLipSyncIds,l()},l=()=>{const t=this._modelSetting.getLipSyncParameterCount();for(let e=0;e<t;++e)this._lipSyncIds.pushBack(this._modelSetting.getLipSyncParameterId(e));this._state=ti.SetupLayout,h()},h=()=>{const t=new ii;this._modelSetting.getLayoutMap(t),this._modelMatrix.setupFromLayout(t),this._state=ti.LoadMotion,u()},u=()=>{this._state=ti.WaitLoadMotion,this._model.saveParameters(),this._allMotionCount=0,this._motionCount=0;const t=[],e=this._modelSetting.getMotionGroupCount();for(let i=0;i<e;i++)t[i]=this._modelSetting.getMotionGroupName(i),this._allMotionCount+=this._modelSetting.getMotionCount(t[i]);for(let i=0;i<e;i++)this.preLoadMotionGroup(t[i]);0==e&&this.restartMotion()}}setupTextures(){if(this._state==ti.LoadTexture){const t=this._modelSetting.getTextureCount();for(let e=0;e<t;e++){if(""==this._modelSetting.getTextureFileName(e)){console.log("getTextureFileName null");continue}let i=this._modelSetting.getTextureFileName(e);i=this._modelHomeDir+i;const r=i=>{this.getRenderer().bindTexture(e,i.id),this._textureCount++,this._textureCount>=t&&(this._state=ti.CompleteSetup)};Ci.getInstance().getTextureManager().createTextureFromPngFile(i,!0,r),this.getRenderer().setIsPremultipliedAlpha(!0)}this._state=ti.WaitLoadTexture}}reloadRenderer(){this.deleteRenderer(),this.createRenderer(),this.setupTextures()}update(){if(this._state!=ti.CompleteSetup)return;const t=Ke.getDeltaTime();this._userTimeSeconds+=t,this._dragManager.update(t),this._dragX=this._dragManager.getX(),this._dragY=this._dragManager.getY();let e=!1;if(this._model.loadParameters(),this._motionManager.isFinished()?this.startRandomMotion("Idle",1):e=this._motionManager.updateMotion(this._model,t),this._model.saveParameters(),e||null!=this._eyeBlink&&this._eyeBlink.updateParameters(this._model,t),null!=this._expressionManager&&this._expressionManager.updateMotion(this._model,t),this._model.addParameterValueById(this._idParamAngleX,30*this._dragX),this._model.addParameterValueById(this._idParamAngleY,30*this._dragY),this._model.addParameterValueById(this._idParamAngleZ,this._dragX*this._dragY*-30),this._model.addParameterValueById(this._idParamBodyAngleX,10*this._dragX),this._model.addParameterValueById(this._idParamEyeBallX,this._dragX),this._model.addParameterValueById(this._idParamEyeBallY,this._dragY),null!=this._breath&&this._breath.updateParameters(this._model,t),null!=this._physics&&this._physics.evaluate(this._model,t),this._lipsync){const t=0;for(let e=0;e<this._lipSyncIds.getSize();++e)this._model.addParameterValueById(this._lipSyncIds.at(e),t,.8)}null!=this._pose&&this._pose.updateParameters(this._model,t),this._model.update()}startMotion(t,e,i,r){if(3==i)this._motionManager.setReservePriority(i);else if(!this._motionManager.reserveMotion(i))return this._debugMode&&Ke.printMessage("[APP]can't start motion."),ei;const s=this._modelSetting.getMotionFileName(t,e),n=`${t}_${e}`;let o=this._motions.getValue(n),a=!1;return null==o?fetch(`${this._modelHomeDir}/${s}`).then(t=>t.arrayBuffer()).then(i=>{o=this.loadMotion(i,i.byteLength,null,r);let s=this._modelSetting.getMotionFadeInTimeValue(t,e);s>=0&&o.setFadeInTime(s),s=this._modelSetting.getMotionFadeOutTimeValue(t,e),s>=0&&o.setFadeOutTime(s),o.setEffectIds(this._eyeBlinkIds,this._lipSyncIds),a=!0}):o.setFinishedMotionHandler(r),this._debugMode&&Ke.printMessage(`[APP]start motion: [${t}_${e}`),this._motionManager.startMotionPriority(o,a,i)}startMotionFile(t,e,i){if(3==e)this._motionManager.setReservePriority(e);else if(!this._motionManager.reserveMotion(e))return this._debugMode&&Ke.printMessage("[APP]can't start motion."),ei;const r=this._motionFileName.get(t);let s=!1;fetch(`${this._modelHomeDir}/${r}`).then(t=>t.arrayBuffer()).then(n=>{const o=this.loadMotion(n,n.byteLength,t,i);return o.setEffectIds(this._eyeBlinkIds,this._lipSyncIds),s=!0,this._debugMode&&Ke.printMessage("[APP]start motion in File: ["+r),this._motionManager.startMotionPriority(o,s,e)})}startRandomMotion(t,e,i){if(0==this._modelSetting.getMotionCount(t))return ei;const r=Math.floor(Math.random()*this._modelSetting.getMotionCount(t));return this.startMotion(t,r,e,i)}setExpression(t){const e=this._expressions.getValue(t);this._debugMode&&Ke.printMessage(`[APP]expression: [${t}]`),null!=e?this._expressionManager.startMotionPriority(e,!1,3):this._debugMode&&Ke.printMessage(`[APP]expression[${t}] is null`)}setRandomExpression(){if(0==this._expressions.getSize())return;const t=Math.floor(Math.random()*this._expressions.getSize());for(let e=0;e<this._expressions.getSize();e++)if(e==t){const t=this._expressions._keyValues[e].first;return void this.setExpression(t)}}motionEventFired(t){}hitTest(t,e,i){if(this._opacity<1)return!1;try{const r=this._modelSetting.getHitAreasCount();for(let s=0;s<r;s++)if(this._modelSetting.getHitAreaName(s)==t){const t=this._modelSetting.getHitAreaId(s);return this.isHit(t,e,i)}}catch(t){console.log("数据可能还没有准备好"+t)}return!1}hitTestDefine(t,e,i){if(this._opacity<1)return!1;let r=t.split("_");for(let t=0;t<r.length;t++)r[t]=r[t].charAt(0).toUpperCase()+r[t].slice(1);let s=r.join("");const n=li.getIdManager().getId(s);return this.isHit(n,e,i)}preLoadMotionGroup(t){for(let e=0;e<this._modelSetting.getMotionCount(t);e++){const i=this._modelSetting.getMotionFileName(t,e);let r="";if(""==t){let t=i.lastIndexOf("/"),e=i.indexOf(".");r=""+i.substring(t+1,e),this._motionFileName.set(r,i),this.restartMotion()}else r=`${t}_${e}`,this._debugMode&&Ke.printMessage(`[APP]load motion: ${i} => [${r}]`),fetch(`${this._modelHomeDir}/${i}`).then(t=>t.arrayBuffer()).then(i=>{const s=this.loadMotion(i,i.byteLength,r);let n=this._modelSetting.getMotionFadeInTimeValue(t,e);n>=0&&s.setFadeInTime(n),n=this._modelSetting.getMotionFadeOutTimeValue(t,e),n>=0&&s.setFadeOutTime(n),s.setEffectIds(this._eyeBlinkIds,this._lipSyncIds),null!=this._motions.getValue(r)&&ai.delete(this._motions.getValue(r)),this._motions.setValue(r,s),this._motionCount++,this._motionCount>=this._allMotionCount&&this.restartMotion()})}}restartMotion(){this._state=ti.LoadTexture,this._motionManager.stopAllMotions(),this._updating=!1,this._initialized=!0,this.createRenderer(),this.setupTextures(),this.getRenderer().startUp(Mi)}releaseMotions(){this._motions.clear()}releaseExpressions(){this._expressions.clear()}doDraw(){if(null==this._model)return;const t=[0,0,Pi.width,Pi.height];this.getRenderer().setRenderState(wi,t),this.getRenderer().drawModel()}draw(t){null!=this._model&&this._state==ti.CompleteSetup&&(t.multiplyByMatrix(this._modelMatrix),this.getRenderer().setMvpMatrix(t),this.doDraw())}}var gi=v.CubismMatrix44;let pi=null;class di{constructor(t){this._finishedMotion=t=>{0};const e=k,i=e.substring(0,e.lastIndexOf("/")+1);if(this._viewMatrix=new gi,this._model=new ci,this._model.setZoom(t),e.indexOf("model3.json")>0){const t=e.substring(e.lastIndexOf("/")+1);this._model.loadAssets(i,t)}else this._model.loadUrlAssets(i,e)}static getInstance(t){return null==pi&&(pi=new di(t)),pi}static releaseInstance(){null!=pi&&(pi=void 0),pi=null}releaseAllModel(){this._model.release()}onDrag(t,e){this._model&&this._model.setDragging(t,e)}onTap(t,e,i){if(this._model.hitTest("Head",t,e))this._model.setRandomExpression();else if(this._model.hitTest("Body",t,e))this._model.startRandomMotion("TapBody",2,this._finishedMotion);else for(let r=0;r<i.length;r++)this._model.hitTestDefine(i[r],t,e)&&this._model.startMotionFile(i[r],2,this._finishedMotion)}onUpdate(){let t=new gi;const{width:e,height:i}=Pi;t.scale(1,e/i),null!=this._viewMatrix&&t.multiplyByMatrix(this._viewMatrix);const r=t.clone(),s=this._model;t=r.clone(),s.update(),s.draw(t)}}var fi=j.CubismViewMatrix,mi=v.CubismMatrix44;class $i{constructor(){this._programId=null,this._back=null,this._gear=null,this._hitAreaList=null,this._touchManager=new W,this._deviceToScreen=new mi,this._viewMatrix=new fi,this._zoom=1,this._head_pos=.5}initialize(){const{width:t,height:e}=Pi,i=e/t,r=-i,s=i;this._viewMatrix.setScreenRect(-1,1,r,s);const n=Math.abs(-2);this._deviceToScreen.scaleRelative(n/t,-n/t),this._deviceToScreen.translateRelative(.5*-t,.5*-e),this._viewMatrix.setMaxScale(2),this._viewMatrix.setMinScale(.8),this._viewMatrix.setMaxScreenRect(-2,2,-2,2)}release(){this._viewMatrix=null,this._touchManager=null,this._deviceToScreen=null,this._gear&&(this._gear.release(),this._gear=null),this._back&&(this._back.release(),this._back=null),Mi.deleteProgram(this._programId),this._programId=null}render(){Mi.useProgram(this._programId),this._back&&this._back.render(this._programId),this._gear&&this._gear.render(this._programId),Mi.flush();di.getInstance(this._zoom).onUpdate()}initializeSprite(){null==this._programId&&(this._programId=Ci.getInstance().createShader())}onTouchesBegan(t,e){this._touchManager.touchesBegan(t,e)}onTouchesMoved(t,e,i){const r=this.transformScreenX(t-i.left),s=this.transformScreenY(e-i.top),n=this.transformRect({x:i.left+i.width/2,y:i.top+i.height*this._head_pos},{x:t,y:e},i),o=this.transformViewX(n.x-i.left),a=this.transformViewY(n.y-i.top);this._touchManager.touchesMoved(r,s);di.getInstance(this._zoom).onDrag(o,a)}onTouchesEnded(t,e){const i=di.getInstance(this._zoom);i.onDrag(0,0);{const r=this._deviceToScreen.transformX(t),s=this._deviceToScreen.transformY(e);0,i.onTap(r,s,this._hitAreaList)}}transformViewX(t){const e=this._deviceToScreen.transformX(t);return this._viewMatrix.invertTransformX(e)}transformViewY(t){const e=this._deviceToScreen.transformY(t);return this._viewMatrix.invertTransformY(e)}transformScreenX(t){return this._deviceToScreen.transformX(t)}transformScreenY(t){return this._deviceToScreen.transformY(t)}transformRect(t,e,i){if(e.x<i.left+i.width&&e.y<i.top+i.height&&e.x>i.left&&e.y>i.top)return e;let r=t.x-e.x,s=t.y-e.y;function n(t,e){return 180*Math.acos($i.dot({x:0,y:1},$i.normalize(t,e)))/Math.PI}let o=n(r,s);e.x<t.x&&(o=360-o);let a=360-n(i.left-t.x,-1*(i.top-t.y)),l=360-n(i.left-t.x,-1*(i.top+i.height-t.y)),h=n(i.left+i.width-t.x,-1*(i.top-t.y)),u=n(i.left+i.width-t.x,-1*(i.top+i.height-t.y)),_=s/r,c={};if(o<h){let e=i.top-t.y,r=e/_;c={y:t.y+e,x:t.x+r}}else if(o<u){let e=i.left+i.width-t.x,r=e*_;c={y:t.y+r,x:t.x+e}}else if(o<l){let e=i.top+i.height-t.y,r=e/_;c={y:t.y+e,x:t.x+r}}else if(o<a){let e=t.x-i.left,r=e*_;c={y:t.y-r,x:t.x-e}}else{let e=i.top-t.y,r=e/_;c={y:t.y+e,x:t.x+r}}return c}transformRange(t,e,i){let r={x:e.x-t.x,y:e.y-t.y},s=Math.sqrt(Math.pow(r.x,2)+Math.pow(r.y,2));return s>i?(r={x:r.x/s*i+t.x,y:r.y/s*i+t.y},r):e}static dot(t,e){return t.x*e.x+t.y*e.y}static normalize(t,e){let i=Math.sqrt(t*t+e*e);return{x:t/i,y:e/i}}}var yi=p.csmVector;class Si{constructor(){this._textures=new yi}release(){for(let t=this._textures.begin();t.notEqual(this._textures.end());t.preIncrement())Mi.deleteTexture(t.ptr().id);this._textures=null}createTextureFromPngFile(t,e,i){for(let r=this._textures.begin();r.notEqual(this._textures.end());r.preIncrement())if(r.ptr().fileName==t&&r.ptr().usePremultply==e)return r.ptr().img=new Image,r.ptr().img.crossOrigin="Anonymous",r.ptr().img.onload=()=>i(r.ptr()),void(r.ptr().img.src=t);const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=Mi.createTexture();Mi.bindTexture(Mi.TEXTURE_2D,s),Mi.texParameteri(Mi.TEXTURE_2D,Mi.TEXTURE_MIN_FILTER,Mi.LINEAR_MIPMAP_LINEAR),Mi.texParameteri(Mi.TEXTURE_2D,Mi.TEXTURE_MAG_FILTER,Mi.LINEAR),e&&Mi.pixelStorei(Mi.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),Mi.texImage2D(Mi.TEXTURE_2D,0,Mi.RGBA,Mi.RGBA,Mi.UNSIGNED_BYTE,r),Mi.generateMipmap(Mi.TEXTURE_2D),Mi.bindTexture(Mi.TEXTURE_2D,null);const n=new xi;null!=n&&(n.fileName=t,n.width=r.width,n.height=r.height,n.id=s,n.img=r,n.usePremultply=e,this._textures.pushBack(n)),i(n)},r.src=t}releaseTextures(){for(let t=0;t<this._textures.getSize();t++)this._textures.set(t,null);this._textures.clear()}releaseTextureByTexture(t){for(let e=0;e<this._textures.getSize();e++)if(this._textures.at(e).id==t){this._textures.set(e,null),this._textures.remove(e);break}}releaseTextureByFilePath(t){for(let e=0;e<this._textures.getSize();e++)if(this._textures.at(e).fileName==t){this._textures.set(e,null),this._textures.remove(e);break}}}class xi{constructor(){this.id=null,this.width=0,this.height=0}}var vi=I.CubismFramework;let Pi=null,Ti=null,Mi=null,wi=null,Ii=null;class Ci{constructor(){this._captured=!1,this._captureFrame=!1,this._mouseX=0,this._mouseY=0,this._isEnd=!1,this._cubismOption=new A,this._view=new $i,this._textureManager=new Si,this._zoom=1,this._head_pos=.5}static getInstance(){return null==Ti&&(Ti=new Ci),Ti}static releaseInstance(){null!=Ti&&Ti.release(),Ti=null}initialize(t){return Ii=t,Mi=function(t){for(var e=["webgl","experimental-webgl","webkit-3d","moz-webgl"],i=0;i<e.length;i++)try{var r=t.getContext(e[i],{premultipliedAlpha:!0});if(r)return r}catch(t){}return null}(Pi),Mi?(wi||(wi=Mi.getParameter(Mi.FRAMEBUFFER_BINDING)),Mi.enable(Mi.BLEND),Mi.blendFunc(Mi.SRC_ALPHA,Mi.ONE_MINUS_SRC_ALPHA),this._view.initialize(),this.initializeCubism(),!0):(alert("Cannot initialize WebGL. This browser does not support."),Mi=null,document.body.innerHTML="This browser does not support the <code>&lt;canvas&gt;</code> element.",!1)}release(){this._textureManager.release(),this._textureManager=null,this._view.release(),this._view=null,di.releaseInstance(),vi.dispose()}run(){const t=()=>{if(null!=Ti){if(Ke.updateTime(),Mi.clearColor(0,0,0,0),Mi.enable(Mi.DEPTH_TEST),Mi.depthFunc(Mi.LEQUAL),Mi.clear(Mi.COLOR_BUFFER_BIT|Mi.DEPTH_BUFFER_BIT),Mi.clearDepth(1),Mi.enable(Mi.BLEND),Mi.blendFunc(Mi.SRC_ALPHA,Mi.ONE_MINUS_SRC_ALPHA),this._view._zoom=this._zoom,this._view._head_pos=this._head_pos,this._view._hitAreaList=this._hitAreaList,this._view.render(),this._captureFrame){this._captureFrame=!1;var e=document.createElement("a");document.body.appendChild(e),e.setAttribute("type","hidden"),e.href=Pi.toDataURL(),e.download=this._captureName||"live2d.png",e.click()}requestAnimationFrame(t)}};t()}createShader(){const t=Mi.createShader(Mi.VERTEX_SHADER);if(null==t)return Ke.printMessage("failed to create vertexShader"),null;Mi.shaderSource(t,"precision mediump float;attribute vec3 position;attribute vec2 uv;varying vec2 vuv;void main(void){   gl_Position = vec4(position, 1.0);   vuv = uv;}"),Mi.compileShader(t);const e=Mi.createShader(Mi.FRAGMENT_SHADER);if(null==e)return Ke.printMessage("failed to create fragmentShader"),null;Mi.shaderSource(e,"precision mediump float;varying vec2 vuv;uniform sampler2D texture;void main(void){   gl_FragColor = texture2D(texture, vuv);}"),Mi.compileShader(e);const i=Mi.createProgram();return Mi.attachShader(i,t),Mi.attachShader(i,e),Mi.deleteShader(t),Mi.deleteShader(e),Mi.linkProgram(i),Mi.useProgram(i),i}getView(){return this._view}getTextureManager(){return this._textureManager}initializeCubism(){this._cubismOption.logFunction=Ke.printMessage,this._cubismOption.loggingLevel=F,vi.startUp(this._cubismOption),vi.initialize(),k=Ii,di.getInstance(this._zoom),Ke.updateTime(),this._view.initializeSprite()}initL2dCanvas(t){Pi=document.getElementById(t);"ontouchend"in Pi?(Pi.ontouchstart=Bi,window.ontouchmove=Ai,Pi.ontouchend=Fi,Pi.ontouchcancel=Di):(Pi.onmousedown=Li,window.onmousemove=bi,Pi.onmouseup=Ei,document.onmouseleave=Ri)}}function Li(t){if(!Ci.getInstance()._view)return void Ke.printMessage("view notfound");Ci.getInstance()._captured=!0;const e=t.pageX,i=t.pageY;Ci.getInstance()._view.onTouchesBegan(e,i)}function bi(t){if(!Ci.getInstance()._view)return void Ke.printMessage("view notfound");const e=Pi.getBoundingClientRect();Ci.getInstance()._view.onTouchesMoved(t.clientX,t.clientY,e)}function Ei(t){if(Ci.getInstance()._captured=!1,!Ci.getInstance()._view)return void Ke.printMessage("view notfound");const e=t.target.getBoundingClientRect(),i=t.clientX-e.left,r=t.clientY-e.top;Ci.getInstance()._view.onTouchesEnded(i,r)}function Bi(t){if(!Ci.getInstance()._view)return void Ke.printMessage("view notfound");Ci.getInstance()._captured=!0;const e=t.changedTouches[0].pageX,i=t.changedTouches[0].pageY;Ci.getInstance()._view.onTouchesBegan(e,i)}function Ai(t){if(!Ci.getInstance()._captured)return;if(!Ci.getInstance()._view)return void Ke.printMessage("view notfound");const e=t.target.getBoundingClientRect(),i=t.changedTouches[0].clientX,r=t.changedTouches[0].clientY;Ci.getInstance()._view.onTouchesMoved(i,r,e)}function Fi(t){if(Ci.getInstance()._captured=!1,!Ci.getInstance()._view)return void Ke.printMessage("view notfound");const e=t.target.getBoundingClientRect(),i=t.changedTouches[0].clientX-e.left,r=t.changedTouches[0].clientY-e.top;Ci.getInstance()._view.onTouchesEnded(i,r)}function Di(t){if(Ci.getInstance()._captured=!1,!Ci.getInstance()._view)return void Ke.printMessage("view notfound");const e=t.target.getBoundingClientRect(),i=t.changedTouches[0].clientX-e.left,r=t.changedTouches[0].clientY-e.top;Ci.getInstance()._view.onTouchesEnded(i,r)}function Ri(t){Ci.getInstance()._captured=!1,Ci.getInstance()._view?Ci.getInstance()._view.onTouchesEnded(0,0):Ke.printMessage("view notfound")}window.navigator.platform.toLowerCase();const Vi=new class{constructor(){this.models=[],this.count=-1,this.reloadFlg=!1,window.Live2D.init(),s.Live2DFramework.setPlatformManager(new z)}createModel(){var t=new G;return this.models.push(t),t}changeModel(t,e){this.reloadFlg&&(this.reloadFlg=!1,this.releaseModel(0,t),this.createModel(),this.models[0].load(t,e))}getModel(t){return t>=this.models.length?null:this.models[t]}releaseModel(t,e){this.models.length<=t||(this.models[t].release(e),delete this.models[t],this.models.splice(t,1))}numModels(){return this.models.length}setDrag(t,e){for(var i=0;i<this.models.length;i++)this.models[i].setDrag(t,e)}maxScaleEvent(){for(var t=0;t<this.models.length;t++)this.models[t].startRandomMotion("pinch_in",2)}minScaleEvent(){for(var t=0;t<this.models.length;t++)this.models[t].startRandomMotion("pinch_out",2)}tapEvent(t,e){for(var i=0;i<this.models.length;i++)this.models[i].hitTest("Head".toLowerCase(),t,e)?this.models[i].setRandomExpression():this.models[i].hitTest("Body".toLowerCase(),t,e)?this.models[i].startRandomMotion("tap_body",2):this.models[i].hitTestCustom("head",t,e)?this.models[i].startRandomMotion("flick_head",2):this.models[i].hitTestCustom("body",t,e)&&this.models[i].startRandomMotion("tap_body",2);return!0}};let Oi=!1,Ni=null,ki=null,Ui=null,zi=null,Yi=null,Gi=null,Xi=!1,ji=0,Hi=0,qi=.5,Wi=1,Ji={};function Qi(t){let e=ki.width,i=ki.height;Ui=new s.L2DTargetPoint;let r=i/e,n=-r,o=r;if(window.Live2D.captureFrame=!1,zi=new s.L2DViewMatrix,zi.setScreenRect(-1,1,n,o),zi.setMaxScreenRect(-2,2,-2,2),zi.setMaxScale(2),zi.setMinScale(.8),Yi=new s.L2DMatrix44,Yi.multScale(Wi,Wi*e/i),Gi=new s.L2DMatrix44,Gi.multTranslate(-e/2,-i/2),Gi.multScale(2/e,-2/e),Ni=function(){for(var t=["webgl","experimental-webgl","webkit-3d","moz-webgl"],e=0;e<t.length;e++)try{var i=ki.getContext(t[e],{premultipliedAlpha:!0});if(i)return i}catch(t){}return null}(),D=Ni,!Ni)return console.error("Failed to create WebGL context."),void(window.WebGLRenderingContext&&console.error("Your browser don't support WebGL, check https://get.webgl.org/ for futher information."));window.Live2D.setGL(Ni),Ni.clearColor(0,0,0,0),function(t){Vi.reloadFlg=!0,Vi.count++,Vi.changeModel(Ni,t)}(t),Oi||(Oi=!0,function t(){!function(){let t=new X;t.reset(),t.loadIdentity(),Ui.update(),Vi.setDrag(Ui.getX(),Ui.getY()),Ni.clear(Ni.COLOR_BUFFER_BIT),t.multMatrix(Yi.getArray()),t.multMatrix(zi.getArray()),t.push();for(let e=0;e<Vi.numModels();e++){let i=Vi.getModel(e);if(null==i)return;i.initialized&&!i.updating&&(i.update(),i.draw(t))}t.pop()}();let e=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;if(window.Live2D.captureFrame){window.Live2D.captureFrame=!1;var i=document.createElement("a");document.body.appendChild(i),i.setAttribute("type","hidden"),i.href=ki.toDataURL(),i.download=window.Live2D.captureName||"live2d.png",i.click()}e(t,ki)}())}function Zi(t,e,i){if(e.x<i.left+i.width&&e.y<i.top+i.height&&e.x>i.left&&e.y>i.top)return e;let r=t.x-e.x,s=t.y-e.y;function n(t,e){return 180*Math.acos((i={x:0,y:1},r=function(t,e){let i=Math.sqrt(t*t+e*e);return{x:t/i,y:e/i}}(t,e),i.x*r.x+i.y*r.y))/Math.PI;var i,r}let o=n(r,s);e.x<t.x&&(o=360-o);let a=360-n(i.left-t.x,-1*(i.top-t.y)),l=360-n(i.left-t.x,-1*(i.top+i.height-t.y)),h=n(i.left+i.width-t.x,-1*(i.top-t.y)),u=n(i.left+i.width-t.x,-1*(i.top+i.height-t.y)),_=s/r,c={};if(o<h){let e=i.top-t.y,r=e/_;c={y:t.y+e,x:t.x+r}}else if(o<u){let e=i.left+i.width-t.x,r=e*_;c={y:t.y+r,x:t.x+e}}else if(o<l){let e=i.top+i.height-t.y,r=e/_;c={y:t.y+e,x:t.x+r}}else if(o<a){let e=t.x-i.left,r=e*_;c={y:t.y-r,x:t.x-e}}else{let e=i.top-t.y,r=e/_;c={y:t.y+e,x:t.x+r}}return c}function Ki(t){Xi=!0;let e=ki.getBoundingClientRect(),i=or(t.clientX-e.left),r=ar(t.clientY-e.top),s=Zi({x:e.left+e.width/2,y:e.top+e.height*qi},{x:t.clientX,y:t.clientY},e),n=sr(s.x-e.left),o=nr(s.y-e.top);ji=i,Hi=r,Ui.setPoint(n,o)}function tr(){Xi&&(Xi=!1),Ui.setPoint(0,0)}function er(){sessionStorage.setItem("Sleepy","1")}function ir(t){if("mousewheel"==t.type);else if("mousedown"==t.type)!function(t){Xi=!0;let e=ki.getBoundingClientRect(),i=or(t.clientX-e.left),r=ar(t.clientY-e.top),s=Zi({x:e.left+e.width/2,y:e.top+e.height*qi},{x:t.clientX,y:t.clientY},e),n=sr(s.x-e.left),o=nr(s.y-e.top);ji=i,Hi=r,Vi.tapEvent(n,o)}(t);else if("mousemove"==t.type){"1"===sessionStorage.getItem("Sleepy")&&sessionStorage.setItem("Sleepy","0"),Ki(t)}else if("mouseup"==t.type){if("button"in t&&0!=t.button)return}else if("mouseout"==t.type){0,tr();var e=sessionStorage.getItem("SleepyTimer");window.clearTimeout(e),e=window.setTimeout(er,5e4),sessionStorage.setItem("SleepyTimer",e)}}function rr(t){var e=t.touches[0];"touchstart"==t.type?1==t.touches.length&&Ki(e):"touchmove"==t.type?function(t){let e=ki.getBoundingClientRect(),i=or(t.clientX-e.left),r=ar(t.clientY-e.top),s=Zi({x:e.left+e.width/2,y:e.top+e.height*qi},{x:t.clientX,y:t.clientY},e),n=sr(s.x-e.left),o=nr(s.y-e.top);Xi&&(ji=i,Hi=r,Ui.setPoint(n,o))}(e):"touchend"==t.type&&tr()}function sr(t){var e=Gi.transformX(t);return zi.invertTransformX(e)}function nr(t){var e=Gi.transformY(t);return zi.invertTransformY(e)}function or(t){return Gi.transformX(t)}function ar(t){return Gi.transformY(t)}function lr(t,e,i=2,r){jQuery.ajax({url:r,dataType:"script",cache:!0}).done((function(){Ci.getInstance()._hitAreaList=Ji,Ci.getInstance()._zoom=i,Ci.getInstance()._head_pos=qi,Ci.getInstance().initL2dCanvas(t),Ci.getInstance().initialize(e)&&Ci.getInstance().run()}))}function hr(t,e){Ci.getInstance()._captureName=t,Ci.getInstance()._captureFrame=e,window.Live2D.captureFrame=e,window.Live2D.captureName=t}window.screenshot=hr,window.loadlive2d=function(t,e,i,r=1,s={},n="https://cubism.live2d.com/sdk-web/cubismcore/live2dcubismcore.min.js"){qi=void 0===i?.5:i,Ji=s,(new z).loadString(e,(function(i){let s,o=JSON.parse(i).model,a=-1;switch(null==o?a=e.indexOf("model3.json"):s=o.substring(o.lastIndexOf(".")+1),s){case"moc":!function(t,e,i){Wi=i,function(t){ki=document.getElementById(t),ki.addEventListener&&(window.addEventListener("click",ir),window.addEventListener("mousedown",ir),window.addEventListener("mousemove",ir),window.addEventListener("mouseup",ir),document.addEventListener("mouseout",ir),window.addEventListener("touchstart",rr),window.addEventListener("touchend",rr),window.addEventListener("touchmove",rr))}(t),Qi(e)}(t,e,r);break;case"moc3":lr(t,e,r,n);break;default:a>0?lr(t,e,r,n):console.log("not model EXT. 没有获取到JSON中的model节点扩展名,应为moc|moc3,或传入相对路径的model3.json文件")}}))},window.loadlive2dv3=lr}]);